import{j as t}from"./RequirementCard-DEdD30eg.js";import{r as o}from"./index-RYns6xqu.js";import{c as B}from"./ReactAppend-vpV7VTGG.js";import{C as E,e as I,T as P,R as x,S as G,D as w,M as k,j as M,u as v,I as y,Z as N,ae as A,w as F,Q as q}from"./CreateReactScript-C-mUikVe.js";import{S as Y}from"./sweetalert2.all-DJo0UVK6.js";import"./index-CXU7o9CY.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./Results-CoLI09XT.js";import"./DxBox-DZgBbgD6.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const u=new A,_=({})=>{const i=o.useRef(),n=o.useRef(),m=o.useRef(),p=o.useRef(),f=o.useRef(),c=o.useRef(),d=o.useRef(),l=o.useRef(),g=o.useRef(),[C,h]=o.useState(!1),R=e=>{var r,s;e!=null&&e.id?h(!0):h(!1),m.current.value=(e==null?void 0:e.id)??"",p.current.value=(e==null?void 0:e.name)??"",F(f.current,(r=e==null?void 0:e.category)==null?void 0:r.id,(s=e==null?void 0:e.category)==null?void 0:s.name),c.editor.root.innerHTML=(e==null?void 0:e.description)??"",l.image.src=`/api/posts/media/${e==null?void 0:e.image}`,l.current.value=null,F(d.current,(e==null?void 0:e.tags)??[],"id","name"),g.current.value=(e==null?void 0:e.post_date)??moment().format("YYYY-MM-DD"),$(n.current).modal("show")},D=async e=>{e.preventDefault();const r={id:m.current.value||void 0,name:p.current.value,category_id:f.current.value,summary:q(c.current.value),description:c.current.value,tags:$(d.current).val(),post_date:g.current.value},s=new FormData;for(const j in r)s.append(j,r[j]);const a=l.current.files[0];a&&s.append("image",a),await u.save(s)&&($(i.current).dxDataGrid("instance").refresh(),$(n.current).modal("hide"))},T=async({id:e,field:r,value:s})=>{await u.boolean({id:e,field:r,value:s})&&$(i.current).dxDataGrid("instance").refresh()},S=async e=>{const{isConfirmed:r}=await Y.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!r||!await u.delete(e)||$(i.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(P,{gridRef:i,title:"Posts",rest:u,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(i.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>R()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"category.name",caption:"Categoría"},{dataField:"name",caption:"Título",cellTemplate:(e,{data:r})=>{var s;x(e,t.jsxs(t.Fragment,{children:[r.name,t.jsx("br",{}),(s=r.tags)==null?void 0:s.map((a,b)=>t.jsx("span",{className:"badge badge-soft-success me-1",children:a.name},b))]}))}},{dataField:"image",caption:"Imagen",width:"90px",cellTemplate:(e,{data:r})=>{x(e,t.jsx("img",{src:`/api/posts/media/${r.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:s=>s.target.src="/api/cover/thumbnail/null"}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"80px",cellTemplate:(e,{data:r})=>{x(e,t.jsx(G,{checked:r.featured,onChange:s=>T({id:r.id,field:"featured",value:s.target.checked})}))}},{caption:"Acciones",cellTemplate:(e,{data:r})=>{e.append(w({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>R(r)})),e.append(w({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>S(r.id)}))},allowFiltering:!1,allowExporting:!1}]}),t.jsx(k,{modalRef:n,title:C?"Editar post":"Agregar post",onSubmit:D,size:"lg",children:t.jsxs("div",{className:"row",id:"posts-container",children:[t.jsx("input",{ref:m,type:"hidden"}),t.jsx(M,{eRef:l,label:"Imagen",col:"col-7",aspect:"16/9"}),t.jsxs("div",{className:"col-5",children:[t.jsx(v,{eRef:f,searchAPI:"/api/admin/categories/paginate",searchBy:"name",label:"Categoría",required:!0,dropdownParent:"#posts-container"}),t.jsx(y,{eRef:p,label:"Título",rows:2,required:!0}),t.jsx(v,{id:"tags",eRef:d,searchAPI:"/api/admin/tags/paginate",searchBy:"name",label:"Tags",dropdownParent:"#posts-container",tags:!0,multiple:!0}),t.jsx(y,{eRef:g,label:"Fecha de publicación",type:"date",required:!0})]}),t.jsx(N,{eRef:c,label:"Contenido",col:"col-12"})]})})]})};E((i,n)=>{B(i).render(t.jsx(I,{...n,title:"Posts",children:t.jsx(_,{...n})}))});
