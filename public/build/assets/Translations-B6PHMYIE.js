var T=Object.defineProperty;var w=(t,r,s)=>r in t?T(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var x=(t,r,s)=>(w(t,typeof r!="symbol"?r+"":r,s),s);import{j as e}from"./FileViewer-CpM0iYLI.js";import{r as n}from"./index-B80Lgev0.js";import{c as b}from"./ReactAppend-CBRQCQGz.js";import{B as F}from"./Base-CiApDJ7F.js";import{C as N}from"./CreateReactScript-Bj11ghWz.js";import{T as S}from"./Table-fNNkvby0.js";import{M as E}from"./Modal-Dyq34CHD.js";import{R as k}from"./ReactAppend-C-tNgxIf.js";import"./sweetalert2.all-Dh0rZL5X.js";import{I as h}from"./InputFormGroup-DZ3W53Mr.js";import{m as v}from"./main-Br9xqDfn.js";import{B as C}from"./Results-B9dLaNz0.js";import{r as y}from"./DxBox-CdMuSyGE.js";import"./index-DO3Aws4m.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./index.esm-CTa_PdWD.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./useTranslation-BvL_iu_4.js";import"./Filter-1mRNSgu6.js";/* empty css               */class B extends C{constructor(){super(...arguments);x(this,"path","admin/translations");x(this,"translate",async({group:s,key:d,value:p,lang_id:c})=>{try{const{status:o,result:l}=await v.Fetch(`/api/${this.path}/translate`,{method:"POST",body:JSON.stringify({group:s,key:d,value:p,lang_id:c})});if(!o)throw new Error((l==null?void 0:l.message)||"Error al guardar traducción");return v.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:"Traducción guardada exitosamente",type:"success"}),l}catch(o){return v.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:o.message,type:"danger"}),null}})}}const f=new B,O=({data:t,gridRef:r,isTranslationMode:s,current_lang_id:d,default_lang_id:p})=>{const[c,o]=n.useState(t.value||t.value_base),[l,u]=n.useState(!1),j=n.useRef(null),g=t.value!==null&&t.value!==t.value_base,m=async()=>{try{const a={group:t.group,key:t.key,value:c};s?await f.translate(a):await f.save({...a,id:t.id}),$(r.current).dxDataGrid("instance").refresh(),u(!1)}catch{Notify.error("Error al guardar traducción")}};return e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[!l&&e.jsx("span",{className:"text-nowrap",children:g?e.jsx("i",{className:"fas fa-check text-success"}):e.jsx("i",{className:"fas fa-times text-danger"})}),e.jsx("input",{ref:j,className:"form-control flex-grow-1",value:c,onChange:a=>{o(a.target.value),u(!0)},onFocus:()=>u(!0),onBlur:()=>setTimeout(()=>u(!1),200)}),l&&e.jsx("button",{className:"btn btn-xs btn-soft-primary",onClick:m,children:s?e.jsx("i",{className:"fa fa-language"}):e.jsx("i",{className:"fa fa-pen"})})]})},_=({current_lang_id:t,default_lang_id:r})=>{const s=n.useRef(),d=n.useRef(),p=n.useRef(),c=n.useRef(),o=n.useRef(),l=n.useRef(),[u,j]=n.useState(!1),g=async a=>{a.preventDefault();const i={id:p.current.value||void 0,group:c.current.value,key:o.current.value,value:l.current.value};await f.save(i)&&($(s.current).dxDataGrid("instance").refresh(),$(d.current).modal("hide"))},m=t!==r;return e.jsxs(e.Fragment,{children:[e.jsx(S,{gridRef:s,title:"Traducciones",rest:f,remoteOperations:{paging:!0,filtering:!0,sorting:!0},toolBar:a=>{},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"group",caption:"Grupo",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(a,{data:i})=>{a.html(y(e.jsx(e.Fragment,{children:i.group})))}},{dataField:"key",caption:"Clave",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(a,{data:i})=>{a.html(y(e.jsx(e.Fragment,{children:i.key})))}},{dataField:"value_base",caption:"Valor Español",width:"200px",allowFiltering:!0,filterOperations:["contains"],filterType:"text"},{dataField:"is_translated",caption:"Estado",width:"80px",allowFiltering:!1,filterType:"text",cellTemplate:(a,{data:i})=>{const R=i.value&&i.value!==i.value_base;a.html(y(e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:R?e.jsx("i",{className:"fas fa-check-circle text-success",title:"Traducido"}):e.jsx("i",{className:"fas fa-times-circle text-danger",title:"Sin traducir"})})))},calculateFilterExpression:(a,i)=>a==="traducido"?["is_translated","=",!0]:a==="no traducido"?["is_translated","=",!1]:null},{dataField:"value",caption:m?"Traducción":"Valor",allowFiltering:!1,cellTemplate:(a,{data:i})=>{k(a,e.jsx(O,{data:i,gridRef:s,isTranslationMode:m,current_lang_id:t,default_lang_id:r}))}}],options:{searchPanel:{visible:!0,width:240,placeholder:"Buscar...",highlightSearchText:!0},filterRow:{visible:!0,applyFilter:"auto"},paging:{pageSize:10},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,25,50,100],showInfo:!0}}}),e.jsx(E,{modalRef:d,title:u?"Editar traducción":"Agregar traducción",onSubmit:g,size:"md",children:e.jsxs("div",{className:"row",id:"translations-container",children:[e.jsx("input",{ref:p,type:"hidden"}),e.jsx(h,{eRef:c,label:"Grupo",col:"col-12",required:!0}),e.jsx(h,{eRef:o,label:"Clave",col:"col-6",required:!0}),e.jsx(h,{eRef:l,label:"Valor",col:"col-6",required:!0})]})})]})};N((t,r)=>{b(t).render(e.jsx(F,{...r,title:"Traducciones",children:e.jsx(_,{...r})}))});
