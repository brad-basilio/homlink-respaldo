import{j as e}from"./RequirementCard-DEdD30eg.js";import{r as h}from"./index-RYns6xqu.js";import{a as we}from"./axios-B4uVmeYG.js";import{W as Ue}from"./WhatsAppButton-DiyZ1qW6.js";import{G as Ie}from"./Header-LwLnF1Zs.js";import{c as ze}from"./createLucideIcon-D_WcjKff.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);class We{constructor(){this.baseURL="https://apiluna.cambiafx.pe/api/BackendPizarra",this.localAPI="/api",this.tcData=[],this.tcBase=[],this.tcBaseOriginal=null,this.idParCurrency=1}async getExchangeRates(){try{const i=await we.get(`${this.baseURL}/getTcCustomerNoAuth`,{params:{idParCurrency:this.idParCurrency},timeout:8e3,headers:{Accept:"application/json","Content-Type":"application/json"}});let c=[];if(Array.isArray(i.data))c=i.data;else throw new Error("Formato de respuesta inesperado: "+JSON.stringify(i.data));if(c.length===0)throw new Error("No se obtuvieron datos de tipos de cambio");const m=c.map(p=>({id:p.idRange||0,desde:parseFloat(p.tcFrom||0),hasta:parseFloat(p.tcTo||999999),tc_compra:parseFloat(p.tcBuy||0),tc_venta:parseFloat(p.tcSale||0),coupon:p.coupon,amountMinOperation:parseFloat(p.amountMinOperation||0),amountMaxOperation:parseFloat(p.amountMaxOperation||0)}));return this.tcBase=m,this.tcData=[...m],m.length>0&&(this.tcBaseOriginal={tc_compra:m[0].tc_compra,tc_venta:m[0].tc_venta}),m}catch{const c=[{id:1,desde:0,hasta:1e3,tc_compra:3.533,tc_venta:3.565},{id:2,desde:1001,hasta:5e3,tc_compra:3.534,tc_venta:3.566},{id:3,desde:5001,hasta:1e4,tc_compra:3.535,tc_venta:3.567},{id:4,desde:10001,hasta:999999,tc_compra:3.536,tc_venta:3.568}];return this.tcBase=c,this.tcData=[...c],c.length>0&&(this.tcBaseOriginal={tc_compra:c[0].tc_compra,tc_venta:c[0].tc_venta}),c}}async validateCoupon(i){try{if(!i||!i.trim())return this.tcData=[...this.tcBase],{valid:!1,data:this.tcData};const c=await we.get(`${this.baseURL}/getTcCustomerNoAuth`,{params:{idParCurrency:this.idParCurrency,codePromo:i},timeout:8e3,headers:{Accept:"application/json","Content-Type":"application/json"}});let m=null;if(Array.isArray(c.data)&&c.data.length>0)m=c.data;else throw new Error("CupÃ³n no vÃ¡lido o sin datos");if(m&&m.length>0){const p=m.map(v=>({id:v.idRange,desde:parseFloat(v.tcFrom||0),hasta:parseFloat(v.tcTo||999999),tc_compra:parseFloat(v.tcBuy),tc_venta:parseFloat(v.tcSale),coupon:v.coupon,amountMinOperation:parseFloat(v.amountMinOperation||0),amountMaxOperation:parseFloat(v.amountMaxOperation||0)}));return this.tcData=p,console.log(`ğŸ« CupÃ³n aplicado: ${i}`,p),{valid:!0,data:p}}return this.tcData=[...this.tcBase],{valid:!1,data:this.tcData,message:"El cÃ³digo de promociÃ³n no es vÃ¡lido."}}catch{return this.tcData=[...this.tcBase],{valid:!1,data:this.tcData,message:"Error al validar el cÃ³digo de promociÃ³n."}}}getTCFromBase(i,c="venta"){for(let m of this.tcBase)if(m.desde<=i&&i<=m.hasta)return c==="V"?m.tc_venta:m.tc_compra;if(this.tcBase.length>0){const m=this.tcBase[this.tcBase.length-1];return c==="V"?m.tc_venta:m.tc_compra}return 0}calculateExchange(i,c="V",m="from"){let p=0;const v=m==="from"?"O":"D",l=this.getTCFromAmount(i,c,v),S=c==="V"||c==="venta";return v==="O"?p=S?i/l:i*l:v==="D"&&(p=S?i*l:i/l),p=Math.round(p*100)/100,console.log(`ğŸ” calculateExchange: ${i} (${v}) â†’ ${p} (TC: ${l}, isVenta: ${S})`),{result:parseFloat(p.toFixed(2)),exchangeRate:l,operation:c}}getTCFromAmount(i,c="V",m="O"){if(!i||i<=0){if(this.tcData.length>0){const S=this.tcData[0];return c==="C"?S.tc_compra:S.tc_venta}return 0}const p=c==="C"||c==="compra",l=this.isPenCurrency(m,p)?this.getTcRangePEN(this.tcData,i,p):this.getTcRangeUSD(this.tcData,i);if(!l){const S=this.tcBase[0]||{tc_compra:0,tc_venta:0};return p?S.tc_compra:S.tc_venta}return p?l.tc_compra:l.tc_venta}isPenCurrency(i="O",c=!1){const m=c?"compra":"venta";return m==="venta"&&i==="O"||m==="compra"&&i==="D"}getTcRangePEN(i=[],c=0,m=!1){const p=m?"compra":"venta";if(!c)return i[0]??null;for(const v of i){const l=p==="compra"?v.tc_compra:v.tc_venta,S=Number((c/l).toFixed(2)),b=v.desde||v.from||0,U=v.hasta||v.to||0;if(S>=b&&S<U)return v}return i[i.length-1]??null}getTcRangeUSD(i=[],c=0){let m=null;if(c){for(const p of i){const v=p.desde||p.from||0,l=p.hasta||p.to||0;if(v<=c&&c<l){m=p;break}}m=m??i[i.length-1]??null}else m=i[0]??null;return m}getCurrentRates(){if(this.tcData.length===0)return{compra:"3.5330",venta:"3.5650"};const i=this.tcData[0];return{compra:i.tc_compra.toFixed(4),venta:i.tc_venta.toFixed(4)}}formatNumberToString(i){return!i||isNaN(i)?"":i.toFixed(2)}formatStringToNumber(i){return i&&parseFloat(i.toString().replace(/,/g,""))||0}async initializeOperation(i){try{const c="https://mi.cambiafx.pe/login";return window.location.href=c,{success:!0,redirectUrl:c}}catch(c){throw c}}checkUrlCoupon(){return new URLSearchParams(window.location.search).get("utm_campaign")}}const f=new We,He=new Ie,tt=({title:T="Comienza tu cambio ahora",initialOperationType:i="venta",showCoupons:c=!0,showCredits:m=!0,className:p="",onOperationStart:v=null})=>{const[l,S]=h.useState(i),[b,U]=h.useState("1,000"),[B,J]=h.useState(""),[je,K]=h.useState(0),[I,z]=h.useState(""),[Ne,Z]=h.useState(!1),[ae,Ce]=h.useState(null),[O,G]=h.useState({compra:"0.0000",venta:"0.0000"}),[ye,oe]=h.useState(!1),[a,q]=h.useState(null);h.useState(!1);const[Ae,ne]=h.useState(!1),[Y,W]=h.useState(null),[L,ee]=h.useState("1,000"),[R,re]=h.useState({compra:"0.0000",venta:"0.0000"}),[D,le]=h.useState([]),X=t=>!t||isNaN(t)?"":parseFloat(t).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}),$=t=>t&&parseFloat(t.toString().replace(/,/g,""))||0,Se=t=>{let o=t.replace(/[^0-9.,]/g,"");if(o.includes(".")){const s=o.split("."),n=s[0].replace(/,/g,""),r=s[1]?s[1].substring(0,2):"",d=X(n);return o.endsWith(".")&&r===""?`${d}.`:r?`${d}.${r}`:d}else{const s=o.replace(/,/g,"");return X(s)}};h.useEffect(()=>{const t=setTimeout(()=>{ee(b)},300);return()=>clearTimeout(t)},[b]),h.useEffect(()=>{(async()=>{await $e(),ke(),await Oe(),b&&setTimeout(()=>{V("O",b)},500)})()},[]),h.useEffect(()=>{b&&V("O"),M()},[l]),h.useEffect(()=>{I&&(M(),b&&V("O"))},[I]),h.useEffect(()=>{console.log("ğŸ”„ useEffect: couponInfo, operationType o debouncedAmount1 cambiaron"),console.log("ğŸ” couponInfo:",a),console.log("ğŸ” operationType:",l),console.log("ğŸ” debouncedAmount1:",L),M()},[a,l,L]);const $e=async()=>{try{const t=await f.getExchangeRates();M();const o=l==="compra"?"C":"V",s=f.getTCFromAmount(1,o);K(s)}catch{}},M=()=>{if(console.log("ğŸ”„ updateCurrentRates: iniciando..."),console.log("ğŸ” CambiaFXService.tcBase:",f.tcBase),console.log("ğŸ” CambiaFXService.tcData:",f.tcData),f.tcBase.length>0){const t=f.tcBase[0];re({compra:t.tc_compra.toFixed(4),venta:t.tc_venta.toFixed(4)}),console.log(`ğŸ¦ baseRates actualizadas - compra=${t.tc_compra.toFixed(4)}, venta=${t.tc_venta.toFixed(4)}`)}if(a&&(b||L)){const o=Q(b||L);if(console.log("ğŸ”„ updateCurrentRates: couponApplies =",o),o.applies){if(o.rangoActual){const s=o.rangoActual,n=s.tcCompra??s.tc_compra,r=s.tcVenta??s.tc_venta;G({compra:n.toFixed(4),venta:r.toFixed(4)}),console.log(`ï¿½ updateCurrentRates: usando tasas del RANGO - compra=${n.toFixed(4)}, venta=${r.toFixed(4)}`);return}else if(a.tcCompra&&a.tcVenta){G({compra:a.tcCompra.toFixed(4),venta:a.tcVenta.toFixed(4)}),console.log(`ğŸ”„ updateCurrentRates: usando tasas del CUPÃ“N - compra=${a.tcCompra.toFixed(4)}, venta=${a.tcVenta.toFixed(4)}`);return}}}if(f.tcBase.length>0){const t=f.tcBase[0];console.log("ğŸ” baseRates encontradas:",t),G({compra:t.tc_compra.toFixed(4),venta:t.tc_venta.toFixed(4)}),console.log(`ğŸ”„ updateCurrentRates: usando tasas BASE - compra=${t.tc_compra.toFixed(4)}, venta=${t.tc_venta.toFixed(4)}`)}else{console.log("âš ï¸ No hay tcBase, usando fallback");const t=f.getCurrentRates();console.log("ğŸ” fallback rates:",t),G(t),console.log(`ğŸ”„ updateCurrentRates: fallback a getCurrentRates - compra=${t.compra}, venta=${t.venta}`)}},ke=()=>{const t=f.checkUrlCoupon();t&&(z(t),me(t,"p"))},Oe=async()=>{try{const t=await He.getApps();console.log("ğŸ“± Apps cargadas:",t),le(t)}catch(t){console.error("Error fetching apps:",t),le([])}},ie=(t="")=>{const o=l==="compra"?"compra":"venta";return o==="venta"&&t==="O"||o==="compra"&&t==="D"},Le=(t=[],o=0)=>{const s=l==="compra"?"compra":"venta";if(!o)return t[0]??null;for(const n of t){const r=s==="compra"?n.tc_compra||n.buy:n.tc_venta||n.sell,d=Number((o/r).toFixed(2)),x=n.desde||n.from||0,g=n.hasta||n.to||0;if(d>=x&&d<g)return n}return t[t.length-1]??null},Me=(t=[],o=0)=>{let s=null;if(o){for(const n of t){const r=n.desde||n.from||0,d=n.hasta||n.to||0;if(r<=o&&o<d){s=n;break}}s=s??t[t.length-1]??null}else s=t[0]??null;return s},te=(t,o)=>{const s=ie(o);let n=[];a&&a.rangos&&a.rangos.length>0?n=a.rangos:a?n=[{desde:a.montoMinimo,hasta:a.montoMaximo,tc_compra:a.tcCompra,tc_venta:a.tcVenta}]:n=f.tcData||f.tcBase||[];const r=s?Le(n,t):Me(n,t);if(!r){const w=f.tcBase[0]||{tc_compra:0,tc_venta:0};return l==="compra"?w.tc_compra:w.tc_venta}const d=l==="compra",x=r.tc_compra||r.buy||0,g=r.tc_venta||r.sell||0;return d?x:g},Fe=t=>{let o=[];a&&a.rangos&&a.rangos.length>0?o=a.rangos:a?o=[{desde:a.montoMinimo,hasta:a.montoMaximo,tc_compra:a.tcCompra,tc_venta:a.tcVenta}]:o=f.tcData||f.tcBase||[];let s=null;for(const n of o){const r=n.tc_venta||n.sell||0;if(r===0)continue;const d=t/r,x=n.desde||0,g=n.hasta||1/0;d>=x&&d<=g?(s=r,console.log(`ğŸ¯ VENTA Soles: ${t} Ã· ${r} = $${d.toFixed(2)} (Rango: $${x}-$${g}) âœ…`)):console.log(`ğŸ¯ VENTA Soles: ${t} Ã· ${r} = $${d.toFixed(2)} (Rango: $${x}-$${g}) âŒ`)}return s===null?(console.log("ğŸ¯ VENTA Soles: No se encontrÃ³ rango coincidente, usando lÃ³gica normal"),te(t,"O")):(console.log(`ğŸ¯ VENTA Soles: Rango final seleccionado - TC: ${s}`),s)},V=(t="O",o=null)=>{let s=0,n=0;if(o!==null?n=$(o):n=$(t==="O"?b:B),n===0){t==="O"?J(""):U("");const x=te(1,t);K(x),setTimeout(()=>M(),0);return}let r;const d=l==="venta";if(d&&t==="O"?r=Fe(n):r=te(n,t),t==="O"?s=d?n/r:n*r:t==="D"&&(s=d?n*r:n/r),K(r),t==="O"){const x=X(s);J(x)}else{const x=X(s);U(x)}setTimeout(()=>M(),0)},Re=()=>{const t=l==="compra"?"venta":"compra";S(t),console.log(`ğŸ”„ handleSwap: Cambiando de ${l} a ${t}`),console.log(`ğŸ”„ handleSwap: CupÃ³n activo: ${a?"SÃ­":"No"}`),console.log(`ğŸ”„ handleSwap: Amount1: ${b}`),b&&(console.log("ğŸ”„ handleSwap: Forzando recÃ¡lculo inmediato"),setTimeout(()=>{M(),setTimeout(()=>{V("O",b)},10)},50))},ce=t=>{t!==l&&(console.log(`ğŸ”„ Cambiando operaciÃ³n de ${l} a ${t}`),S(t),setTimeout(()=>{M()},100))},de=(t,o)=>{const s=Se(t);o==="O"?U(s):J(s),setTimeout(()=>{V(o,s)},0)},me=async(t,o="c")=>{if(Z(!0),f.tcBase.length>0){const s=f.tcBase[0];re({compra:s.tc_compra.toFixed(4),venta:s.tc_venta.toFixed(4)}),console.log(`ğŸ¦ baseRates capturadas ANTES del cupÃ³n - compra=${s.tc_compra.toFixed(4)}, venta=${s.tc_venta.toFixed(4)}`)}try{const s=await f.validateCoupon(t);if(!s.valid&&o==="c")z(""),q(null),W({codigo:t,message:s.message||"El cÃ³digo de promociÃ³n no es vÃ¡lido."}),M();else if(s.valid){W(null);const n=s.data,r=Math.min(...n.map(g=>g.desde)),d=Math.max(...n.map(g=>g.hasta)),x=n[0];if(q({codigo:t,montoMinimo:r,montoMaximo:d,tcCompra:x.tc_compra,tcVenta:x.tc_venta,rangos:n}),M(),ee(b),G(f.getCurrentRates()),b){const g=l==="compra"?"C":"V",w=$(b),E=f.getTCFromAmount(w,g);V("O")}}}catch{o==="c"&&(z(""),q(null),W({codigo:I,message:"Error al validar el cÃ³digo de promociÃ³n."}),M())}finally{Z(!1)}},_e=t=>{z(t),Z(!0),Y&&W(null),ae&&clearTimeout(ae);const o=setTimeout(()=>{me(t,"c")},2e3);Z(!1),Ce(o)},Q=(t=null,o=null)=>{if(!a)return{applies:!1,reason:""};const s=o||l;let n=0,r="O";const d=$(L),x=$(b);if(d>0)n=d,r="O";else if(x>0)n=x,r="O";else return{applies:!1,reason:"Sin monto vÃ¡lido"};const g=ie(r);console.log(`ğŸ” checkCouponApplies: monto=${n}, origin=${r}, isPen=${g}, operacion=${s} (${s==="compra"?"SOLESâ†’USD":"USDâ†’SOLES"})`);let w=n;if(g){const y=f.tcBase[0];if(y){const k=s==="compra"?y.tc_venta:y.tc_compra;w=n/k}console.log(`ğŸ”„ Convirtiendo PEN a USD: ${n} PEN â†’ ${w} USD (tc=${(y==null?void 0:y.tc_venta)||(y==null?void 0:y.tc_compra)})`)}else console.log(`âœ… Monto ya en USD: ${n}`);if(w<=0)return{applies:!1,reason:"Sin monto vÃ¡lido para conversiÃ³n"};if(a.rangos&&a.rangos.length>0){let y=null;const k=a.rangos.filter(j=>{const u=j.desde??j.montoMinimo??j.from,_=j.hasta??j.montoMaximo??j.to;return j&&u!=null&&_!=null});console.log(`ğŸ¯ Evaluando ${k.length} rangos para ${w} USD`);for(let j=0;j<k.length;j++){const u=k[j],_=j===k.length-1,P=u.desde??u.montoMinimo??u.from??0,N=u.hasta??u.montoMaximo??u.to??0,ve=.1,be=_?P-ve<=w&&w<=N:P-ve<=w&&w<N;if(console.log(`ğŸ“‹ Rango ${j+1}: ${P}-${N}, incluye ${w}? ${be} (${_?"Ãºltimo":"intermedio"})`),be){y=u,console.log("âœ… Rango aplicable encontrado:",u);break}}if(y)return{applies:!0,reason:"",rangoActual:y};{const j=k.map(u=>{const _=u.desde??u.montoMinimo??u.from,P=u.hasta??u.montoMaximo??u.to;return`$${_}-$${P} USD`}).join(", ");return console.log(`âŒ No se encontrÃ³ rango aplicable para ${w} USD`),{applies:!1,reason:`Rangos vÃ¡lidos: ${j}`}}}return console.log(`ğŸ“Š Verificando cupÃ³n simple: ${w} USD vs ${a.montoMinimo}-${a.montoMaximo} USD`),w<a.montoMinimo-.1?{applies:!1,reason:`Monto mÃ­nimo requerido: $${a.montoMinimo} USD`}:w>a.montoMaximo?{applies:!1,reason:`Monto mÃ¡ximo permitido: $${a.montoMaximo} USD`}:(console.log("âœ… CupÃ³n simple aplica"),{applies:!0,reason:""})},De=async()=>{ne(!0);try{const t=1500+Math.random()*1e3;await new Promise(o=>setTimeout(o,t))}catch{}finally{ne(!1)}},C=h.useMemo(()=>{if(!a)return null;const t=Q(L);return console.log("ğŸ¯ getCurrentCouponRange: couponApplies =",t),t.applies&&t.rangoActual?t.rangoActual:null},[a,L,l]),A=h.useMemo(()=>{if(console.log("ğŸ¨ useMemo rates: recalculando..."),console.log("ğŸ” DEBUG - couponInfo:",a),console.log("ğŸ” DEBUG - currentRates:",O),console.log("ğŸ” DEBUG - baseRates:",R),console.log("ğŸ” DEBUG - debouncedAmount1:",L),!a)return console.log("ğŸ¨ useMemo rates: sin cupÃ³n, usando currentRates",O),{compra:O.compra,venta:O.venta,previousCompra:null,previousVenta:null,showPreviousPrice:!1,isActive:!1};const t=Q(L);return console.log("ğŸ¨ useMemo rates: couponApplies =",t),console.log("ğŸ” DEBUG - couponApplies.applies:",t.applies),console.log("ğŸ” DEBUG - currentRates:",O),console.log("ğŸ” DEBUG - baseRates:",R),t.applies?(console.log("ğŸ¨ useMemo rates: cupÃ³n APLICA, mostrando precio anterior"),console.log(`ğŸ’° Precio base (tachado): compra=${R.compra}, venta=${R.venta}`),console.log(`ğŸ« Precio cupÃ³n (actual): compra=${O.compra}, venta=${O.venta}`),{compra:O.compra,venta:O.venta,previousCompra:R.compra,previousVenta:R.venta,showPreviousPrice:!0,isActive:!0}):(console.log("ğŸ¨ useMemo rates: cupÃ³n NO APLICA, usando tasas base sin precio anterior"),{compra:O.compra,venta:O.venta,previousCompra:null,previousVenta:null,showPreviousPrice:!1,isActive:!1})},[a,O,R,L]),[Pe,Ve]=h.useState({compra:0,venta:0,previousCompra:0,previousVenta:0,showPreviousPrice:!1,isActive:!1});h.useEffect(()=>{A.compra&&A.venta&&Ve({compra:A.compra,venta:A.venta,previousCompra:A.previousCompra,previousVenta:A.previousVenta,showPreviousPrice:A.showPreviousPrice,isActive:A.isActive})},[A.compra,A.venta,A.previousCompra,A.previousVenta,A.showPreviousPrice,A.isActive]);const[Ze,pe]=h.useState(!1),ue=h.useRef(l);h.useEffect(()=>{if(ue.current!==l){pe(!0);const t=setTimeout(()=>{pe(!1)},50);return ue.current=l,()=>clearTimeout(t)}},[l]);const[qe,xe]=h.useState(null),[he,ge]=h.useState({compra:0,venta:0,previousCompra:0,previousVenta:0,showPreviousPrice:!1,isActive:!1}),H=h.useMemo(()=>{const t=Q(L,l);return a?t.applies&&t.rangoActual&&(console.log("ğŸ¯ CUPÃ“N APLICA - rangoActual:",t.rangoActual),console.log(`ğŸ¯ Tasas del cupÃ³n: compra=${t.rangoActual.tcCompra??t.rangoActual.tc_compra}, venta=${t.rangoActual.tcVenta??t.rangoActual.tc_venta}`),console.log(`ğŸ¯ Tasas base (anteriores): compra=${R.compra}, venta=${R.venta}`),xe(t.rangoActual),ge({compra:t.rangoActual.tcCompra??t.rangoActual.tc_compra??0,venta:t.rangoActual.tcVenta??t.rangoActual.tc_venta??0,previousCompra:R.compra,previousVenta:R.venta,showPreviousPrice:!0,isActive:!0})):(xe(null),ge({compra:A.compra,venta:A.venta,previousCompra:0,previousVenta:0,showPreviousPrice:!1,isActive:!1})),t},[a,L,l]),F=a&&he.isActive?he:Pe,fe=()=>{const t=navigator.userAgent||navigator.vendor||window.opera;return/iPad|iPhone|iPod/.test(t)&&!window.MSStream?"ios":/android/i.test(t)?"android":/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(t)?"mobile":!1},Ee=()=>{const t={isAndroid:/android/i.test(navigator.userAgent),isIOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,isHuawei:/huawei|honor/i.test(navigator.userAgent)||/harmony/i.test(navigator.userAgent)};if(console.log("ğŸ“± Buscando app para dispositivo:",t),console.log("ğŸ“± Apps disponibles:",D),!D||D.length===0)return console.log("âŒ No hay apps disponibles"),null;if(t.isAndroid){const o=D.find(s=>s.platform==="android");return console.log("ğŸ¤– Android app encontrada por platform:",o),o}if(t.isIOS){const o=D.find(s=>s.platform==="ios");return console.log("ğŸ iOS app encontrada por platform:",o),o}if(t.isHuawei){const o=D.find(s=>s.platform==="huawei");return console.log("ğŸ“² Huawei app encontrada por platform:",o),o}return console.log("â“ No se encontrÃ³ app especÃ­fica por platform, usando la primera disponible:",D[0]),D.length>0?D[0]:null},Be=()=>{if(!fe())return console.log("ğŸ–¥ï¸ Dispositivo de escritorio detectado"),!1;const o=Ee();if(!o||!o.app_scheme)return console.log("âŒ No se encontrÃ³ app con URL scheme configurado para este dispositivo"),!1;console.log("ğŸ¯ App seleccionada:",o);try{let s=!1,n=Date.now();const r=()=>{document.hidden&&(s=!0,console.log("âœ… App instalada abierta exitosamente"),document.removeEventListener("visibilitychange",r))},d=()=>{Date.now()-n<1e3&&(s=!0,console.log("âœ… App instalada abierta exitosamente (iOS)"),window.removeEventListener("blur",d))};return document.addEventListener("visibilitychange",r),window.addEventListener("blur",d),console.log("ğŸ”— Intentando abrir app instalada con scheme:",o.app_scheme),window.location.href=o.app_scheme,setTimeout(()=>{document.removeEventListener("visibilitychange",r),window.removeEventListener("blur",d),s||(console.log("âŒ App no instalada, continuando con operaciÃ³n web normal"),se())},2e3),!0}catch(s){return console.warn("âŒ Error al intentar abrir app con scheme:",s),!1}},se=()=>{const t=$(b),o={type:l==="venta"?"V":"C",fromAmount:l==="venta"?t:$(B),toAmount:l==="venta"?$(B):t,exchangeRate:je,couponCode:I};v?v(o):f.initializeOperation(o)},Te=()=>{if($(b)===0){alert("Debe ingresar un monto");return}fe()&&Be()||se()};return e.jsxs("div",{className:`bg-secondary z-[99999] rounded-2xl  lg:rounded-3xl p-4  lg:p-8 shadow-xl flex flex-col gap-6 w-full max-w-[480px] ${p}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{children:e.jsx("h2",{className:" text-2xl lg:text-[28px] leading-[94%] font-base text-neutral-light",children:T.includes("cambio")?e.jsxs(e.Fragment,{children:[T.split("cambio")[0],e.jsx("span",{className:"text-neutral-light font-semibold",children:"cambio"}),T.split("cambio")[1]]}):T})}),e.jsxs("div",{className:"min-w-max  text-[10px] lg:text-sm font-medium text-neutral-light flex items-center gap-1",children:["Registrados en la SBS",e.jsxs("svg",{className:"w-4 h-4 lg:w-6 lg:h-6",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M16.8825 15L17.5527 18.2099C17.9833 20.2723 18.1986 21.3035 17.7563 21.7923C17.3141 22.281 16.546 21.8606 15.0099 21.0198L12.7364 19.7753C12.3734 19.5766 12.1919 19.4773 12 19.4773C11.8081 19.4773 11.6266 19.5766 11.2636 19.7753L8.99008 21.0198C7.45397 21.8606 6.68592 22.281 6.24365 21.7923C5.80139 21.3035 6.01669 20.2723 6.44731 18.2099L7.11752 15",stroke:"#212121",strokeWidth:"1.5",strokeLinejoin:"round"}),e.jsx("path",{d:"M4.5 9.5C4.5 13.6421 7.85786 17 12 17C16.1421 17 19.5 13.6421 19.5 9.5C19.5 5.35786 16.1421 2 12 2C7.85786 2 4.5 5.35786 4.5 9.5Z",stroke:"#212121",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9 10.1667C9 10.1667 9.75 10.1667 10.5 11.5C10.5 11.5 12.8824 8.16667 15 7.5",stroke:"#212121",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4 tracking-wider bg-white rounded-2xl p-2 !font-paragraph",children:[e.jsxs("button",{onClick:()=>ce("compra"),className:`flex-1 py-3 rounded-xl font-medium transition-all duration-200 relative ${l==="compra"?"bg-constrast text-white shadow-lg shadow-constrast/25":"bg-white text-neutral-dark hover:bg-neutral hover:shadow-md"}`,children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a&&F.showPreviousPrice?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[10px] lg:text-xs opacity-75 font-medium",children:e.jsxs("span",{className:"line-through",children:["Antes S/ ",F.previousCompra]})}),e.jsxs("span",{className:`text-sm font-semibold ${l==="compra"?"text-white":"text-neutral-dark"}`,children:["COMPRA ",e.jsx("br",{className:"lg:hidden"})," S/ ",F.compra]})]}):e.jsxs("span",{className:"text-xs lg:text-sm font-semibold",children:["COMPRA ",e.jsx("br",{className:"lg:hidden"})," S/ ",F.compra]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center cursor-help transition-all duration-200 ${l==="compra"?"bg-secondary text-neutral-dark":"bg-neutral-dark text-white"}`,children:e.jsxs("svg",{className:"w-4 h-4",width:"10",height:"10",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M6.5 6.5C6.5 5.39543 7.39543 4.5 8.5 4.5C9.60457 4.5 10.5 5.39543 10.5 6.5C10.5 7.60457 9.60457 8.5 8.5 8.5V9.5",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"8.5",cy:"12",r:"0.5",fill:"currentColor"})]})}),e.jsx("div",{className:`absolute bottom-full mb-5 opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none z-50 
                                               w-40 max-w-[calc(100vw-2rem)] right-0
                                               sm:w-auto sm:min-w-max sm:right-0`,children:e.jsxs("div",{className:"bg-neutral-dark backdrop-blur-sm text-white rounded-2xl shadow-2xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-3 sm:px-5 sm:py-4",children:[e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("span",{className:"text-xs sm:text-sm leading-tight",children:["Tienes: ",e.jsx("span",{className:"font-semibold text-secondary",children:"DÃ³lares"})]})}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("span",{className:"text-xs sm:text-sm leading-tight",children:["Quieres: ",e.jsx("span",{className:"font-semibold text-secondary",children:"Soles"})]})})]}),e.jsx("div",{className:"bg-white/5 rounded-lg px-2 py-2 sm:px-3",children:e.jsxs("p",{className:"text-xs text-white/80 text-center leading-tight",children:[e.jsx("span",{className:"font-medium text-secondary",children:"Nosotros"})," te compramos dÃ³lares"]})})]}),e.jsx("div",{className:"absolute top-full right-6",children:e.jsx("div",{className:"w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-neutral-dark"})})]})})]})]})}),a&&F.showPreviousPrice&&e.jsx("div",{className:`absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-white ${F.isActive?"bg-secondary":"bg-yellow-400"}`})]}),e.jsxs("button",{onClick:()=>ce("venta"),className:`flex-1 py-3 rounded-xl font-medium transition-all duration-200 relative ${l==="venta"?"bg-constrast text-white shadow-lg shadow-constrast/25":"bg-white text-neutral-dark hover:bg-neutral hover:shadow-md"}`,children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a&&F.showPreviousPrice?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[10px] lg:text-xs opacity-75 font-medium",children:e.jsxs("span",{className:"line-through",children:["Antes S/ ",F.previousVenta]})}),e.jsxs("span",{className:`text-sm font-semibold ${l==="venta"?"text-white":"text-neutral-dark"}`,children:["VENTA ",e.jsx("br",{className:"lg:hidden"})," S/ ",F.venta]})]}):e.jsxs("span",{className:"text-xs lg:text-sm font-semibold",children:["VENTA ",e.jsx("br",{className:"lg:hidden"}),"S/ ",F.venta]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:`min-w-5 min-h-5  max-w-5 max-h-5 rounded-full flex items-center justify-center cursor-help transition-all duration-200 ${l==="venta"?"bg-secondary text-neutral-dark":"bg-neutral-dark text-white"}`,children:e.jsxs("svg",{className:" min-w-4 min-h-4",width:"10",height:"10",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M6.5 6.5C6.5 5.39543 7.39543 4.5 8.5 4.5C9.60457 4.5 10.5 5.39543 10.5 6.5C10.5 7.60457 9.60457 8.5 8.5 8.5V9.5",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"8.5",cy:"12",r:"0.5",fill:"currentColor"})]})}),e.jsx("div",{className:`absolute bottom-full mb-5 opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none z-[999]
                                                w-40 max-w-[calc(100vw-2rem)] right-0 sm:w-auto sm:min-w-max sm:right-0`,children:e.jsxs("div",{className:"bg-neutral-dark backdrop-blur-sm text-white rounded-2xl shadow-2xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-3 sm:px-5 sm:py-4",children:[e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("span",{className:"text-xs sm:text-sm leading-tight",children:["Tienes: ",e.jsx("span",{className:"font-semibold text-secondary",children:"Soles"})]})}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("span",{className:"text-xs sm:text-sm leading-tight",children:["Quieres: ",e.jsx("span",{className:"font-semibold text-secondary",children:"DÃ³lares"})]})})]}),e.jsx("div",{className:"bg-white/5 rounded-lg px-2 py-2 sm:px-3",children:e.jsxs("p",{className:"text-xs text-white/80 text-center leading-tight",children:[e.jsx("span",{className:"font-medium text-secondary",children:"Nosotros"})," te vendemos dÃ³lares"]})})]}),e.jsx("div",{className:"absolute top-full right-6",children:e.jsx("div",{className:"w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-neutral-dark"})})]})})]})]})}),a&&F.showPreviousPrice&&e.jsx("div",{className:`absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-white ${F.isActive?"bg-secondary":"bg-yellow-400"}`})]})]}),e.jsxs("div",{className:"flex relative flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center bg-white rounded-2xl shadow-lg p-2 w-full relative",children:[e.jsxs("div",{className:"flex-1 h-full flex flex-col ml-2 justify-center",children:[e.jsx("p",{className:"text-neutral-light text-[8px] uppercase font-semibold",children:l==="compra"?"ENVÃO DÃ“LARES":"ENVÃO SOLES"}),e.jsx("input",{type:"text",placeholder:"0.00",value:b,onChange:t=>{de(t.target.value,"O")},className:"text-lg text-neutral-light bg-transparent border-none outline-none w-full placeholder:text-neutral-light"})]}),e.jsxs("div",{className:"flex items-center bg-secondary bg-opacity-50 rounded-xl px-6 py-3 ml-4",children:[e.jsx("img",{src:l==="compra"?"https://flagcdn.com/w580/us.png":"https://flagcdn.com/w580/pe.png",alt:l==="compra"?"USD Flag":"PEN Flag",className:"w-6 h-6 object-cover rounded-full mr-2"}),e.jsx("span",{className:"text-base font-medium tracking-wide text-neutral-light",children:l==="compra"?"USD":"PEN"})]})]}),e.jsx("div",{className:"absolute right-4 top-8 z-10",children:e.jsx("button",{onClick:Re,className:"bg-constrast text-white p-3 rounded-xl shadow-lg transition-all duration-200 hover:bg-neutral-dark",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M14.9767 17.5C17.4017 15.8876 19 13.1305 19 10C19 5.02944 14.9706 1 10 1C9.3126 1 8.6432 1.07706 8 1.22302M14.9767 17.5V14M14.9767 17.5H18.5M5 2.51555C2.58803 4.13007 1 6.87958 1 10C1 14.9706 5.02944 19 10 19C10.6874 19 11.3568 18.9229 12 18.777M5 2.51555V6M5 2.51555H1.5",stroke:"#FAF3E1",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})}),e.jsxs("div",{className:"flex items-center bg-white rounded-2xl shadow-lg p-2 w-full relative",children:[e.jsxs("div",{className:"flex-1 h-full flex flex-col ml-2 justify-center",children:[e.jsx("p",{className:"text-neutral-light text-[8px] uppercase font-semibold",children:l==="compra"?"RECIBO SOLES":"RECIBO DÃ“LARES"}),e.jsx("input",{type:"text",placeholder:"0.00",value:B,onChange:t=>{de(t.target.value,"D")},className:"text-lg text-neutral-light bg-transparent border-none outline-none w-full placeholder:text-neutral-light"})]}),e.jsxs("div",{className:"flex items-center bg-secondary bg-opacity-50 rounded-xl px-6 py-3 ml-4",children:[e.jsx("img",{src:l==="compra"?"https://flagcdn.com/w580/pe.png":"https://flagcdn.com/w580/us.png",alt:l==="compra"?"PEN Flag":"USD Flag",className:"w-6 h-6 object-cover rounded-full mr-2"}),e.jsx("span",{className:"text-base font-medium tracking-wide text-neutral-light",children:l==="compra"?"PEN":"USD"})]})]})]}),(c||m)&&e.jsx("div",{className:"flex justify-center gap-2 mt-1",children:c&&e.jsx(e.Fragment,{children:ye?e.jsxs("div",{className:"flex-1 flex gap-2 items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",placeholder:"Ingresa tu cupÃ³n promocional",value:I,onChange:t=>_e(t.target.value),className:"w-full py-4 px-4 pr-12 rounded-xl border-2 border-constrast/30 bg-white text-sm text-neutral-dark placeholder:text-neutral-light/60 focus:outline-none focus:border-constrast focus:ring-4 focus:ring-constrast/20 transition-all duration-200 font-paragraph",disabled:Ne,autoFocus:!0}),e.jsx("button",{onClick:()=>{oe(!1),z(""),f.validateCoupon(""),q(null),W(null),ee(b),M(),b&&V("O")},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-light/60 hover:text-neutral-dark transition-colors p-1 hover:bg-neutral/50 rounded-lg",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 4L4 12M4 4L12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsxs("div",{className:"relative group",children:[Ae?e.jsxs("button",{disabled:!0,className:"py-4 px-4 rounded-xl bg-constrast text-white transition-all duration-200 cursor-wait",title:"Consultando cupones disponibles...",children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),e.jsx("div",{className:`absolute bottom-full mb-3 opacity-100 transition-all duration-300 pointer-events-none z-50
                                                               w-52 max-w-[calc(100vw-2rem)] right-0 
                                                               sm:w-auto sm:right-0`,children:e.jsxs("div",{className:"bg-neutral-dark backdrop-blur-sm text-white rounded-lg shadow-2xl border border-white/10 px-2 py-2 sm:px-3 text-center",children:[e.jsx("div",{className:"flex items-center gap-2 justify-center",children:e.jsx("p",{className:"text-xs font-medium",children:"ğŸ” Consultando cupones disponibles..."})}),e.jsx("div",{className:"absolute top-full right-3",children:e.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-neutral-dark"})})]})})]}):Y?e.jsxs("button",{className:"py-4 px-4 rounded-xl bg-red-600  text-white transition-all duration-200",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"8",cy:"8",r:"7",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M8 5v3M8 11h.01",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("div",{className:`absolute bottom-full mb-3 opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none z-50
                                                               w-52 max-w-[calc(100vw-2rem)] right-0 
                                                               sm:w-auto sm:right-0`,children:e.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 backdrop-blur-sm text-white rounded-lg shadow-2xl border border-red-400/20 px-2 py-2 sm:px-3 text-center sm:whitespace-nowrap",children:[e.jsx("div",{className:"flex items-center gap-2 justify-center",children:e.jsx("p",{className:"text-xs font-medium",children:Y.message})}),e.jsx("div",{className:"absolute top-full right-3",children:e.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-red-600"})})]})})]}):a?e.jsx("button",{className:"py-4 px-4 rounded-xl bg-green-600 text-white transition-all duration-200",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M8 1L10.5 6L16 6.75L12 10.5L13 16L8 13L3 16L4 10.5L0 6.75L5.5 6L8 1Z",fill:"currentColor"})})}):e.jsxs("button",{onClick:De,className:"py-3 px-3 rounded-xl bg-constrast hover:bg-neutral-dark text-white transition-all duration-200 group",title:"Consultar cupones disponibles",children:[e.jsx(Ge,{}),e.jsx("div",{className:`absolute bottom-full mb-3 opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none z-50
                                                               w-48 max-w-[calc(100vw-2rem)] right-0 
                                                               sm:w-auto sm:right-0`,children:e.jsxs("div",{className:"bg-neutral-dark backdrop-blur-sm text-white rounded-lg shadow-2xl border border-white/10 px-2 py-2 sm:px-3 text-center sm:whitespace-nowrap",children:[e.jsx("p",{className:"text-xs font-medium",children:"ğŸ’¡ Click aqui para validar el cupÃ³n"}),e.jsx("div",{className:"absolute top-full right-3",children:e.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-neutral-dark"})})]})})]}),a&&e.jsx("div",{className:`absolute bottom-full mb-3 opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none z-50
                                                           w-72 max-w-[calc(100vw-2rem)] right-0 
                                                           sm:w-72 sm:right-0`,children:e.jsxs("div",{className:"bg-neutral-dark backdrop-blur-sm text-white rounded-2xl shadow-2xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-3 sm:px-5 sm:py-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-secondary to-green-500 rounded-full flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"sm:w-4 sm:h-4",children:e.jsx("path",{d:"M8 1L10.5 6L16 6.75L12 10.5L13 16L8 13L3 16L4 10.5L0 6.75L5.5 6L8 1Z",fill:"white"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h4",{className:"font-bold text-secondary text-xs sm:text-sm truncate",children:["CUPÃ“N ",a.codigo]}),e.jsx("p",{className:"text-xs text-white",children:"âœ… Validado y aplicado"})]})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3 mb-3 sm:mb-4",children:a.rangos&&a.rangos.length>1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-secondary mb-2",children:"RANGOS DISPONIBLES"}),e.jsx("div",{className:"space-y-2",children:a.rangos.filter(t=>t&&(t.montoMinimo!=null||t.desde!=null)&&(t.montoMaximo!=null||t.hasta!=null)).map((t,o)=>{const s=$(b),n=$(B);let r=0;if(l==="venta"){if(n>0)r=n;else if(s>0){const u=f.tcBase[0];u&&(r=s/u.tc_venta)}}else if(s>0)r=s;else if(n>0){const u=f.tcBase[0];u&&(r=n/u.tc_compra)}const d=t.montoMinimo??t.desde??0,x=t.montoMaximo??t.hasta??0,g=t.tcCompra??t.tc_compra??"N/A",w=t.tcVenta??t.tc_venta??"N/A",E=a.rangos.filter(u=>u&&(u.montoMinimo!=null||u.desde!=null)&&(u.montoMaximo!=null||u.hasta!=null)),y=o===E.length-1,k=.1,j=r>0&&(y?d-k<=r&&r<=x:d-k<=r&&r<x);return console.log(`ğŸ” SEGUNDO TOOLTIP CORREGIDO - Rango ${o+1}: min=${d}, max=${x}, amount=${r}, isCurrentRange=${j}, isLast=${y}`),e.jsxs("div",{className:`flex justify-between items-center p-2 rounded-md text-xs ${j?"bg-secondary/20 border border-secondary/40":"bg-white/5"}`,children:[e.jsxs("span",{className:"font-medium",children:["$",(d||0).toLocaleString()," - $",(x||0).toLocaleString(),j&&e.jsx("span",{className:"ml-1 text-secondary",children:"âœ“"})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{children:["C: ",typeof g=="number"?g.toFixed(3):g]}),e.jsxs("span",{children:["V: ",typeof w=="number"?w.toFixed(3):w]})]})]},o)})})]}),C&&e.jsxs("div",{className:"grid grid-cols-2 gap-1 sm:gap-2",children:[e.jsxs("div",{className:"bg-secondary/10 border border-secondary/30 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-secondary mb-1",children:"COMPRA"}),e.jsxs("p",{className:"text-xs sm:text-sm font-bold",children:["S/ ",(C.tcCompra??C.tc_compra??"N/A").toFixed?(C.tcCompra??C.tc_compra).toFixed(3):"N/A"]})]}),e.jsxs("div",{className:"bg-secondary/10 border border-secondary/30 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-secondary mb-1",children:"VENTA "}),e.jsxs("p",{className:"text-xs sm:text-sm font-bold",children:["S/ ",(C.tcVenta??C.tc_venta??"N/A").toFixed?(C.tcVenta??C.tc_venta).toFixed(3):"N/A"]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-secondary mb-1 sm:mb-2",children:"RANGO VÃLIDO"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium",children:["$",a.montoMinimo," - $",a.montoMaximo," USD"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 sm:gap-2",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-secondary mb-1",children:"COMPRA"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium",children:["S/ ",a.tcCompra.toFixed(4)]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-secondary mb-1",children:"VENTA"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium",children:["S/ ",a.tcVenta.toFixed(4)]})]})]})]})}),e.jsxs("div",{className:"border rounded-lg px-2 py-2 sm:px-3 text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx("p",{className:"text-xs font-medium",children:"ğŸ‰ CupÃ³n activo"})}),e.jsx("p",{className:"text-xs text-white/70 mt-1",children:"Disfruta de tu tasa preferencial"})]})]}),e.jsx("div",{className:"absolute top-full right-6",children:e.jsx("div",{className:"w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-neutral-dark"})})]})})]})]}):e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsxs("button",{onClick:()=>{oe(!0)},className:"flex-1 justify-center flex gap-3 items-center py-4 px-4 rounded-xl font-medium text-sm transition-all duration-200 border-2 group relative text-neutral-dark hover:bg-neutral hover:shadow-md border-transparent hover:border-secondary/30",title:"Ingresa tu cupÃ³n promocional para obtener una tasa preferencial",children:["USAR CUPÃ“N",e.jsxs("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M7.74985 14.3412L6.39628 13.5378C6.05276 13.3339 5.88099 13.2319 5.69036 13.2261C5.48436 13.2197 5.30956 13.3175 4.93835 13.5378C4.52261 13.7846 3.69594 14.4643 3.1612 14.1402C2.83398 13.9418 2.83398 13.4379 2.83398 12.4301V5.33301C2.83398 3.44739 2.83398 2.50458 3.41977 1.91879C4.00556 1.33301 4.94836 1.33301 6.83398 1.33301H10.1673C12.0529 1.33301 12.9957 1.33301 13.5815 1.91879C14.1673 2.50458 14.1673 3.44739 14.1673 5.33301V12.4301C14.1673 13.4379 14.1673 13.9418 13.8401 14.1402C13.3054 14.4643 12.4787 13.7846 12.0629 13.5378C11.7194 13.3339 11.5477 13.2319 11.3571 13.2261C11.1511 13.2197 10.9763 13.3175 10.6051 13.5378L9.25145 14.3412C8.88638 14.5579 8.70378 14.6663 8.50065 14.6663C8.29752 14.6663 8.11492 14.5579 7.74985 14.3412Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10.5 5.33301L6.5 9.33301",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10.5 9.33301H10.494M6.50598 5.33301H6.5",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("div",{className:`absolute bottom-full mb-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 
                                                       w-56 max-w-[calc(100vw-2rem)] right-0 
                                                       sm:w-auto sm:whitespace-nowrap`,children:e.jsxs("div",{className:"bg-neutral-dark text-white text-xs rounded-lg px-2 py-2 sm:px-3 text-center",children:["ğŸ’¡ ObtÃ©n tasas preferenciales con tu cÃ³digo promocional",e.jsx("div",{className:"absolute top-full right-6 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-neutral-dark"})]})})]}),a&&e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"py-4 px-3 rounded-xl bg-constrast/10 border-2 border-constrast/30 hover:bg-constrast/20 transition-all duration-200",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"8",cy:"8",r:"7",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M8 12V8M8 5.5H8.01",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),e.jsx("div",{className:`absolute bottom-full mb-3 opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none z-50
                                                           w-72 max-w-[calc(100vw-2rem)] right-0 
                                                           sm:w-72 sm:right-0`,children:e.jsxs("div",{className:"bg-neutral-dark backdrop-blur-sm text-white rounded-2xl shadow-2xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-3 sm:px-5 sm:py-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-constrast to-constrast/80 rounded-full flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"sm:w-4 sm:h-4",children:e.jsx("path",{d:"M8 1L10.5 6L16 6.75L12 10.5L13 16L8 13L3 16L4 10.5L0 6.75L5.5 6L8 1Z",fill:"#F9F3E0"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h4",{className:"font-bold text-constrast text-xs sm:text-sm truncate",children:["CUPÃ“N ",a.codigo]}),e.jsx("p",{className:"text-xs text-white/70",children:"Actualmente aplicado"})]})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3 mb-3 sm:mb-4",children:a!=null&&a.rangos&&a.rangos.length>1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-constrast mb-2",children:"RANGOS DISPONIBLES"}),e.jsx("div",{className:"space-y-2",children:a.rangos.filter(t=>t&&(t.montoMinimo!=null||t.desde!=null)&&(t.montoMaximo!=null||t.hasta!=null)).map((t,o)=>{const s=$(b),n=$(B);let r=0,d="USD";if(l==="venta"){if(n>0)d="USD",r=n;else if(s>0){d="PEN";const N=f.tcBase[0];N&&(r=s/N.tc_venta)}}else if(s>0)d="USD",r=s;else if(n>0){d="PEN";const N=f.tcBase[0];N&&(r=n/N.tc_compra)}const x=t.montoMinimo??t.desde??0,g=t.montoMaximo??t.hasta??0,w=t.tcCompra??t.tc_compra??"N/A",E=t.tcVenta??t.tc_venta??"N/A",y=a.rangos.filter(N=>N&&(N.montoMinimo!=null||N.desde!=null)&&(N.montoMaximo!=null||N.hasta!=null)),k=o===y.length-1,j=.1,u=r>0&&(k?x-j<=r&&r<=g:x-j<=r&&r<g);let _=x,P=g;if(d==="PEN"){const N=f.tcBase[0];N&&(l==="venta"?(_=x*N.tc_venta,P=g*N.tc_venta):(_=x*N.tc_compra,P=g*N.tc_compra))}return console.log(`ğŸ” TOOLTIP CORREGIDO - Rango ${o+1}: min=${x}, max=${g}, amount=${r}, isCurrentRange=${u}, isLast=${k}`),e.jsxs("div",{className:`flex justify-between items-center p-2 rounded-md text-xs ${u?"bg-constrast/20 border border-constrast/40":"bg-white/5"}`,children:[e.jsxs("span",{className:"font-medium",children:[d==="USD"?`$${(x||0).toLocaleString()} - $${(g||0).toLocaleString()} `:`S/${(_||0).toLocaleString()} - S/${(P||0).toLocaleString()} `,u&&e.jsx("span",{className:"ml-1 text-constrast",children:"âœ“"})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{children:["C: ",typeof w=="number"?w.toFixed(4):w]}),e.jsxs("span",{children:["V: ",typeof E=="number"?E.toFixed(4):E]})]})]},o)})})]}),C&&e.jsxs("div",{className:"grid grid-cols-2 gap-1 sm:gap-2",children:[e.jsxs("div",{className:"bg-constrast/10 border border-constrast/30 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-constrast mb-1",children:"COMPRA"}),e.jsxs("p",{className:"text-xs sm:text-sm font-bold",children:["S/ ",(C.tcCompra??C.tc_compra??"N/A").toFixed?(C.tcCompra??C.tc_compra).toFixed(4):"N/A"]})]}),e.jsxs("div",{className:"bg-constrast/10 border border-constrast/30 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-constrast mb-1",children:"VENTA"}),e.jsxs("p",{className:"text-xs sm:text-sm font-bold",children:["S/ ",(C.tcVenta??C.tc_venta??"N/A").toFixed?(C.tcVenta??C.tc_venta).toFixed(4):"N/A"]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-constrast mb-1 sm:mb-2",children:"RANGO VÃLIDO"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium",children:["$",a.montoMinimo," - $",a.montoMaximo," USD"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 sm:gap-2",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-constrast mb-1",children:"COMPRA"}),e.jsxs("p",{className:"text-xs sm:text-sm font-bold",children:["S/ ",a.tcCompra.toFixed(4)]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 sm:p-3",children:[e.jsx("h5",{className:"text-xs font-semibold text-constrast mb-1",children:"VENTA"}),e.jsxs("p",{className:"text-xs sm:text-sm font-bold",children:["S/ ",a.tcVenta.toFixed(4)]})]})]})]})}),e.jsxs("div",{className:`rounded-lg px-2 py-2 sm:px-3 text-center ${H.applies?"bg-green-500/20 border border-secondary/30":"bg-yellow-500/20 border border-yellow-400/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${H.applies?"bg-secondary":"bg-yellow-400"}`}),e.jsx("p",{className:"text-xs font-medium",children:H.applies?"âœ… CupÃ³n activo":"â³ CupÃ³n disponible"})]}),!H.applies&&e.jsx("p",{className:"text-xs text-white/70 mt-1",children:H.reason})]})]}),e.jsx("div",{className:"absolute top-full right-6",children:e.jsx("div",{className:"w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-neutral-dark"})})]})})]})]})})}),e.jsxs("div",{className:"bg-white rounded-xl p-4 text-xs text-neutral-light mt-2",children:["Operaciones mayores a USD 5,000.00. Consigue un tipo de cambio preferencial"," ",e.jsxs(Ue,{children:[e.jsx("span",{className:"text-constrast underline font-medium",children:"AQUÃ"})," "]})]}),e.jsx("button",{onClick:Te,className:"mt-3 py-4 rounded-full bg-neutral-dark text-white font-semibold tracking-wider text-sm w-full hover:bg-constrast transition-all duration-200",children:"INICIAR OPERACIÃ“N"})]})};export{tt as E};
