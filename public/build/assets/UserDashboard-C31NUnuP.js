import{j as e}from"./RequirementCard-DEdD30eg.js";import{r}from"./index-RYns6xqu.js";import{c as A}from"./ReactAppend-vpV7VTGG.js";import{C as D}from"./CreateReactScript-BuKYEKxn.js";import{B as P}from"./Base-B0jCVaQs.js";import{H as _}from"./Header-CbCCnhjC.js";import{F as L}from"./Footer-DMqmIg0o.js";import"./index-CXU7o9CY.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./main-Y8JAyXgE.js";/* empty css               *//* empty css              */import"./Filter-CpekYgBC.js";import"./Detail-BUTDw3GY.js";import"./Results-BBVbNL2k.js";import"./useTranslation-CZbMeh78.js";import"./createLucideIcon-D_WcjKff.js";import"./proxy-Dg7W2VMC.js";import"./index-SDlHnhXR.js";import"./index-DNUR7M9R.js";import"./HtmlContent-CZmf3wHb.js";import"./sweetalert2.all-DJo0UVK6.js";const B=({user:h,properties:n})=>{const[d,u]=r.useState(n||[]),[c,v]=r.useState("30"),[p,b]=r.useState(null),[N,j]=r.useState(!0),[o,f]=r.useState(null),[x,y]=r.useState(null),[l,m]=r.useState("overview");r.useEffect(()=>{w()},[c]);const w=async()=>{try{j(!0);const s=new Date().toISOString().split("T")[0],t=new Date(Date.now()-parseInt(c)*24*60*60*1e3).toISOString().split("T")[0],i=await fetch(`/api/user-dashboard?start_date=${t}&end_date=${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`,"Content-Type":"application/json"}});if(i.ok){const a=await i.json();b(a),u(a.properties)}}catch(s){console.error("Error loading dashboard data:",s)}finally{j(!1)}},k=async s=>{try{const t=new Date().toISOString().split("T")[0],i=new Date(Date.now()-parseInt(c)*24*60*60*1e3).toISOString().split("T")[0],a=await fetch(`/api/property-metrics/${s}?start_date=${i}&end_date=${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`,"Content-Type":"application/json"}});if(a.ok){const M=await a.json();y(M)}}catch(t){console.error("Error loading property metrics:",t)}},C=s=>{f(s),m("metrics"),k(s.id)},S=s=>s.admin_approved?s.active?s.featured?e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Activa • Destacada"}):e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Activa"}):e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Inactiva"}):e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Pendiente Aprobación"}),g=(p==null?void 0:p.total_metrics)||{};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(_,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mi Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Bienvenido, ",h.name,". Aquí puedes ver el rendimiento de tus propiedades."]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>m("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${l==="overview"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Resumen General"}),e.jsx("button",{onClick:()=>m("properties"),className:`py-2 px-1 border-b-2 font-medium text-sm ${l==="properties"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Mis Propiedades"}),o&&e.jsxs("button",{onClick:()=>m("metrics"),className:`py-2 px-1 border-b-2 font-medium text-sm ${l==="metrics"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Métricas: ",o.title]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Período de análisis:"}),e.jsxs("select",{value:c,onChange:s=>v(s.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500",children:[e.jsx("option",{value:"7",children:"Últimos 7 días"}),e.jsx("option",{value:"30",children:"Últimos 30 días"}),e.jsx("option",{value:"90",children:"Últimos 3 meses"}),e.jsx("option",{value:"365",children:"Último año"})]})]}),N?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando datos..."})]}):e.jsxs(e.Fragment,{children:[l==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("svg",{className:"h-8 w-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Visualizaciones"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:g.view||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-8 w-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clicks a Airbnb"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:g.click_airbnb||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-8 w-8 text-green-500",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clicks a WhatsApp"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:g.click_whatsapp||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-8 w-8 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mis Propiedades"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:d.length})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Resumen de Propiedades"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:d.filter(s=>s.admin_approved&&s.active).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Activas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:d.filter(s=>!s.admin_approved).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pendiente Aprobación"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:d.filter(s=>s.featured).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Destacadas"})]})]})})]})]}),l==="properties"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Mis Propiedades"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Propiedad"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Visualizaciones"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clicks Airbnb"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clicks WhatsApp"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(s=>{var t,i,a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-200 flex items-center justify-center",children:e.jsx("svg",{className:"h-6 w-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h3M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500",children:s.slug})]})]})}),e.jsx("td",{className:"px-6 py-4",children:S(s)}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:((t=s.metrics)==null?void 0:t.view)||0}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:((i=s.metrics)==null?void 0:i.click_airbnb)||0}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:((a=s.metrics)==null?void 0:a.click_whatsapp)||0}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>C(s),className:"text-red-600 hover:text-red-900",children:"Ver Métricas"}),e.jsx("a",{href:`/property/${s.slug}`,target:"_blank",className:"text-blue-600 hover:text-blue-900",children:"Ver Propiedad"})]})]},s.id)})})]})})]}),l==="metrics"&&o&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Métricas detalladas: ",o.title]}),x?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.summary.view||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Visualizaciones"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:x.summary.click_airbnb||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Clicks a Airbnb"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.summary.click_whatsapp||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Clicks a WhatsApp"})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando métricas..."})]})]})})]})]}),e.jsx(L,{})]})};D((h,n)=>{A(h).render(e.jsx(P,{...n,children:e.jsx(B,{...n})}))});
