import{j as e}from"./RequirementCard-DEdD30eg.js";import{C as y,e as g,af as w,h as b,ag as R}from"./CreateReactScript-C-mUikVe.js";import{r as d}from"./index-RYns6xqu.js";import{c as C}from"./ReactAppend-vpV7VTGG.js";import{m as n}from"./DataGrid-Cd7cnf9r.js";import"./TippyButton-Duhaw_sS.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./index-CXU7o9CY.js";import"./MenuItem-CBKDeUjr.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./Results-CoLI09XT.js";import"./sweetalert2.all-DJo0UVK6.js";import"./DxBox-DZgBbgD6.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const S=m=>{const s=d.useRef(),p=d.useRef(),[t,u]=d.useState(m.session),j=async c=>{c.preventDefault();const a={name:s.current.value,lastname:p.current.value};if(!await R.save(a))return;const r=structuredClone(t);r.name=a.name,r.lastname=a.lastname,r.birthdate=a.birthdate,u(r)},v=async c=>{const a=c.target.files[0];if(a)try{const{full:o,thumbnail:r,type:f,ok:N}=await File.compress(a);if(!N)throw new Error("Ocurrio un error al comprimir la imagen. Intenta con otra.");const l=new FormData;l.append("thumbnail",await File.fromURL(`data:${f};base64,${r}`)),l.append("full",await File.fromURL(`data:${f};base64,${o}`));const x=await fetch("/api/admin/profile",{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(n.Cookies.get("XSRF-TOKEN"))},body:l}),i=n.JSON.parseable(await x.text());if(!x.ok)throw new Error((i==null?void 0:i.message)??"Ocurrio un error inesperado");const h=structuredClone(t);h.relative_id=i.data.relative_id,u(h),n.Notify.add({icon:"/assets/img/favicon.png",title:"Correcto",body:"La imagen de perfil se actualizo correctamente",type:"success"})}catch(o){n.Notify.add({icon:"/assets/img/favicon.png",title:"Error",body:o.message,type:"danger"})}};return e.jsx("div",{className:"row justify-content-center align-items-center",style:{height:"calc(100vh - 135px)"},children:e.jsx("div",{className:"col-xl-3 col-lg-4 col-md-6 col-sm-8 col-xs-12",children:e.jsxs("form",{className:"card",onSubmit:j,children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"card-title mb-0",children:"Perfil"})}),e.jsxs("div",{className:"card-body",children:[e.jsx(w,{content:"Cambiar foto de perfil",arrow:!0,children:e.jsxs("label",{htmlFor:"avatar",className:"rounded-circle mx-auto d-block",style:{cursor:"pointer",width:"max-content"},children:[e.jsx("input",{className:"d-none",type:"file",name:"avatar",id:"avatar",accept:"image/*",onChange:v}),e.jsx("img",{className:"avatar-xl rounded-circle",src:`/api/admin/profile/${t.relative_id}?v=${crypto.randomUUID()}`,alt:`Perfil de ${t.name} ${t.lastname}`,style:{objectFit:"cover",objectPosition:"center"}})]})}),e.jsx("hr",{className:"mt-3 mb-2"}),e.jsx(b,{eRef:s,label:"Nombres",value:t.name,required:!0}),e.jsx(b,{eRef:p,label:"Apellidos",value:t.lastname,required:!0}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn btn-primary btn-block",type:"submit",children:[e.jsx("i",{className:"fa fa-save"})," Actualizar"]})}),e.jsx("hr",{className:"mt-3 mb-2"}),e.jsx("p",{className:"card-text text-center",children:e.jsxs("small",{className:"text-muted",children:["Ultima actualizacion ",moment(t.updated_at).fromNow()]})})]})]})})})};y((m,s)=>{C(m).render(e.jsx(g,{...s,title:"Perfil de usuario",children:e.jsx(S,{...s})}))});
