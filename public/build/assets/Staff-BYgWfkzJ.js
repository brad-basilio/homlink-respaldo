import{j as s}from"./RequirementCard-DEdD30eg.js";import{r}from"./index-RYns6xqu.js";import{C as E,e as D,s as F,R as k,D as j,l as B,j as T,h as v,av as G}from"./CreateReactScript-C-mUikVe.js";import{c as I}from"./ReactAppend-vpV7VTGG.js";import{r as A}from"./DxBox-DZgBbgD6.js";import{S as M}from"./sweetalert2.all-DJo0UVK6.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./index-CXU7o9CY.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./Results-CoLI09XT.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const x=new G,q=()=>{const n=r.useRef(),o=r.useRef(),p=r.useRef(),u=r.useRef(),f=r.useRef(),a=r.useRef(),[O,d]=r.useState([{value:""}]),[l,c]=r.useState([{value:""}]),[g,R]=r.useState(!1),S=()=>{c([...l,{value:""}])},N=(e,t)=>{const i=[...l];i[e].value=t,c(i)},w=e=>{if(l.length<=1)return;const t=l.filter((i,m)=>m!==e);c(t)},b=e=>{R(!!(e!=null&&e.id)),p.current.value=(e==null?void 0:e.id)||"",u.current.value=(e==null?void 0:e.name)||"",f.current.value=(e==null?void 0:e.job)||"",a.current.value=null,e!=null&&e.image&&(a.image.src=`/api/staff/media/${e.image}`),e!=null&&e.characteristics&&e.characteristics.length>0?d(e.characteristics.map(t=>({value:t}))):d([{value:""}]),e!=null&&e.socials&&e.socials.length>0?c(e.socials.map(t=>({value:t}))):c([{value:""}]),$(o.current).modal("show")},C=async e=>{e.preventDefault();const t=new FormData;t.append("name",u.current.value),t.append("job",f.current.value),g&&t.append("id",p.current.value),a.current.files[0]&&t.append("image",a.current.files[0]);const i=l.map(h=>h.value.trim()).filter(h=>h.length>0);t.append("socials",JSON.stringify(i)),await x.save(t)&&($(n.current).dxDataGrid("instance").refresh(),$(o.current).modal("hide"),setGallery([]),d([{value:""}]))},y=async e=>{const{isConfirmed:t}=await M.fire({title:"Eliminar Staff",text:"¿Estás seguro de eliminar este problema?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await x.delete(e)||$(n.current).dxDataGrid("instance").refresh()};return s.jsxs(s.Fragment,{children:[s.jsx(F,{gridRef:n,title:"Staff",rest:x,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nuevo Staff",onClick:()=>b()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre",width:"200px"},{},{dataField:"socials",caption:"Redes sociales",cellTemplate:(e,{data:t})=>{t.socials&&e.html(A(s.jsxs("ul",{className:"m-0 ps-3",children:[t.socials.slice(0,2).map((i,m)=>s.jsx("li",{className:"text-truncate",style:{maxWidth:"250px"},children:s.jsxs("small",{children:["• ",i]})},m)),t.socials.length>2&&s.jsx("li",{children:s.jsxs("small",{className:"text-muted",children:["+",t.socials.length-2," ","más..."]})})]})))}},{dataField:"image",caption:"Imagen",width:"100px",cellTemplate:(e,{data:t})=>{k(e,s.jsx("img",{src:`/api/staff/media/${t.image}`,style:{width:"80px",height:"45px",objectFit:"cover",borderRadius:"4px"},onError:i=>i.target.src="/images/default-thumbnail.jpg"}))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:t})=>{e.append(j({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>b(t)})),e.append(j({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>y(t.id)}))}}]}),s.jsxs(B,{modalRef:o,title:g?"Editar Staff":"Nuevo Staff",onSubmit:C,size:"lg",children:[s.jsx("input",{ref:p,type:"hidden"}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6",children:s.jsx(T,{eRef:a,label:"Imagen principal",aspect:1})}),s.jsxs("div",{className:"col-md-6",children:[s.jsx(v,{eRef:u,label:"Nombre",required:!0}),s.jsx(v,{eRef:f,label:"Puesto laboral",required:!0}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Redes sociales"}),l.map((e,t)=>s.jsxs("div",{className:"input-group mb-2",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: https://linkedin.com/in/tu-perfil",value:e.value,onChange:i=>N(t,i.target.value)}),s.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>w(t),disabled:l.length<=1,children:s.jsx("i",{className:"fas fa-times"})})]},t)),s.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:S,children:[s.jsx("i",{className:"fas fa-plus me-1"})," Agregar red social"]})]})]})]})]})]})};E((n,o)=>{I(n).render(s.jsx(D,{...o,title:"Staff",children:s.jsx(q,{...o})}))});
