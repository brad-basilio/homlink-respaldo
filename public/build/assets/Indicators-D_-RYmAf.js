import{j as i}from"./RequirementCard-DEdD30eg.js";import{r as o}from"./index-RYns6xqu.js";import{c as T}from"./ReactAppend-vpV7VTGG.js";import{C as D,e as E,T as I,R as a,S,D as g,M as N,j as G,I as R,o as k,f as B,a4 as M}from"./CreateReactScript-C-mUikVe.js";import{S as O}from"./sweetalert2.all-DJo0UVK6.js";import"./index-CXU7o9CY.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./Results-CoLI09XT.js";import"./DxBox-DZgBbgD6.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const d=new M,j=[{value:"inicio_hero",text:"Inicio - Hero"},{value:"inicio_cupones",text:"Inicio - Cupones"},{value:"empresas_stats",text:"Empresas - Estadísticas"}],A=()=>{const n=o.useRef(),s=o.useRef(),m=o.useRef(),l=o.useRef(),p=o.useRef(),u=o.useRef(),f=o.useRef(),x=o.useRef(),[w,v]=o.useState(!1),h=e=>{e!=null&&e.id?v(!0):v(!1),m.current.value=(e==null?void 0:e.id)??"",l.image.src=`/api/indicator/media/${e==null?void 0:e.symbol}`,l.current.value=null,p.current.value=(e==null?void 0:e.name)??"",u.current.value=(e==null?void 0:e.description)??"",f.current.value=(e==null?void 0:e.correlative)??"",x.current.value=(e==null?void 0:e.order)??"",$(s.current).modal("show")},F=async e=>{e.preventDefault();const r={id:m.current.value||void 0,name:p.current.value,description:u.current.value,correlative:f.current.value,order:x.current.value},t=new FormData;for(const b in r)t.append(b,r[b]);const c=l.current.files[0];c&&t.append("symbol",c),await d.save(t)&&($(n.current).dxDataGrid("instance").refresh(),$(s.current).modal("hide"))},y=async({id:e,value:r})=>{await d.boolean({id:e,field:"visible",value:r})&&$(n.current).dxDataGrid("instance").refresh()},C=async e=>{const{isConfirmed:r}=await O.fire({title:"Eliminar indicador",text:"¿Estas seguro de eliminar este indicador?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!r||!await d.delete(e)||$(n.current).dxDataGrid("instance").refresh()};return i.jsxs(i.Fragment,{children:[i.jsx(I,{gridRef:n,title:"Indicadores",rest:d,sorting:{mode:"multiple"},defaultSort:[{field:"correlative",direction:"asc"},{field:"order",direction:"asc"}],toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo indicador",hint:"Nuevo indicador",onClick:()=>h()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"symbol",caption:"Imagen",width:"60px",allowFiltering:!1,cellTemplate:(e,{data:r})=>{a(e,i.jsx("img",{style:{objectFit:"cover",objectPosition:"center",backgroundColor:"rgba(0, 0, 0, 0.1)",width:"100%",height:"auto"},src:`/api/indicator/media/${r.symbol}`,alt:r.name,onError:t=>t.target.src="/api/cover/thumbnail/null"}))}},{dataField:"name",caption:"Titulo"},{dataField:"correlative",caption:"Correlativo",width:"120px",cellTemplate:(e,{data:r})=>{const t=j.find(c=>c.value===r.correlative);a(e,i.jsx("span",{className:"badge bg-info",children:t?t.text:r.correlative||"Sin asignar"}))}},{dataField:"order",caption:"Orden",width:"80px",dataType:"number",cellTemplate:(e,{data:r})=>{a(e,i.jsx("span",{className:"badge bg-secondary",children:r.order||0}))}},{dataField:"percentage",caption:"Porcentaje"},{dataField:"description",caption:"Descripción"},{dataField:"visible",caption:"Visible",dataType:"boolean",width:"100px",cellTemplate:(e,{data:r})=>{$(e).empty(),a(e,i.jsx(S,{checked:r.visible==1,onChange:()=>y({id:r.id,value:!r.visible})}))}},{caption:"Acciones",width:"110px",cellTemplate:(e,{data:r})=>{e.append(g({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>h(r)})),e.append(g({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>C(r.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsx(N,{modalRef:s,title:w?"Editar término":"Agregar término",onSubmit:F,size:"md",children:i.jsxs("div",{className:"row",id:"indicators-container",children:[i.jsx("input",{ref:m,type:"hidden"}),i.jsx(G,{eRef:l,label:"Imagen",aspect:1,fit:"cover",col:"col-sm-4"}),i.jsxs("div",{className:"col-md-8",children:[i.jsx(R,{eRef:p,label:"Título"}),i.jsxs("div",{className:"row",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(k,{eRef:f,label:"Correlativo",required:!0,dropdownParent:"#indicators-container",children:j.map(e=>i.jsx("option",{value:e.value,children:e.text},e.value))})}),i.jsx("div",{className:"col-md-6",children:i.jsx(R,{eRef:x,type:"number",label:"Orden",placeholder:"1, 2, 3...",min:"0",step:"1"})})]}),i.jsx(B,{eRef:u,label:"Descripción"})]})]})})]})};D((n,s)=>{T(n).render(i.jsx(E,{...s,title:"Indicadores",children:i.jsx(A,{...s})}))});
