import{j as e}from"./RequirementCard-DEdD30eg.js";import{r as d}from"./index-RYns6xqu.js";import{c as T}from"./ReactAppend-vpV7VTGG.js";import{C as I,e as V}from"./CreateReactScript-C-mUikVe.js";import"./index-CXU7o9CY.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./Results-CoLI09XT.js";import"./sweetalert2.all-DJo0UVK6.js";import"./DxBox-DZgBbgD6.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const F=({session:k})=>{const[l,A]=d.useState(null),[c,b]=d.useState("30"),[M,C]=d.useState(!0),[j,N]=d.useState("overview"),[n,P]=d.useState(null),g=d.useRef(null),v=d.useRef(null),[u,R]=d.useState({}),[x,z]=d.useState(null),[D,S]=d.useState(!1);d.useEffect(()=>{U()},[c]),d.useEffect(()=>{if(window.Chart)l&&$();else{const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/chart.js",s.onload=()=>{console.log("📊 Chart.js cargado correctamente"),l&&$()},document.head.appendChild(s)}},[l]),d.useEffect(()=>()=>{Object.values(u).forEach(s=>{s&&typeof s.destroy=="function"&&s.destroy()})},[u]);const U=async()=>{var s;try{C(!0);const i=new Date().toISOString().split("T")[0],t=new Date(Date.now()-parseInt(c)*24*60*60*1e3).toISOString().split("T")[0];console.log("🔄 Cargando métricas del dashboard...",{startDate:t,endDate:i});const o=await fetch(`/api/admin-dashboard-metrics?date_from=${t}&date_to=${i}`,{headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}});if(o.ok){const h=await o.json();console.log("📊 Datos del dashboard recibidos:",h),A(h);const m=h.global_metrics||{},_={labels:["Vistas","Clicks Airbnb","Galería"],data:[m.property_view||0,m.airbnb_click||0,m.gallery_view||0],colors:["#727cf5","#fa5c7c","#0acf97"]};P(_)}else console.error("❌ Error en respuesta del servidor:",o.status,o.statusText)}catch(i){console.error("❌ Error cargando datos del dashboard:",i)}finally{C(!1)}},$=()=>{if(!window.Chart||!n)return;Object.values(u).forEach(i=>{i&&typeof i.destroy=="function"&&i.destroy()});const s={};if(g.current){const i=g.current.getContext("2d");s.barChart=new window.Chart(i,{type:"bar",data:{labels:n.labels,datasets:[{label:"Interacciones",data:n.data,backgroundColor:n.colors.map(t=>t+"40"),borderColor:n.colors,borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"white",bodyColor:"white",borderColor:"#727cf5",borderWidth:1}},scales:{y:{beginAtZero:!0,grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{color:"#8391a2"}},x:{grid:{display:!1},ticks:{color:"#8391a2"}}}}})}if(v.current){const i=v.current.getContext("2d");s.pieChart=new window.Chart(i,{type:"doughnut",data:{labels:n.labels,datasets:[{data:n.data,backgroundColor:n.colors.map(t=>t+"80"),borderColor:n.colors,borderWidth:2,hoverBackgroundColor:n.colors.map(t=>t+"CC"),hoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,color:"#8391a2"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"white",bodyColor:"white",borderColor:"#727cf5",borderWidth:1,callbacks:{label:function(t){const o=t.dataset.data.reduce((m,_)=>m+_,0),h=o>0?(t.parsed/o*100).toFixed(1):0;return`${t.label}: ${t.parsed} (${h}%)`}}}},cutout:"60%"}})}R(s),console.log("📊 Gráficas creadas exitosamente:",s)},r=s=>s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":(s==null?void 0:s.toString())||"0",E=s=>{z(s),S(!0)},f=()=>{S(!1),z(null)},p=({title:s,value:i,icon:t,color:o,subtitle:h,trend:m})=>e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:`avatar-md bg-${o} bg-gradient rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"50px",height:"50px"},children:e.jsx("i",{className:`${t} text-white`,style:{fontSize:"20px"}})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"text-muted mb-1 font-size-13",children:s}),e.jsx("h3",{className:`mb-0 text-${o}`,children:r(i)}),h&&e.jsx("p",{className:"text-muted mb-0 font-size-11",children:h}),m&&e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:`badge badge-soft-${m.type} font-size-10`,children:[e.jsx("i",{className:`mdi mdi-arrow-${m.type==="success"?"up":"down"}-bold me-1`}),m.value,"%"]})})]})]})})});if(M)return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"page-title-box",children:[e.jsx("h4",{className:"page-title text-dark",children:"📊 Métricas de Propiedades"}),e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx("a",{href:"/admin",className:"text-primary",children:"Dashboard"})}),e.jsx("li",{className:"breadcrumb-item active text-muted",children:"Métricas"})]})]})})}),e.jsx("div",{className:"row justify-content-center",style:{minHeight:"400px"},children:e.jsx("div",{className:"col-md-6 d-flex align-items-center justify-content-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner-border text-primary mb-3",role:"status",style:{width:"3rem",height:"3rem"},children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}),e.jsx("h5",{className:"text-dark mb-2",children:"Cargando datos de métricas..."}),e.jsx("p",{className:"text-muted",children:"Por favor espera mientras procesamos la información"})]})})})]});const a=(l==null?void 0:l.global_metrics)||{},y=(l==null?void 0:l.top_properties)||[],w=(l==null?void 0:l.top_users)||[];return l&&console.log("📈 Métricas procesadas:",{globalMetrics:a,totalViews:a.property_view||0,totalAirbnb:a.airbnb_click||0,totalGallery:a.gallery_view||0,airbnbConversion:a.property_view>0?((a.airbnb_click||0)/a.property_view*100).toFixed(1):"0.0",galleryConversion:a.property_view>0?((a.gallery_view||0)/a.property_view*100).toFixed(1):"0.0"}),e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"page-title-box bg-primary text-white rounded p-4 mb-4",style:{background:"linear-gradient(135deg, #727cf5 0%, #5b69bc 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"page-title text-white mb-1",children:[e.jsx("i",{className:"mdi mdi-chart-line me-2"}),"Métricas de Propiedades"]}),e.jsx("p",{className:"text-white mb-0",style:{opacity:"0.8"},children:"Análisis detallado del rendimiento de las propiedades en la plataforma"})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("div",{className:"text-white font-size-12",style:{opacity:"0.7"},children:"Último período"}),e.jsxs("div",{className:"text-white font-weight-bold",children:[c==="7"&&"Últimos 7 días",c==="30"&&"Últimos 30 días",c==="90"&&"Últimos 3 meses",c==="365"&&"Último año"]})]})]})})})}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-lg-4",children:e.jsx("div",{className:"card border-0 shadow-sm",children:e.jsxs("div",{className:"card-body py-3",children:[e.jsxs("label",{htmlFor:"period",className:"form-label text-muted font-size-12 mb-2",children:[e.jsx("i",{className:"mdi mdi-calendar-range me-1"}),"PERÍODO DE ANÁLISIS"]}),e.jsxs("select",{id:"period",value:c,onChange:s=>b(s.target.value),className:"form-select border-0 bg-light",children:[e.jsx("option",{value:"7",children:"📅 Últimos 7 días"}),e.jsx("option",{value:"30",children:"📊 Últimos 30 días"}),e.jsx("option",{value:"90",children:"📈 Últimos 3 meses"}),e.jsx("option",{value:"365",children:"📋 Último año"})]})]})})}),e.jsx("div",{className:"col-lg-8",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsxs("div",{className:"card-body py-3 d-flex align-items-center",children:[e.jsx("div",{className:"avatar-sm bg-light rounded me-3",children:e.jsx("i",{className:"mdi mdi-information-outline text-primary h5 mb-0"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1 text-dark",children:"Información del Dashboard"}),e.jsx("p",{className:"text-muted mb-0 font-size-12",children:"Los datos se actualizan en tiempo real. Selecciona diferentes períodos para obtener insights detallados."})]})]})})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card border-0 shadow-sm",children:e.jsx("div",{className:"card-header bg-white border-bottom-0 py-3",children:e.jsxs("ul",{className:"nav nav-pills nav-justified",role:"tablist",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("button",{className:`nav-link ${j==="overview"?"active":""} d-flex align-items-center justify-content-center`,onClick:()=>N("overview"),style:{border:"none",padding:"12px 20px"},children:[e.jsx("i",{className:"mdi mdi-view-dashboard me-2"}),"Resumen General"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("button",{className:`nav-link ${j==="properties"?"active":""} d-flex align-items-center justify-content-center`,onClick:()=>N("properties"),style:{border:"none",padding:"12px 20px"},children:[e.jsx("i",{className:"mdi mdi-home-city me-2"}),"Top Propiedades"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("button",{className:`nav-link ${j==="users"?"active":""} d-flex align-items-center justify-content-center`,onClick:()=>N("users"),style:{border:"none",padding:"12px 20px"},children:[e.jsx("i",{className:"mdi mdi-account-group me-2"}),"Top Usuarios"]})})]})})})})}),e.jsxs("div",{className:"mt-4",children:[j==="overview"&&e.jsxs("div",{children:[e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-xl-3 col-md-6",children:e.jsx(p,{title:"Total Visualizaciones",value:a.property_view||0,icon:"mdi mdi-eye-outline",color:"primary",subtitle:"Vistas de propiedades",trend:{type:"success",value:"12.5"}})}),e.jsx("div",{className:"col-xl-3 col-md-6",children:e.jsx(p,{title:"Clicks a Airbnb",value:a.airbnb_click||0,icon:"mdi mdi-open-in-new",color:"danger",subtitle:"Redirecciones externas",trend:{type:"success",value:"8.2"}})}),e.jsx("div",{className:"col-xl-3 col-md-6",children:e.jsx(p,{title:"Galería Visualizada",value:a.gallery_view||0,icon:"mdi mdi-image-multiple",color:"success",subtitle:"Imágenes vistas",trend:{type:"success",value:"7.3"}})}),e.jsx("div",{className:"col-xl-3 col-md-6",children:e.jsx(p,{title:"Total Interacciones",value:(a.property_view||0)+(a.airbnb_click||0)+(a.gallery_view||0),icon:"mdi mdi-chart-line",color:"info",subtitle:"Actividad total",trend:{type:"success",value:"15.7"}})})]}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header bg-white border-bottom",children:e.jsxs("h5",{className:"card-title mb-0",children:[e.jsx("i",{className:"mdi mdi-trending-up text-success me-2"}),"Análisis de Conversión y Tendencias"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row text-center mb-4",children:[e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"border-end",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[e.jsx("div",{className:"avatar-md bg-danger bg-gradient rounded-circle me-3 d-flex align-items-center justify-content-center",style:{width:"50px",height:"50px"},children:e.jsx("i",{className:"mdi mdi-open-in-new text-white",style:{fontSize:"20px"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-muted mb-1",children:"Vista → Airbnb"}),e.jsxs("h2",{className:"text-danger mb-0",children:[a.property_view>0?((a.airbnb_click||0)/a.property_view*100).toFixed(1):"0.0","%"]})]})]}),e.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:e.jsx("div",{className:"progress-bar bg-danger",style:{width:`${a.property_view>0?(a.airbnb_click||0)/a.property_view*100:0}%`}})}),e.jsxs("p",{className:"text-muted font-size-12 mb-0",children:["De ",r(a.property_view||0)," vistas,",r(a.airbnb_click||0)," fueron a Airbnb"]})]})}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[e.jsx("div",{className:"avatar-md bg-success bg-gradient rounded-circle me-3 d-flex align-items-center justify-content-center",style:{width:"50px",height:"50px"},children:e.jsx("i",{className:"mdi mdi-image-multiple text-white",style:{fontSize:"20px"}})}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-muted mb-1",children:"Vista → Galería"}),e.jsxs("h2",{className:"text-success mb-0",children:[a.property_view>0?((a.gallery_view||0)/a.property_view*100).toFixed(1):"0.0","%"]})]})]}),e.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:e.jsx("div",{className:"progress-bar bg-success",style:{width:`${a.property_view>0?(a.gallery_view||0)/a.property_view*100:0}%`}})}),e.jsxs("p",{className:"text-muted font-size-12 mb-0",children:["De ",r(a.property_view||0)," vistas,",r(a.gallery_view||0)," vieron galería completa"]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h6",{className:"mb-3",children:[e.jsx("i",{className:"mdi mdi-chart-bar text-primary me-2"}),"Distribución de Interacciones"]}),e.jsx("div",{className:"position-relative",style:{height:"250px"},children:e.jsx("canvas",{ref:g,id:"metricsBarChart"})})]})]})]})}),e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header bg-white border-bottom",children:e.jsxs("h5",{className:"card-title mb-0",children:[e.jsx("i",{className:"mdi mdi-chart-donut text-info me-2"}),"Resumen de Actividad"]})}),e.jsxs("div",{className:"card-body text-center",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"avatar-lg bg-light rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center",style:{width:"80px",height:"80px"},children:e.jsx("i",{className:"mdi mdi-chart-pie text-primary",style:{fontSize:"32px"}})}),e.jsx("h4",{className:"text-primary mb-1",children:r((a.airbnb_click||0)+(a.gallery_view||0))}),e.jsx("p",{className:"text-muted mb-0",children:"Total de Conversiones"})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"position-relative",style:{height:"200px"},children:e.jsx("canvas",{ref:v,id:"metricsPieChart"})})}),e.jsxs("div",{className:"row text-center",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"py-2",children:[e.jsx("p",{className:"text-muted mb-1 font-size-12",children:"Engagement"}),e.jsx("h5",{className:"text-dark mb-0",children:a.property_view>0?"Alto":"Bajo"})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"py-2",children:[e.jsx("p",{className:"text-muted mb-1 font-size-12",children:"Rendimiento"}),e.jsx("h5",{className:"text-dark mb-0",children:(a.airbnb_click||0)>10?"🔥":(a.airbnb_click||0)>5?"⚡":"📊"})]})})]})]})]})})]}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header bg-white border-bottom",children:e.jsxs("h5",{className:"card-title mb-0",children:[e.jsx("i",{className:"mdi mdi-chart-timeline-variant text-info me-2"}),"Tendencias de Actividad"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-8",children:e.jsx("p",{className:"text-muted mb-0",children:"Análisis de la actividad de usuarios en el período seleccionado"})}),e.jsx("div",{className:"col-md-4 text-end",children:e.jsxs("div",{className:"btn-group btn-group-sm",children:[e.jsx("button",{className:`btn ${c==="7"?"btn-primary":"btn-outline-primary"}`,onClick:()=>b("7"),children:"7d"}),e.jsx("button",{className:`btn ${c==="30"?"btn-primary":"btn-outline-primary"}`,onClick:()=>b("30"),children:"30d"}),e.jsx("button",{className:`btn ${c==="90"?"btn-primary":"btn-outline-primary"}`,onClick:()=>b("90"),children:"90d"})]})})]}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"text-center p-3 bg-light rounded",children:[e.jsx("h4",{className:"text-primary mb-1",children:r(a.property_view||0)}),e.jsx("p",{className:"text-muted mb-0 font-size-12",children:"Total Vistas"})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"text-center p-3 bg-light rounded",children:[e.jsx("h4",{className:"text-danger mb-1",children:r(a.airbnb_click||0)}),e.jsx("p",{className:"text-muted mb-0 font-size-12",children:"Clicks Airbnb"})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"text-center p-3 bg-light rounded",children:[e.jsx("h4",{className:"text-success mb-1",children:r(a.gallery_view||0)}),e.jsx("p",{className:"text-muted mb-0 font-size-12",children:"Galería Vista"})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"text-center p-3 bg-light rounded",children:[e.jsxs("h4",{className:"text-info mb-1",children:[a.property_view>0?(((a.airbnb_click||0)+(a.gallery_view||0))/a.property_view*100).toFixed(1):"0.0","%"]}),e.jsx("p",{className:"text-muted mb-0 font-size-12",children:"CTR Global"})]})})]})]})]})})})]}),j==="properties"&&e.jsx("div",{children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsxs("div",{className:"card-header text-white",style:{background:"linear-gradient(135deg, #727cf5 0%, #5b69bc 100%)"},children:[e.jsxs("h5",{className:"card-title mb-0 text-white",children:[e.jsx("i",{className:"mdi mdi-trophy me-2"}),"🏆 Propiedades Más Populares"]}),e.jsx("p",{className:"text-white mb-0 font-size-12",style:{opacity:"0.8"},children:"Ranking de propiedades por número de visualizaciones en el período seleccionado"})]}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Ranking"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Propiedad"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Usuario"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Visualizaciones"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Acciones"})]})}),e.jsx("tbody",{children:y.length>0?y.map((s,i)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:`avatar-xs rounded-circle d-flex align-items-center justify-content-center me-2 ${i===0?"bg-warning":i===1?"bg-secondary":i===2?"bg-danger":"bg-light"}`,children:e.jsx("span",{className:`font-size-12 font-weight-bold ${i<3?"text-white":"text-dark"}`,children:i+1})}),i===0&&e.jsx("i",{className:"mdi mdi-crown text-warning"})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1 font-size-14",children:e.jsx("strong",{children:s.title||"Sin título"})}),e.jsxs("p",{className:"text-muted mb-1 font-size-12",children:["📍 ",s.district||"N/A",", ",s.city||"N/A"]}),e.jsxs("p",{className:"text-muted mb-0 font-size-11",children:[e.jsxs("code",{className:"text-muted",children:["/",s.slug||"sin-slug"]}),s.price_per_night&&e.jsxs("span",{className:"ms-2 badge badge-soft-info",children:[s.currency||"$",s.price_per_night,"/noche"]})]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"avatar-xs bg-light rounded-circle me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"mdi mdi-account text-muted",style:{fontSize:"14px"}})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-size-13 fw-bold",children:s.user_name||`Usuario #${s.user_id}`}),s.user_email&&e.jsx("div",{className:"text-muted font-size-11",children:s.user_email})]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"me-2",children:e.jsxs("span",{className:"badge badge-soft-success font-size-12",children:[e.jsx("i",{className:"mdi mdi-eye me-1"}),r(s.views_count||0)]})}),e.jsx("div",{className:"progress flex-grow-1",style:{height:"6px",maxWidth:"80px"},children:e.jsx("div",{className:"progress-bar bg-success",style:{width:`${Math.min((s.views_count||0)/Math.max(...y.map(t=>t.views_count||1))*100,100)}%`}})})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("a",{href:`/property/${s.slug}`,target:"_blank",className:"btn btn-sm btn-outline-primary",children:[e.jsx("i",{className:"mdi mdi-open-in-new me-1"}),"Ver Propiedad"]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-5",children:e.jsxs("div",{className:"text-muted",children:[e.jsx("i",{className:"mdi mdi-home-outline h1 text-muted"}),e.jsx("h5",{className:"mt-3",children:"No hay datos disponibles"}),e.jsx("p",{children:"No se encontraron propiedades con visualizaciones en este período."})]})})})})]})})})]})}),j==="users"&&e.jsx("div",{children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsxs("div",{className:"card-header text-white",style:{background:"linear-gradient(135deg, #0acf97 0%, #038969 100%)"},children:[e.jsxs("h5",{className:"card-title mb-0 text-white",children:[e.jsx("i",{className:"mdi mdi-account-star me-2"}),"👥 Usuarios Más Activos"]}),e.jsx("p",{className:"text-white mb-0 font-size-12",style:{opacity:"0.8"},children:"Ranking de usuarios por mayor actividad e interacciones en sus propiedades"})]}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Ranking"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Usuario"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Email"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Propiedades"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Interacciones"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Estado"}),e.jsx("th",{className:"border-0 font-size-12 text-muted text-uppercase",children:"Acciones"})]})}),e.jsx("tbody",{children:w.length>0?w.map((s,i)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:`avatar-sm rounded d-flex align-items-center justify-content-center me-2 ${i===0?"bg-gradient-warning":i===1?"bg-gradient-info":i===2?"bg-gradient-danger":"bg-light"}`,children:e.jsxs("span",{className:`font-size-14 font-weight-bold ${i<3?"text-white":"text-dark"}`,children:["#",i+1]})}),i===0&&e.jsx("i",{className:"mdi mdi-medal text-warning"})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"avatar-sm bg-primary bg-gradient rounded-circle me-3 d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:e.jsx("span",{className:"text-white font-size-16 font-weight-bold",children:s.name?s.name.charAt(0).toUpperCase():"U"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1 font-size-14 fw-bold",children:s.name||"Usuario sin nombre"}),e.jsxs("p",{className:"text-muted mb-0 font-size-12",children:["ID: ",s.id,s.created_at&&e.jsxs("span",{className:"ms-2",children:["• Desde ",new Date(s.created_at).getFullYear()]})]})]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-size-13",children:s.email||"No disponible"}),s.email_verified_at&&e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:"badge badge-soft-success font-size-10",children:[e.jsx("i",{className:"mdi mdi-check-circle me-1"}),"Verificado"]})})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-1",children:e.jsxs("span",{className:"badge badge-soft-info font-size-14",children:[e.jsx("i",{className:"mdi mdi-home-city me-1"}),s.properties_count||0]})}),e.jsx("small",{className:"text-muted font-size-11",children:s.properties_count>1?"propiedades":"propiedad"})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("span",{className:"badge badge-soft-primary font-size-12 me-2",children:[e.jsx("i",{className:"mdi mdi-trending-up me-1"}),r(s.total_interactions||0)]}),e.jsx("div",{className:"progress flex-grow-1",style:{height:"6px",maxWidth:"60px"},children:e.jsx("div",{className:"progress-bar bg-primary",style:{width:`${Math.min((s.total_interactions||0)/Math.max(...w.map(t=>t.total_interactions||1))*100,100)}%`}})})]})}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`badge badge-soft-${(s.total_interactions||0)>50?"success":(s.total_interactions||0)>20?"warning":"secondary"}`,children:(s.total_interactions||0)>50?"🔥 Muy Activo":(s.total_interactions||0)>20?"⚡ Activo":"😴 Moderado"})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"btn-group",children:[e.jsx("button",{className:"btn btn-sm btn-outline-info",title:"Ver propiedades",onClick:()=>E(s),children:e.jsx("i",{className:"mdi mdi-home-city"})}),e.jsx("button",{className:"btn btn-sm btn-outline-primary",title:"Ver perfil",children:e.jsx("i",{className:"mdi mdi-account-details"})})]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-5",children:e.jsxs("div",{className:"text-muted",children:[e.jsx("i",{className:"mdi mdi-account-group-outline h1 text-muted"}),e.jsx("h5",{className:"mt-3",children:"No hay datos de usuarios"}),e.jsx("p",{children:"No se encontraron usuarios con actividad en este período."})]})})})})]})})})]})})]}),D&&x&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0,0,0,0.5)"},onClick:f,children:e.jsx("div",{className:"modal-dialog modal-xl",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",style:{background:"linear-gradient(135deg, #727cf5 0%, #5b69bc 100%)"},children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"avatar-md bg-white bg-gradient rounded-circle me-3 d-flex align-items-center justify-content-center",children:e.jsx("span",{className:"text-primary font-size-18 font-weight-bold",children:x.name?x.name.charAt(0).toUpperCase():"U"})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"modal-title text-white mb-1",children:[e.jsx("i",{className:"mdi mdi-home-city me-2"}),"Propiedades de ",x.name||"Usuario"]}),e.jsxs("p",{className:"text-white mb-0",style:{opacity:"0.8",fontSize:"14px"},children:[x.properties_count," propiedades • ",r(x.total_interactions)," interacciones totales"]})]})]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:f})]}),e.jsx("div",{className:"modal-body p-0",children:x.properties_details&&x.properties_details.length>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-0",children:"#"}),e.jsx("th",{className:"border-0",children:"Propiedad"}),e.jsx("th",{className:"border-0 text-center",children:"Vistas"}),e.jsx("th",{className:"border-0 text-center",children:"Clicks Airbnb"}),e.jsx("th",{className:"border-0 text-center",children:"Galería"}),e.jsx("th",{className:"border-0 text-center",children:"Total"}),e.jsx("th",{className:"border-0 text-center",children:"Conversión"}),e.jsx("th",{className:"border-0",children:"Acciones"})]})}),e.jsx("tbody",{children:x.properties_details.map((s,i)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"d-flex align-items-center",children:e.jsx("div",{className:`avatar-xs rounded-circle d-flex align-items-center justify-content-center me-2 ${i===0?"bg-warning":i===1?"bg-info":i===2?"bg-success":"bg-light"}`,children:e.jsx("span",{className:`font-size-11 font-weight-bold ${i<3?"text-white":"text-dark"}`,children:i+1})})})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1 font-size-14",children:e.jsx("strong",{children:s.title||"Sin título"})}),e.jsxs("p",{className:"text-muted mb-1 font-size-12",children:["📍 ",s.district||"N/A",", ",s.city||"N/A"]}),e.jsx("p",{className:"text-muted mb-0 font-size-11",children:e.jsxs("code",{className:"text-muted",children:["/",s.slug||"sin-slug"]})})]})}),e.jsx("td",{className:"py-3 text-center",children:e.jsxs("span",{className:"badge badge-soft-primary",children:[e.jsx("i",{className:"mdi mdi-eye me-1"}),s.views]})}),e.jsx("td",{className:"py-3 text-center",children:e.jsxs("span",{className:"badge badge-soft-danger",children:[e.jsx("i",{className:"mdi mdi-open-in-new me-1"}),s.airbnb_clicks]})}),e.jsx("td",{className:"py-3 text-center",children:e.jsxs("span",{className:"badge badge-soft-success",children:[e.jsx("i",{className:"mdi mdi-image-multiple me-1"}),s.gallery_views]})}),e.jsx("td",{className:"py-3 text-center",children:e.jsxs("span",{className:"badge badge-soft-info font-size-12",children:[e.jsx("i",{className:"mdi mdi-chart-line me-1"}),e.jsx("strong",{children:s.total_interactions})]})}),e.jsx("td",{className:"py-3 text-center",children:e.jsx("span",{className:`badge badge-soft-${s.views>0&&(s.airbnb_clicks+s.gallery_views)/s.views>.1?"success":s.views>0&&(s.airbnb_clicks+s.gallery_views)/s.views>.05?"warning":"secondary"}`,children:s.views>0?`${((s.airbnb_clicks+s.gallery_views)/s.views*100).toFixed(1)}%`:"0.0%"})}),e.jsx("td",{className:"py-3",children:e.jsxs("a",{href:`/property/${s.slug}`,target:"_blank",className:"btn btn-sm btn-outline-primary",children:[e.jsx("i",{className:"mdi mdi-open-in-new me-1"}),"Ver"]})})]},s.id))})]})}):e.jsx("div",{className:"text-center py-5",children:e.jsxs("div",{className:"text-muted",children:[e.jsx("i",{className:"mdi mdi-home-outline h1 text-muted"}),e.jsx("h5",{className:"mt-3",children:"No hay propiedades con actividad"}),e.jsx("p",{children:"Este usuario no tiene propiedades con interacciones en el período seleccionado."})]})})}),e.jsx("div",{className:"modal-footer bg-light",children:e.jsxs("div",{className:"w-100 d-flex justify-content-between align-items-center",children:[e.jsx("div",{children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"mdi mdi-information-outline me-1"}),"Datos del período: ",c==="7"&&"Últimos 7 días",c==="30"&&"Últimos 30 días",c==="90"&&"Últimos 3 meses",c==="365"&&"Último año"]})}),e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:f,children:[e.jsx("i",{className:"mdi mdi-close me-1"}),"Cerrar"]})]})})]})})})]})};I((k,l)=>{T(k).render(e.jsx(V,{...l,title:"Métricas de Propiedades",children:e.jsx(F,{...l})}))});
