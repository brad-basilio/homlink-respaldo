var T=Object.defineProperty;var b=(t,a,s)=>a in t?T(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;var v=(t,a,s)=>(b(t,typeof a!="symbol"?a+"":a,s),s);import{j as e}from"./RequirementCard-DEdD30eg.js";import{r as n}from"./index-RYns6xqu.js";import{c as F}from"./ReactAppend-vpV7VTGG.js";import{B as N}from"./Base-elrL0iSu.js";import{C as S}from"./CreateReactScript-BuKYEKxn.js";import{T as E}from"./Table-CyG7yWBs.js";import{M as k}from"./Modal-1_SBF_XS.js";import{R as C}from"./ReactAppend-DPXaoPQG.js";import"./sweetalert2.all-DJo0UVK6.js";import{I as y}from"./InputFormGroup-B7mKwzkx.js";import{m as j}from"./main-Y8JAyXgE.js";import{B}from"./Results-BBVbNL2k.js";import{r as R}from"./DxBox-DZgBbgD6.js";import"./index-CXU7o9CY.js";import"./tippy-react.esm-DYFqe69e.js";/* empty css              */import"./Logout-BlWggqgx.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./useTranslation-CZbMeh78.js";import"./Filter-CpekYgBC.js";/* empty css               */class O extends B{constructor(){super(...arguments);v(this,"path","admin/translations");v(this,"translate",async({group:s,key:d,value:p,lang_id:c})=>{try{const{status:o,result:l}=await j.Fetch(`/api/${this.path}/translate`,{method:"POST",body:JSON.stringify({group:s,key:d,value:p,lang_id:c})});if(!o)throw new Error((l==null?void 0:l.message)||"Error al guardar traducción");return j.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:"Traducción guardada exitosamente",type:"success"}),l}catch(o){return j.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:o.message,type:"danger"}),null}})}}const f=new O,_=({data:t,gridRef:a,isTranslationMode:s,current_lang_id:d,default_lang_id:p})=>{const[c,o]=n.useState(t.value||t.value_base),[l,m]=n.useState(!1),g=n.useRef(null),x=t.value!==null&&t.value!==t.value_base,h=async()=>{try{const u={group:t.group,key:t.key,value:c};s?await f.translate(u):await f.save({...u,id:t.id}),$(a.current).dxDataGrid("instance").refresh(),m(!1)}catch{Notify.error("Error al guardar traducción")}};return e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[!l&&e.jsx("span",{className:"text-nowrap",children:x?e.jsx("i",{className:"fas fa-check text-success"}):e.jsx("i",{className:"fas fa-times text-danger"})}),e.jsx("input",{ref:g,className:"form-control flex-grow-1",value:c,onChange:u=>{o(u.target.value),m(!0)},onFocus:()=>m(!0),onBlur:()=>setTimeout(()=>m(!1),200)}),l&&e.jsx("button",{className:"btn btn-xs btn-soft-primary",onClick:h,children:s?e.jsx("i",{className:"fa fa-language"}):e.jsx("i",{className:"fa fa-pen"})})]})},I=({current_lang_id:t,default_lang_id:a})=>{const s=n.useRef(),d=n.useRef(),p=n.useRef(),c=n.useRef(),o=n.useRef(),l=n.useRef(),[m,g]=n.useState(!1),x=r=>{g(!1),p.current.value="",c.current.value="",o.current.value="",l.current.value="",$(d.current).modal("show")},h=async r=>{r.preventDefault();const i={id:p.current.value||void 0,group:c.current.value,key:o.current.value,value:l.current.value};await f.save(i)&&($(s.current).dxDataGrid("instance").refresh(),$(d.current).modal("hide"))},u=t!==a;return e.jsxs(e.Fragment,{children:[e.jsx(E,{gridRef:s,title:"Traducciones",rest:f,remoteOperations:{paging:!0,filtering:!0,sorting:!0},toolBar:r=>{r.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar",onClick:()=>x()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"group",caption:"Grupo",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(r,{data:i})=>{r.html(R(e.jsx(e.Fragment,{children:i.group})))}},{dataField:"key",caption:"Clave",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(r,{data:i})=>{r.html(R(e.jsx(e.Fragment,{children:i.key})))}},{dataField:"value_base",caption:"Valor Español",width:"200px",allowFiltering:!0,filterOperations:["contains"],filterType:"text"},{dataField:"is_translated",caption:"Estado",width:"80px",allowFiltering:!1,filterType:"text",cellTemplate:(r,{data:i})=>{const w=i.value&&i.value!==i.value_base;r.html(R(e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:w?e.jsx("i",{className:"fas fa-check-circle text-success",title:"Traducido"}):e.jsx("i",{className:"fas fa-times-circle text-danger",title:"Sin traducir"})})))},calculateFilterExpression:(r,i)=>r==="traducido"?["is_translated","=",!0]:r==="no traducido"?["is_translated","=",!1]:null},{dataField:"value",caption:u?"Traducción":"Valor",allowFiltering:!1,cellTemplate:(r,{data:i})=>{C(r,e.jsx(_,{data:i,gridRef:s,isTranslationMode:u,current_lang_id:t,default_lang_id:a}))}}],options:{searchPanel:{visible:!0,width:240,placeholder:"Buscar...",highlightSearchText:!0},filterRow:{visible:!0,applyFilter:"auto"},paging:{pageSize:10},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,25,50,100],showInfo:!0}}}),e.jsx(k,{modalRef:d,title:m?"Editar traducción":"Agregar traducción",onSubmit:h,size:"md",children:e.jsxs("div",{className:"row",id:"translations-container",children:[e.jsx("input",{ref:p,type:"hidden"}),e.jsx(y,{eRef:c,label:"Grupo",col:"col-12",required:!0}),e.jsx(y,{eRef:o,label:"Clave",col:"col-6",required:!0}),e.jsx(y,{eRef:l,label:"Valor",col:"col-6",required:!0})]})})]})};S((t,a)=>{F(t).render(e.jsx(N,{...a,title:"Traducciones",children:e.jsx(I,{...a})}))});
