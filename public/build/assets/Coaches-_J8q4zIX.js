var k=Object.defineProperty;var F=(s,t,a)=>t in s?k(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var v=(s,t,a)=>(F(s,typeof t!="symbol"?t+"":t,a),a);import{j as e}from"./Header-Bdo2C3ON.js";import{r as n}from"./index-DFv2mRv-.js";import{c as T}from"./ReactAppend-CwiwA4iz.js";import{M as A}from"./Modal-D3n50gBR.js";import{T as D}from"./Table-ZdPrSeGN.js";import{I as R}from"./InputFormGroup-Bk6JtmAE.js";import{m as N}from"./main-BBbUrZUL.js";import{C as I,G}from"./CreateReactScript-yWJ4gJYl.js";import{B}from"./Base-BRVZCu1m.js";import{J as q}from"./JSEncrypt-D3I3x59l.js";import{B as P}from"./Content-C1YkWUKj.js";import{D as O}from"./DxBox-CPd-rV7e.js";import{R as C}from"./ReactAppend-CaRiPI_F.js";import{D as w}from"./DxButton-CsjWvhyj.js";import"./index-DgyC5pTR.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./index.esm-B502ZfUP.js";/* empty css               *//* empty css              */import"./tippy-react.esm-BVvHiWwH.js";import"./DxBox-PA__dqjs.js";const J=({col:s,label:t,eRef:a,required:m=!1,dropdownParent:u,searchAPI:p,searchBy:l,multiple:d=!1,filter:i=null,onChange:f=()=>{},templateResult:x,templateSelection:y})=>(a||(a=n.useRef()),n.useEffect(()=>{$(a.current).select2({dropdownParent:u,minimumInputLength:0,ajax:{url:p,headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(N.Cookies.get("XSRF-TOKEN"))},type:"POST",quietMillis:50,data:function({term:c,page:h}){return N.JSON.stringify({sort:[{selector:l,desc:!1}],skip:((h??1)-1)*10,take:10,filter:i?[[l,"contains",c||""],"and",i]:[l,"contains",c||""]})},processResults:function(c,{page:h}){return{results:((c==null?void 0:c.data)??[]).map(b=>{const r=N.JSON.flatten(b);return{id:b.id,text:r[l],data:b}}),pagination:{more:(h??1)*10<c.totalCount}}}},templateResult:x,templateSelection:y})},[u,i]),n.useEffect(()=>{$(a.current).on("change",f)},[i]),e.jsxs("div",{className:`form-group ${s} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[t," ",m&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("select",{ref:a,required:m,className:"form-control",style:{width:"100%"},multiple:d})]})),E=({col:s,label:t,eRef:a,placeholder:m,required:u=!1,value:p})=>{a||(a=n.useRef());const[l,d]=n.useState("password"),i=()=>{l=="text"?d("password"):d("text")};return e.jsxs("div",{className:`form-group ${s} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[t," ",u&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"input-group input-group-merge",children:[e.jsx("input",{ref:a,type:l,className:"form-control",placeholder:m,required:u,defaultValue:p??""}),e.jsx("div",{className:"input-group-text","data-password":"true",onClick:i,children:e.jsx("i",{className:l=="text"?"mdi mdi-eye-off-outline":"mdi mdi-eye-outline"})})]})]})};class M extends P{constructor(){super(...arguments);v(this,"path","admin/coaches")}}const g=new M,K=({})=>{const s=n.useRef(),t=n.useRef(),a=n.useRef(),m=n.useRef(),u=n.useRef(),p=n.useRef(),l=n.useRef(),d=n.useRef(),i=n.useRef(),f=new q;f.setPublicKey(G.PUBLIC_RSA_KEY);const[x,y]=n.useState(!1),c=async r=>{r.preventDefault();const o=d.current.value,j=i.current.value,S={id:a.current.value||void 0,name:m.current.value,lastname:u.current.value,email:p.current.value,roles:$(l.current).val(),password:o?f.encrypt(o):void 0,confirm:j?f.encrypt(j):void 0};await g.save(S)&&($(s.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},h=async({id:r,status:o})=>{await g.status({id:r,status:o})&&$(s.current).dxDataGrid("instance").refresh()},b=async r=>{await g.delete(r)&&$(s.current).dxDataGrid("instance").refresh()};return e.jsxs(e.Fragment,{children:[e.jsx(D,{gridRef:s,title:"Coaches",rest:g,toolBar:r=>{r.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(s.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Nombres"},{dataField:"lastname",caption:"Apellidos"},{dataField:"email",caption:"Correo",dataType:"email",cellTemplate:(r,{data:o})=>{r.append(O([e.jsx("img",{className:"avatar-xs rounded-circle",src:`/api/profile/thumbnail/${o.uuid}`,alt:o.name}),e.jsx("p",{className:"mb-0",style:{fontSize:"14px"},children:o.email})],!1))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(r,{data:o})=>{switch(o.status){case 1:C(r,e.jsx("span",{className:"badge bg-success rounded-pill",children:"Activo"}));break;case 0:C(r,e.jsx("span",{className:"badge bg-danger rounded-pill",children:"Inactivo"}));break;default:C(r,e.jsx("span",{className:"badge bg-dark rounded-pill",children:"Eliminado"}));break}}},{caption:"Acciones",cellTemplate:(r,{data:o})=>{r.append(w({className:"btn btn-xs btn-light",title:o.status===null?"Restaurar":"Cambiar estado",icon:o.status===1?"fa fa-toggle-on text-success":o.status===0?"fa fa-toggle-off text-danger":"fas fa-trash-restore",onClick:()=>h(o)})),r.append(w({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash-alt",onClick:()=>b(o.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(A,{modalRef:t,title:x?"Editar usuario":"Agregar usuario",onSubmit:c,children:e.jsxs("div",{className:"row",id:"users-crud-container",children:[e.jsx("input",{ref:a,type:"hidden"}),e.jsx(R,{eRef:m,label:"Nombres",col:"col-md-6",required:!0}),e.jsx(R,{eRef:u,label:"Apellidos",col:"col-md-6",required:!0}),e.jsx(R,{eRef:p,label:"Correo",col:"col-12",type:"email",required:!0}),e.jsx(J,{eRef:l,label:"Asignar roles",col:"col-12",dropdownParent:"#users-crud-container",searchAPI:"/api/roles/paginate",searchBy:"name",required:!0,multiple:!0}),e.jsx(E,{eRef:d,label:"Contraseña",col:"col-md-6",required:!x}),e.jsx(E,{eRef:i,label:"Repetir contraseña",col:"col-md-6",required:!x})]})})]})};I((s,t)=>{T(s).render(e.jsx(B,{...t,title:"Coaches",children:e.jsx(K,{...t})}))});
