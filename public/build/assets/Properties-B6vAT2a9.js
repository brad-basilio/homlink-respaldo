var We=Object.defineProperty;var Xe=(l,d,f)=>d in l?We(l,d,{enumerable:!0,configurable:!0,writable:!0,value:f}):l[d]=f;var ue=(l,d,f)=>(Xe(l,typeof d!="symbol"?d+"":d,f),f);import{j as e}from"./RequirementCard-DEdD30eg.js";import{r as i}from"./index-RYns6xqu.js";import{c as Ye}from"./ReactAppend-vpV7VTGG.js";import{B as Ze}from"./Base-DmQtm8t4.js";import{T as ea}from"./Table-BTG--uQT.js";import{M as aa}from"./Modal-IE2ysmSM.js";import{I as g}from"./InputFormGroup-B7mKwzkx.js";import{I as ra}from"./ImageFormGroup-Csvj9Cte.js";import{S as le}from"./SelectFormGroup-CVn9r_7Q.js";import{C as sa}from"./CreateReactScript-BuKYEKxn.js";import{R as y}from"./ReactAppend-DPXaoPQG.js";import{B as ta}from"./Results-BBVbNL2k.js";import{S as x}from"./sweetalert2.all-DJo0UVK6.js";import{r as ia}from"./DxBox-DZgBbgD6.js";import"./index-CXU7o9CY.js";import"./tippy-react.esm-DYFqe69e.js";/* empty css              */import"./Logout-BlWggqgx.js";import"./main-Y8JAyXgE.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./useTranslation-CZbMeh78.js";import"./Filter-CpekYgBC.js";/* empty css               */class na extends ta{constructor(){super(...arguments);ue(this,"path","admin/properties");ue(this,"hasFiles",!0)}async getPublicProperties(f={}){try{const v=new URLSearchParams(f).toString();return await(await fetch(`/api/properties/public?${v}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}})).json()}catch(v){throw console.error("Error fetching public properties:",v),v}}}const re=new na,oe=({feature:l,index:d,onUpdate:f,onRemove:v,type:m,canRemove:T,amenities:_,services:k,characteristics:w,houseRules:u,addAmenity:b,addService:F,addCharacteristic:B,addHouseRule:I,propertyIcons:O})=>{const j=(o,N)=>{f(d,o,N)},q=()=>{switch(m){case"amenity":return"fas fa-wifi";case"service":return"fas fa-concierge-bell";case"characteristic":return"fas fa-home";case"houseRule":return"fas fa-gavel";default:return"fas fa-star"}},C=()=>{switch(m){case"amenity":return"Amenidad";case"service":return"Servicio";case"characteristic":return"Característica";case"houseRule":return"Regla";default:return"Elemento"}},G=()=>{switch(m){case"amenity":return _;case"service":return k;case"characteristic":return w;case"houseRule":return u;default:return[]}},U=()=>{switch(m){case"amenity":return b;case"service":return F;case"characteristic":return B;case"houseRule":return I;default:return()=>{}}},M=()=>O.filter(o=>o.category===m),D=o=>{if(o.id)return $(ia(e.jsxs("span",{children:[e.jsx("i",{className:`${o.id} me-2`}),o.text]})))};return e.jsxs("div",{className:"card border shadow-sm h-100",children:[e.jsx("div",{className:"card-header bg-transparent border-bottom-0 pb-0",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("h6",{className:"card-title mb-0",children:[e.jsx("i",{className:q()+" me-2"}),C()," ",d+1]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger rounded-circle d-flex align-items-center justify-content-center",onClick:()=>v(d),disabled:!T,title:"Eliminar",style:{width:"30px",height:"30px"},children:e.jsx("i",{className:"fas fa-times"})})]})}),e.jsxs("div",{className:"card-body pt-2",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6 mb-3",children:e.jsx(g,{label:"Nombre",value:l.name||"",onChange:o=>j("name",o.target.value),placeholder:"Ingresa el nombre..."})}),e.jsx("div",{className:"col-lg-6 mb-3",children:e.jsxs(le,{label:"Icono",value:l.icon||"",onChange:o=>j("icon",o.target.value),templateResult:D,templateSelection:D,dropdownParent:"#principal-container",children:[e.jsx("option",{value:"",children:"Seleccionar icono..."}),M().map((o,N)=>e.jsx("option",{value:o.id,children:o.name},N))]})})]}),(m==="service"||m==="characteristic")&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:m==="characteristic"?"Valor":"Descripción"}),e.jsx("textarea",{className:"form-control",rows:2,value:m==="characteristic"?l.value||"":l.description||"",onChange:o=>j(m==="characteristic"?"value":"description",o.target.value),placeholder:m==="characteristic"?"Valor de la característica...":"Describe el servicio..."})]}),m==="houseRule"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Texto de la regla"}),e.jsx("textarea",{className:"form-control",rows:2,value:l.text||"",onChange:o=>j("text",o.target.value),placeholder:"Texto de la regla..."})]}),m==="amenity"&&e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:l.available||!1,onChange:o=>j("available",o.target.checked),id:`amenity-${d}`}),e.jsx("label",{className:"form-check-label",htmlFor:`amenity-${d}`,children:"Disponible"})]})]}),e.jsx("div",{className:"card-footer bg-transparent border-top-0 pt-0",id:`feature-${m}-${d}`,children:d===G().length-1&&e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary w-100",onClick:U(),children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Agregar ",C()]})})]})},ca=()=>{const l=i.useRef(),d=i.useRef(),f=i.useRef(),v=i.useRef(),m=i.useRef(),T=i.useRef(),_=i.useRef(),k=i.useRef(),w=i.useRef(),u=i.useRef(),b=i.useRef(),F=i.useRef(),B=i.useRef(),I=i.useRef(),O=i.useRef(),j=i.useRef(),q=i.useRef(),C=i.useRef(),G=i.useRef(),U=i.useRef(),M=i.useRef(),D=i.useRef(),o=i.useRef(),N=i.useRef(),he=i.useRef(),[de,xe]=i.useState(!1),[se,H]=i.useState([]),[te,je]=i.useState([]),[z,me]=i.useState([]),[Ne,we]=i.useState([]),[L,pe]=i.useState([]),[V,J]=i.useState([]),[K,ie]=i.useState(""),[Re,Q]=i.useState(""),[oa,W]=i.useState(""),[R,X]=i.useState([{name:"",icon:"",available:!0}]),[E,Y]=i.useState([{name:"",description:"",icon:"",available:!0}]),[A,Z]=i.useState([{name:"",value:"",icon:""}]),[P,ee]=i.useState([{text:"",icon:"fas fa-info-circle"}]),ye=[{id:"wifi",label:"WiFi",icon:"fa-wifi"},{id:"tv",label:"TV",icon:"fa-tv"},{id:"kitchen",label:"Cocina",icon:"fa-utensils"},{id:"washing_machine",label:"Lavadora",icon:"fa-tshirt"},{id:"parking",label:"Estacionamiento",icon:"fa-car"},{id:"air_conditioning",label:"Aire acondicionado",icon:"fa-snowflake"},{id:"heating",label:"Calefacción",icon:"fa-fire"},{id:"pool",label:"Piscina",icon:"fa-swimming-pool"},{id:"gym",label:"Gimnasio",icon:"fa-dumbbell"},{id:"balcony",label:"Balcón",icon:"fa-building"},{id:"garden",label:"Jardín",icon:"fa-leaf"},{id:"pet_friendly",label:"Pet Friendly",icon:"fa-paw"},{id:"elevator",label:"Ascensor",icon:"fa-elevator"},{id:"terrace",label:"Terraza",icon:"fa-home"},{id:"bbq",label:"Parrilla/BBQ",icon:"fa-fire-burner"},{id:"security",label:"Seguridad 24h",icon:"fa-shield-alt"}],[ae,ne]=i.useState([]);i.useEffect(()=>{De(),Ee()},[]),i.useEffect(()=>{console.log("Provinces state cambió:",L),console.log("Cantidad de provincias:",L.length),u.current&&L.length>0&&(console.log("Actualizando select2 de provincia..."),$(u.current).trigger("change.select2"),setTimeout(()=>{Ce()},200))},[L]),i.useEffect(()=>{console.log("Districts state cambió:",V),console.log("Cantidad de distritos:",V.length),b.current&&V.length>0&&(console.log("Actualizando select2 de distrito..."),$(b.current).trigger("change.select2"))},[V]);const Ce=()=>{if(u.current){console.log("HTML del select de provincia:",u.current.outerHTML),console.log("Opciones del select:",u.current.options.length);for(let a=0;a<u.current.options.length;a++)console.log(`Opción ${a}:`,u.current.options[a].value,"-",u.current.options[a].text)}},De=async()=>{try{const r=await(await fetch("/property-icons.json")).json();je(r)}catch(a){console.error("Error loading property icons:",a)}},Ee=async()=>{try{console.log("Cargando datos de ubigeo...");const r=await(await fetch("/ubigeo.json?"+new Date().getTime())).json();console.log("Datos ubigeo cargados:",r.length,"registros"),console.log("Primer registro:",r[0]),console.log("Estructura del primer registro:",Object.keys(r[0])),me(r);const s=[...new Set(r.map(c=>c.departamento?c.departamento.trim():"").filter(c=>c.length>0))].sort();console.log("Departamentos únicos extraídos:",s),console.log("Total departamentos:",s.length),we(s)}catch(a){console.error("Error loading ubigeo data:",a)}},fe=async a=>{if(console.log("=== CAMBIO DE DEPARTAMENTO ==="),console.log("Departamento seleccionado:",a),console.log("ubigeoData length:",z.length),ie(a),Q(""),W(""),u.current&&$(u.current).val("").trigger("change.select2"),b.current&&$(b.current).val("").trigger("change.select2"),a&&a.trim()){let r=z;if(z.length===0){console.log("ubigeoData está vacío, intentando recargar...");try{const h=await(await fetch("/ubigeo.json")).json();console.log("Datos recargados:",h.length,"registros"),r=h,me(h)}catch(p){console.error("Error recargando datos:",p),pe([]),J([]);return}}const s=a.trim();console.log("Departamento después de trim:",s);const c=r.slice(0,5).map(p=>p.departamento);console.log("Primeros 5 departamentos en los datos:",c);const t=r.filter(p=>p.departamento&&p.departamento.trim()===s);console.log("Datos filtrados por departamento:",t.length),console.log("Primeros 3 registros filtrados:",t.slice(0,3)),t.length===0&&(console.log("⚠️ NO SE ENCONTRARON DATOS para departamento:",s),console.log("Departamentos únicos disponibles:",[...new Set(r.map(p=>p.departamento))]));const n=new Set(t.map(p=>p.provincia?p.provincia.trim():"").filter(p=>p.length>0));console.log("Provincias set:",n);const S=[...n].sort();console.log("Provincias finales:",S),pe(S),setTimeout(()=>{console.log("Estado de provinces después de 100ms:",S)},100)}else pe([]);J([]),console.log("=== FIN CAMBIO DEPARTAMENTO ===")},ge=async(a,r=null)=>{console.log("=== CAMBIO DE PROVINCIA ==="),console.log("Provincia seleccionada:",a);const s=r||K;if(console.log("Departamento a usar:",s),console.log("selectedDepartment del estado:",K),console.log("ubigeoData length:",z.length),Q(a),W(""),b.current&&$(b.current).val("").trigger("change.select2"),a&&a.trim()&&s&&s.trim()){let c=z;if(z.length===0){console.log("ubigeoData está vacío en handleProvinceChange, intentando recargar...");try{const ce=await(await fetch("/ubigeo.json?"+new Date().getTime())).json();console.log("Datos recargados para provincia:",ce.length,"registros"),console.log("Primer registro:",ce[0]),c=ce,me(ce)}catch(h){console.error("Error recargando datos en handleProvinceChange:",h),J([]);return}}const t=a.trim(),n=s.trim();console.log("Buscando distritos para:",{departmentTrimmed:n,provinceTrimmed:t}),console.log("Datos disponibles para filtrar:",c.length,"registros");const S=c.filter(h=>h.departamento&&h.departamento.trim()===n&&h.provincia&&h.provincia.trim()===t);console.log("Registros filtrados por depto y provincia:",S.length),console.log("Primeros 3 registros filtrados:",S.slice(0,3));const p=S.map(h=>h.distrito?h.distrito.trim():"").filter(h=>h.length>0).sort();console.log("Distritos encontrados:",p),console.log("Cantidad de distritos:",p.length),J(p)}else console.log("❌ Condición no cumplida:"),console.log("  - province:",a),console.log("  - province.trim():",a?a.trim():"N/A"),console.log("  - currentDepartment:",s),console.log("  - currentDepartment.trim():",s?s.trim():"N/A"),J([]);console.log("=== FIN CAMBIO PROVINCIA ===")},Ae=a=>{W(a),console.log("Distrito seleccionado:",a)},Pe=a=>{const r=Array.from(a.target.files);H(s=>[...s,...r])},Se=a=>{a.preventDefault();const r=Array.from(a.dataTransfer.files);H(s=>[...s,...r])},$e=a=>{a.preventDefault()},Te=a=>{H(r=>r.filter((s,c)=>c!==a))},_e=a=>{ne(r=>r.includes(a)?r.filter(s=>s!==a):[...r,a])},ke=()=>{X([...R,{name:"",icon:"",available:!0}])},Fe=i.useCallback((a,r,s)=>{X(c=>c.map((t,n)=>n===a?{...t,[r]:s}:t))},[]),Be=a=>{R.length>1&&X(R.filter((r,s)=>s!==a))},Ie=()=>{Y([...E,{name:"",description:"",icon:"",available:!0}])},Oe=i.useCallback((a,r,s)=>{Y(c=>c.map((t,n)=>n===a?{...t,[r]:s}:t))},[]),qe=a=>{E.length>1&&Y(E.filter((r,s)=>s!==a))},Ge=()=>{Z([...A,{name:"",value:"",icon:""}])},Ue=i.useCallback((a,r,s)=>{Z(c=>c.map((t,n)=>n===a?{...t,[r]:s}:t))},[]),Me=a=>{A.length>1&&Z(A.filter((r,s)=>s!==a))},ze=()=>{ee([...P,{text:"",icon:"fas fa-info-circle"}])},He=i.useCallback((a,r,s)=>{ee(c=>c.map((t,n)=>n===a?{...t,[r]:s}:t))},[]),Le=a=>{P.length>1&&ee(P.filter((r,s)=>s!==a))},be=async a=>{var r,s,c,t;if(xe(!!a),a){f.current.value=a.id||"",v.current.value=a.title||"",m.current.value="Airbnb",T.current.value=a.price_per_night||"",_.current.value=a.currency||"PEN",k.current.value=a.address||"",F.current.value=a.postal_code||"",B.current.value=a.external_link||"",a.amenities&&Array.isArray(a.amenities)?ne(a.amenities):ne([]),a.department&&(ie(a.department),await fe(a.department),$(w.current).val(a.department).trigger("change"),a.province&&(Q(a.province),await ge(a.province,a.department),setTimeout(()=>{$(u.current).val(a.province).trigger("change")},100),a.district&&(W(a.district),setTimeout(()=>{$(b.current).val(a.district).trigger("change")},200)))),I.current.value=a.bedrooms||1,O.current.value=a.bathrooms||1,j.current.value=a.max_guests||2,q.current.value=a.area_m2||"",C.current.value=a.latitude||"",G.current.value=a.longitude||"",U.current.value=a.description||"",M.current.value=a.short_description||"",D.current.value=a.rating||5,o.current.value=a.reviews_count||0,a.main_image&&(N.image.src=`/api/property/media/${a.main_image}`);const n=(r=a.amenities_custom)!=null&&r.length?a.amenities_custom:[{name:"",icon:"",available:!0}];X(n),Y((s=a.services)!=null&&s.length?a.services:[{name:"",description:"",icon:"",available:!0}]),Z((c=a.characteristics)!=null&&c.length?a.characteristics:[{name:"",value:"",icon:""}]),ee((t=a.house_rules)!=null&&t.length?a.house_rules:[{text:"",icon:"fas fa-info-circle"}]),H(a.gallery||[])}else f.current.value="",v.current.value="",m.current.value="Airbnb",T.current.value="",_.current.value="PEN",k.current.value="",F.current.value="",B.current.value="",ne([]),ie(""),Q(""),$(w.current).val("").trigger("change"),$(u.current).val("").trigger("change"),$(b.current).val("").trigger("change"),I.current.value=1,O.current.value=1,j.current.value=2,q.current.value="",C.current.value="",G.current.value="",U.current.value="",M.current.value="",D.current.value=5,o.current.value=0,N.current.value="",N.image.src="/api/property/media/undefined",X([{name:"",icon:"",available:!0}]),Y([{name:"",description:"",icon:"",available:!0}]),Z([{name:"",value:"",icon:""}]),ee([{text:"",icon:"fas fa-info-circle"}]),H([]);$(d.current).modal("show")},Ve=async a=>{var s,c;a.preventDefault();const r=new FormData;if(f.current.value&&r.append("id",f.current.value),r.append("title",v.current.value),r.append("platform","Airbnb"),r.append("price_per_night",T.current.value),r.append("currency",_.current.value),r.append("address",k.current.value),r.append("postal_code",F.current.value),r.append("external_link",B.current.value),r.append("department",$(w.current).val()),r.append("province",$(u.current).val()),r.append("district",$(b.current).val()),r.append("bedrooms",I.current.value),r.append("bathrooms",O.current.value),r.append("max_guests",j.current.value),r.append("area_m2",q.current.value),r.append("latitude",C.current.value),r.append("longitude",G.current.value),r.append("description",U.current.value),r.append("short_description",M.current.value),r.append("rating",D.current.value),r.append("reviews_count",o.current.value),de||r.append("admin_approved",!0),ae.forEach((t,n)=>{r.append(`amenities[${n}]`,t)}),R.forEach((t,n)=>{r.append(`amenities_custom[${n}][name]`,t.name),r.append(`amenities_custom[${n}][icon]`,t.icon),r.append(`amenities_custom[${n}][available]`,t.available)}),(c=(s=N.current)==null?void 0:s.files)!=null&&c[0]&&r.append("main_image",N.current.files[0]),se.forEach((t,n)=>{t instanceof File&&r.append("gallery[]",t)}),de){const t=se.filter(n=>typeof n=="string");r.append("existing_gallery",JSON.stringify(t))}R.forEach((t,n)=>{r.append(`amenities_custom[${n}][name]`,t.name),r.append(`amenities_custom[${n}][icon]`,t.icon),r.append(`amenities_custom[${n}][available]`,t.available)}),E.forEach((t,n)=>{r.append(`services[${n}][name]`,t.name),r.append(`services[${n}][description]`,t.description||""),r.append(`services[${n}][icon]`,t.icon),r.append(`services[${n}][available]`,t.available)}),A.forEach((t,n)=>{r.append(`characteristics[${n}][name]`,t.name),r.append(`characteristics[${n}][value]`,t.value||""),r.append(`characteristics[${n}][icon]`,t.icon)}),P.forEach((t,n)=>{r.append(`house_rules[${n}][text]`,t.text),r.append(`house_rules[${n}][icon]`,t.icon)});try{await re.save(r),$(d.current).modal("hide"),$(l.current).dxDataGrid("instance").refresh(),x.fire({title:"Éxito",text:"Propiedad guardada correctamente",icon:"success"})}catch(t){console.error("Error saving property:",t),x.fire({title:"Error",text:"Error al guardar la propiedad",icon:"error"})}},ve=async({id:a,field:r,value:s})=>{try{await re.boolean({id:a,field:r,value:s}),$(l.current).dxDataGrid("instance").refresh()}catch(c){console.error("Error updating property:",c)}},Je=async a=>{try{(await x.fire({title:"¿Aprobar propiedad?",text:"Esta propiedad será visible públicamente",icon:"question",showCancelButton:!0,confirmButtonColor:"#198754",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, aprobar",cancelButtonText:"Cancelar"})).isConfirmed&&(await re.boolean({id:a,field:"admin_approved",value:!0}),$(l.current).dxDataGrid("instance").refresh(),x.fire({title:"Aprobada",text:"La propiedad ha sido aprobada exitosamente",icon:"success"}))}catch(r){console.error("Error approving property:",r),x.fire({title:"Error",text:"Error al aprobar la propiedad",icon:"error"})}},Ke=async a=>{var r;try{if((await x.fire({title:"¿Rechazar propiedad?",text:"Esta propiedad no será visible públicamente",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, rechazar",cancelButtonText:"Cancelar"})).isConfirmed){const t=await(await fetch("/api/admin/properties/reject",{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content")},body:JSON.stringify({id:a})})).json();if(t.status===200)$(l.current).dxDataGrid("instance").refresh(),x.fire({title:"Rechazada",text:"La propiedad ha sido rechazada",icon:"success"});else throw new Error(t.message)}}catch(s){console.error("Error rejecting property:",s),x.fire({title:"Error",text:"Error al rechazar la propiedad",icon:"error"})}},Qe=async a=>{if((await x.fire({title:"¿Estás seguro?",text:"¿Estás seguro de eliminar esta propiedad?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await re.delete(a),$(l.current).dxDataGrid("instance").refresh(),x.fire({title:"Éxito",text:"Propiedad eliminada correctamente",icon:"success"})}catch(s){console.error("Error deleting property:",s),x.fire({title:"Error",text:"Error al eliminar la propiedad",icon:"error"})}};return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx(ea,{gridRef:l,title:"Propiedades",rest:re,toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(l.current).dxDataGrid("instance").refresh()}}),a.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva Propiedad",hint:"Crear nueva propiedad",onClick:async()=>await be()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"main_image",caption:"Imagen",width:"80px",allowFiltering:!1,cellTemplate:(a,{data:r})=>{y(a,r.main_image?e.jsx("img",{src:`/api/property/media/${r.main_image}`,alt:"Propiedad",className:"rounded",style:{width:"60px",height:"40px",objectFit:"cover"}}):e.jsx("div",{className:"bg-secondary rounded d-flex align-items-center justify-content-center",style:{width:"60px",height:"40px"},children:e.jsx("i",{className:"fas fa-image text-white"})}))}},{dataField:"title",caption:"Título",width:"250px"},{dataField:"platform",caption:"Plataforma",width:"100px"},{dataField:"price_per_night",caption:"Precio/Noche",width:"120px",cellTemplate:(a,{data:r})=>{y(a,e.jsxs("span",{children:[r.currency," ",parseFloat(r.price_per_night||0).toFixed(2)]}))}},{dataField:"district",caption:"Ubicación",width:"150px",cellTemplate:(a,{data:r})=>{y(a,e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:r.district}),e.jsx("small",{className:"text-muted",children:r.department})]}))}},{dataField:"bedrooms",caption:"Dormitorios",width:"100px"},{dataField:"max_guests",caption:"Huéspedes",width:"100px"},{dataField:"rating",caption:"Rating",width:"80px",cellTemplate:(a,{data:r})=>{y(a,e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-star me-1"}),r.rating||0]}))}},{dataField:"active",caption:"Activo",dataType:"boolean",width:"100px",cellTemplate:(a,{data:r})=>{y(a,e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:r.active,onChange:s=>ve({id:r.id,field:"active",value:s.target.checked})})}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"100px",cellTemplate:(a,{data:r})=>{y(a,e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:r.featured,onChange:s=>ve({id:r.id,field:"featured",value:s.target.checked})})}))}},{dataField:"admin_approved",caption:"Aprobación",width:"140px",cellTemplate:(a,{data:r})=>{y(a,e.jsx("div",{className:"d-flex gap-1",children:r.admin_approved?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check me-1"}),"Aprobada"]}),e.jsx("button",{className:"btn btn-xs btn-outline-danger",onClick:()=>Ke(r.id),title:"Rechazar",children:e.jsx("i",{className:"fas fa-times"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-clock me-1"}),"Pendiente"]}),e.jsx("button",{className:"btn btn-xs btn-outline-success",onClick:()=>Je(r.id),title:"Aprobar",children:e.jsx("i",{className:"fas fa-check"})})]})}))},allowFiltering:!0,filterOperations:["="],lookup:{dataSource:[{value:!0,text:"Aprobada"},{value:!1,text:"Pendiente"}],valueExpr:"value",displayExpr:"text"}},{caption:"Acciones",width:"100px",cellTemplate:(a,{data:r})=>{y(a,e.jsxs("div",{className:"d-flex gap-1",children:[e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:async()=>await be(r),title:"Editar",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>Qe(r.id),title:"Eliminar",children:e.jsx("i",{className:"fas fa-trash"})})]}))},allowFiltering:!1,allowExporting:!1}]})})})})}),e.jsx(aa,{modalRef:d,title:de?"Editar Propiedad":"Nueva Propiedad",onSubmit:Ve,size:"xl",children:e.jsxs("div",{className:"row",id:"principal-container",children:[e.jsx("input",{type:"hidden",ref:f}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-8",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-8 mb-3",children:e.jsx(g,{label:"Título de la propiedad",eRef:v,placeholder:"Ej: Apartamento moderno en Miraflores",required:!0})}),e.jsxs("div",{className:"col-lg-4 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Plataforma"}),e.jsxs("select",{className:"form-select",ref:m,required:!0,disabled:!0,children:[e.jsx("option",{value:"Airbnb",children:"Airbnb"}),e.jsx("option",{value:"Booking",children:"Booking.com"}),e.jsx("option",{value:"Vrbo",children:"Vrbo"}),e.jsx("option",{value:"HomeAway",children:"HomeAway"}),e.jsx("option",{value:"Otras",children:"Otras"})]})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(g,{label:"Precio por noche",eRef:T,type:"number",step:"0.01",min:"0",placeholder:"120.00",required:!0})}),e.jsxs("div",{className:"col-lg-2 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Moneda"}),e.jsxs("select",{className:"form-select",ref:_,disabled:!0,children:[e.jsx("option",{value:"PEN",children:"PEN"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(g,{label:"Dormitorios",eRef:I,type:"number",min:"1",placeholder:"1",required:!0})}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(g,{label:"Baños",eRef:O,type:"number",min:"1",placeholder:"1",required:!0})}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(g,{label:"Huéspedes máx.",eRef:j,type:"number",min:"1",placeholder:"2",required:!0})})]})]}),e.jsx("div",{className:"col-lg-4",children:e.jsx(ra,{label:"Imagen principal",eRef:N,aspect:16/9})})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-images me-2"}),"Galería de Imágenes"]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Agregar imágenes a la galería"}),e.jsxs("div",{className:"border border-dashed border-primary rounded p-4 text-center",onDrop:Se,onDragOver:$e,style:{minHeight:"120px"},children:[e.jsx("i",{className:"fas fa-cloud-upload-alt fa-3x text-primary mb-3"}),e.jsx("p",{className:"mb-2",children:"Arrastra las imágenes aquí o"}),e.jsx("input",{type:"file",ref:he,multiple:!0,accept:"image/*",onChange:Pe,className:"d-none"}),e.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{var a;return(a=he.current)==null?void 0:a.click()},children:"Seleccionar Archivos"})]})]}),se.length>0&&e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"row",children:se.map((a,r)=>e.jsx("div",{className:"col-lg-2 col-md-3 col-sm-4 mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("img",{src:a instanceof File?URL.createObjectURL(a):`/api/property/media/${a}`,alt:`Galería ${r+1}`,className:"img-fluid rounded",style:{width:"100%",height:"100px",objectFit:"cover"}}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm position-absolute top-0 end-0 rounded-circle",style:{width:"25px",height:"25px",fontSize:"12px"},onClick:()=>Te(r),children:e.jsx("i",{className:"fas fa-times"})})]})},r))})})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-map-marker-alt me-2"}),"Ubicación"]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(g,{label:"Dirección completa",eRef:k,placeholder:"Av. Ricardo Palma 251",required:!0})}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(g,{label:"Código Postal",eRef:F,placeholder:"15074"})}),e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx(g,{label:"Link de Airbnb (Para sincronizar fechas)",eRef:B,type:"url",placeholder:"https://www.airbnb.com/rooms/12345"}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-info-circle me-1"}),"Este enlace permite sincronizar automáticamente las fechas disponibles"]})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsxs(le,{label:"Departamento",eRef:w,onChange:a=>{const r=a.target.value;ie(r),fe(r)},dropdownParent:"#principal-container",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),Ne.map((a,r)=>e.jsx("option",{value:a,children:a},r))]})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsxs(le,{label:"Provincia",eRef:u,onChange:a=>{const r=a.target.value;Q(r);const s=w.current?$(w.current).val():K;console.log("🔍 Provincia onChange - Departamento actual:",s),console.log("🔍 Provincia onChange - selectedDepartment estado:",K),ge(r,s)},disabled:!K,dropdownParent:"#principal-container",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),L.map((a,r)=>e.jsx("option",{value:a,children:a},r))]})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsxs(le,{label:"Distrito",eRef:b,onChange:a=>{const r=a.target.value;W(r),Ae(r)},disabled:!Re,dropdownParent:"#principal-container",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),V.map((a,r)=>e.jsx("option",{value:a,children:a},r))]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(g,{label:"Área (m²)",eRef:q,type:"number",min:"1",placeholder:"60"})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(g,{label:"Latitud",eRef:C,type:"number",step:"0.000001",placeholder:"-12.1211"})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(g,{label:"Longitud",eRef:G,type:"number",step:"0.000001",placeholder:"-77.0269"})})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-align-left me-2"}),"Descripción"]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Descripción completa"}),e.jsx("textarea",{className:"form-control",ref:U,rows:4,placeholder:"Describe detalladamente la propiedad...",required:!0})]}),e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Descripción corta"}),e.jsx("textarea",{className:"form-control",ref:M,rows:4,placeholder:"Resumen breve para listados..."})]})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-star me-2"}),"Amenidades Principales"]}),e.jsx("div",{className:"row",children:ye.map((a,r)=>e.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:e.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${ae.includes(a.id)?"border-primary bg-light":"border-light hover:border-secondary"}`,onClick:()=>_e(a.id),style:{cursor:"pointer"},children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("i",{className:`fas ${a.icon} fa-2x mb-2 ${ae.includes(a.id)?"text-primary":"text-muted"}`}),e.jsx("h6",{className:`mb-0 ${ae.includes(a.id)?"text-primary fw-bold":"text-dark"}`,children:a.label}),ae.includes(a.id)&&e.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:e.jsx("i",{className:"fas fa-check-circle text-success"})})]})})},a.id))}),e.jsxs("div",{className:"alert alert-info",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona las amenidades que tiene tu propiedad. Estas amenidades son las más comunes y aparecerán destacadas en los listados."]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-wifi me-2"}),"Amenidades Personalizadas"]}),e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle me-2"}),"Agrega amenidades adicionales que no estén en la lista principal."]}),e.jsx("div",{className:"row",children:R.map((a,r)=>e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(oe,{feature:a,index:r,onUpdate:Fe,onRemove:Be,type:"amenity",canRemove:R.length>1,amenities:R,addAmenity:ke,propertyIcons:te})},r))})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-concierge-bell me-2"}),"Servicios"]}),e.jsx("div",{className:"row",children:E.map((a,r)=>e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(oe,{feature:a,index:r,onUpdate:Oe,onRemove:qe,type:"service",canRemove:E.length>1,services:E,addService:Ie,propertyIcons:te})},r))})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-home me-2"}),"Características"]}),e.jsx("div",{className:"row",children:A.map((a,r)=>e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(oe,{feature:a,index:r,onUpdate:Ue,onRemove:Me,type:"characteristic",canRemove:A.length>1,characteristics:A,addCharacteristic:Ge,propertyIcons:te})},r))})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-gavel me-2"}),"Reglas de la Casa"]}),e.jsx("div",{className:"row",children:P.map((a,r)=>e.jsx("div",{className:"col-lg-6 mb-3",children:e.jsx(oe,{feature:a,index:r,onUpdate:He,onRemove:Le,type:"houseRule",canRemove:P.length>1,houseRules:P,addHouseRule:ze,propertyIcons:te})},r))})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-star me-2"}),"Información Adicional"]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-3 mb-3",children:e.jsx(g,{label:"Rating",eRef:D,type:"number",step:"0.1",min:"1",max:"5",placeholder:"5.0"})}),e.jsx("div",{className:"col-lg-3 mb-3",children:e.jsx(g,{label:"Número de reseñas",eRef:o,type:"number",min:"0",placeholder:"0"})})]})]})]})})]})};sa((l,d)=>{Ye(l).render(e.jsx(Ze,{...d,title:"Propiedades",children:e.jsx(ca,{...d})}))});
