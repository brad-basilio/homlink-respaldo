import{j as i}from"./RequirementCard-DEdD30eg.js";import{r as n}from"./index-RYns6xqu.js";import{c as ue}from"./ReactAppend-vpV7VTGG.js";import{C as fe,e as de,s as he,R as W,S as ge,D as J,l as ve,ai as xe,h as j,j as P,aj as be,ak as je,al as Re}from"./CreateReactScript-C-mUikVe.js";import{r as Ne}from"./DxBox-DZgBbgD6.js";import"./sweetalert2.all-DJo0UVK6.js";import{L as Ce}from"./Filter-BDLE8FWR.js";import"./index-CXU7o9CY.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./axios-B4uVmeYG.js";import"./Results-CoLI09XT.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const G=new je,K=({feature:g,index:l,onUpdate:v,onRemove:R,type:p,canRemove:B,characteristics:N,benefits:C,addCharacteristic:w,addBenefit:y})=>{const x=(m,D)=>{v(l,m,D)},_=m=>{v(l,"image",m)};return i.jsx("div",{className:"card mb-3",children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx(j,{label:"Título",value:g.title,onChange:m=>x("title",m.target.value)}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{className:"form-control",rows:3,value:g.description,onChange:m=>x("description",m.target.value)})]})]}),i.jsx("div",{className:"col-md-6",children:i.jsx(Re,{current:"purchaseOption",label:"Imagen",currentImage:g.image,onChange:_,aspect:16/9})})]}),i.jsxs("div",{className:"d-flex justify-content-between",children:[i.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>R(l),disabled:!B,children:"Eliminar"}),p==="characteristic"&&l===N.length-1||p==="benefit"&&l===C.length-1?i.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:p==="characteristic"?w:y,children:["Agregar"," ",p==="characteristic"?"Característica":"Beneficio"]}):null]})]})})},we=({brands:g})=>{var V;const l=n.useRef(),v=n.useRef(),R=n.useRef(),p=n.useRef(),B=n.useRef(),N=n.useRef(),C=n.useRef(),w=n.useRef(),y=n.useRef(),x=n.useRef(),_=n.useRef(),m=n.useRef(),D=n.useRef(),q=n.useRef(),O=n.useRef(),T=n.useRef(),[Q,M]=n.useState(!1),[A,X]=n.useState(null),[u,F]=n.useState([{title:"",description:"",image:void 0}]),[f,I]=n.useState([{title:"",description:"",image:void 0}]),[b,d]=n.useState([{title:"",image:void 0,characteristics:[""]}]),[Y,U]=n.useState(""),H=()=>{F([...u,{title:"",description:"",image:void 0}])},Z=n.useCallback((e,s,r)=>{F(a=>{const c=[...a];return c[e]={...c[e],[s]:r},c})},[]),ee=e=>{u.length<=1||F(u.filter((s,r)=>r!==e))},L=()=>{I([...f,{title:"",description:"",image:void 0}])},ie=n.useCallback((e,s,r)=>{I(a=>{const c=[...a];return c[e]={...c[e],[s]:r},c})},[]),se=e=>{f.length<=1||I(f.filter((s,r)=>r!==e))},te=()=>{d([...b,{title:"",image:void 0,characteristics:[""]}])},re=(e,s,r)=>{d(a=>a.map((c,h)=>h===e?{...c,[s]:r}:c))},ne=e=>{b.length<=1||d(b.filter((s,r)=>r!==e))},ce=(e,s,r)=>{d(a=>a.map((c,h)=>{if(h===e){const S=[...c.characteristics];return S[s]=r,{...c,characteristics:S}}return c}))},ae=e=>{d(s=>s.map((r,a)=>a===e?{...r,characteristics:[...r.characteristics,""]}:r))},oe=(e,s)=>{d(r=>r.map((a,c)=>c===e?{...a,characteristics:a.characteristics.filter((h,S)=>S!==s)}:a))},z=e=>{e!=null&&e.id?M(!0):M(!1),R.current.value=(e==null?void 0:e.id)??"",p.current.value=(e==null?void 0:e.title)??"",B.current.value=(e==null?void 0:e.category.name)??"",U(e==null?void 0:e.category.name),X(e),N.current.value=(e==null?void 0:e.description)??"",C.current.value=(e==null?void 0:e.how_it_helps)??"",w.current.value=(e==null?void 0:e.description_helps)??"",y.current.value=(e==null?void 0:e.value_proposition)??"",x.current.value=(e==null?void 0:e.innovation_focus)??"",_.current.value=(e==null?void 0:e.customer_relation)??"",m.current.value=(e==null?void 0:e.how_it_requirements)??"",D.current.value=(e==null?void 0:e.description_requirements)??"",q.image.src=`/api/purchaseOption/media/${(e==null?void 0:e.image)??"undefined"}`,O.image.src=`/api/purchaseOption/media/${(e==null?void 0:e.image_secondary)??"undefined"}`,T.image.src=`/api/purchaseOption/media/${(e==null?void 0:e.image_banner)??"undefined"}`,e!=null&&e.characteristics&&F(e.characteristics.map(s=>({title:s.title,description:s.description,image:s.image}))),e!=null&&e.benefits&&I(e.benefits.map(s=>({title:s.title,description:s.description,image:s.image}))),e!=null&&e.requirements&&d(e.requirements.map(s=>({title:s.title||"",image:s.image||void 0,characteristics:s.characteristics||[""]}))),$(v.current).modal("show")},le=async e=>{e.preventDefault();const s=new FormData,r={id:R.current.value||void 0,title:p.current.value,description:N.current.value,how_it_helps:C.current.value,description_helps:w.current.value,value_proposition:y.current.value,innovation_focus:x.current.value,customer_relation:_.current.value,how_it_requirements:m.current.value,description_requirements:D.current.value};for(const t in r)s.append(t,r[t]);const a=q.current.files[0];a&&s.append("image",a);const c=O.current.files[0];c&&s.append("image_secondary",c);const h=T.current.files[0];h&&s.append("image_banner",h),u.forEach((t,o)=>{s.append(`characteristics[${o}][title]`,t.title),s.append(`characteristics[${o}][description]`,t.description),t.image&&(t.image.file?s.append(`characteristics[${o}][image]`,t.image.file):typeof t.image=="string"&&s.append(`characteristics[${o}][existing_image]`,t.image))}),f.forEach((t,o)=>{s.append(`benefits[${o}][title]`,t.title),s.append(`benefits[${o}][description]`,t.description),t.image&&(t.image.file?s.append(`benefits[${o}][image]`,t.image.file):typeof t.image=="string"&&s.append(`benefits[${o}][existing_image]`,t.image))}),b.map((t,o)=>{var E;const k={title:t.title,characteristics:t.characteristics.filter(pe=>pe.trim()!=="")};return(E=t.image)!=null&&E.file?s.append(`requirements[${o}][image]`,t.image.file):typeof t.image=="string"&&(k.image=t.image),k}).forEach((t,o)=>{s.append(`requirements[${o}][title]`,t.title),t.image&&(typeof t.image=="object"&&t.image.file?s.append(`requirements[${o}][image]`,t.image.file):typeof t.image=="string"&&s.append(`requirements[${o}][existing_image]`,t.image)),t.characteristics.forEach((k,E)=>{s.append(`requirements[${o}][characteristics][${E}]`,k)})}),s.append("category_name",Y),await G.save(s)&&($(l.current).dxDataGrid("instance").refresh(),$(v.current).modal("hide"))},me=async({id:e,field:s,value:r})=>{await G.boolean({id:e,field:s,value:r})&&$(l.current).dxDataGrid("instance").refresh()};return i.jsxs(i.Fragment,{children:[i.jsx(he,{gridRef:l,title:"Opciones de compra",rest:G,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(l.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nueva opción de compra",onClick:()=>z()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"title",caption:"Título",width:"200px"},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:s})=>{e.html(Ne(i.jsx("div",{className:"text-truncate",style:{maxWidth:"300px"},children:s.description})))}},{dataField:"image",caption:"Imagen",width:"100px",cellTemplate:(e,{data:s})=>{W(e,i.jsx("img",{src:`/api/purchaseOption/media/${s.image}`,style:{width:"80px",height:"45px",objectFit:"cover",borderRadius:"4px"},onError:r=>r.target.src="/images/default-thumbnail.jpg"}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"80px",cellTemplate:(e,{data:s})=>{W(e,i.jsx(ge,{checked:s.featured,onChange:r=>me({id:s.id,field:"featured",value:r.target.checked})}))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{e.append(J({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>z(s)})),e.append(J({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>onDeleteClicked(s.id)}))}}]}),i.jsxs(ve,{modalRef:v,title:Q?"Editar Opción de Compra":"Nueva Opción de Compra",onSubmit:le,size:"lg",children:[i.jsx("input",{ref:R,type:"hidden"}),i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-6",id:"purchase-container",children:[i.jsx(xe,{eRef:B,dropdownParent:"#purchase-container",label:"Categoría",searchAPI:"/api/admin/category_purcharse_options/paginate",searchBy:"name",allowCreate:!0,onChange:e=>U(e),initialValue:((V=A==null?void 0:A.category)==null?void 0:V.name)||""}),i.jsx(j,{eRef:p,label:"Título de la opción de compra",required:!0}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{ref:N,className:"form-control",rows:4,required:!0})]})]}),i.jsxs("div",{className:"col-md-6",children:[i.jsx(j,{eRef:C,label:"Cómo ayuda"}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción de ayuda"}),i.jsx("textarea",{ref:w,className:"form-control",rows:4})]})]})]}),i.jsxs("div",{className:"row mt-3",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(P,{eRef:q,label:"Imagen principal",aspect:16/9})}),i.jsx("div",{className:"col-md-6",children:i.jsx(P,{eRef:O,label:"Imagen secundaria",aspect:16/9})}),i.jsx("div",{className:"col-md-12 mt-3",children:i.jsx(P,{eRef:T,label:"Banner",aspect:16/9})})]}),i.jsx("div",{className:"row mt-3",children:i.jsxs("div",{className:"col-12",children:[i.jsx(j,{eRef:y,label:"Propuesta de valor"}),i.jsx("h5",{className:"mb-3",children:"Características"}),u.map((e,s)=>i.jsx(K,{feature:e,index:s,onUpdate:Z,onRemove:ee,canRemove:u.length>1,type:"characteristic",characteristics:u,benefits:f,addCharacteristic:H,addBenefit:L},`char-${s}`))]})}),i.jsxs("div",{className:"row mt-3",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(j,{eRef:x,label:"Enfoque de innovación"})}),i.jsx("div",{className:"col-md-6",children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Relación con el cliente"}),i.jsx("textarea",{ref:_,className:"form-control",rows:5})]})}),i.jsxs("div",{className:"col-md-12",children:[i.jsx("h5",{className:"mb-3 mt-4",children:"Beneficios"}),f.map((e,s)=>i.jsx(K,{feature:e,index:s,onUpdate:ie,onRemove:se,canRemove:f.length>1,type:"benefit",characteristics:u,benefits:f,addCharacteristic:H,addBenefit:L},`benefit-${s}`))]})]}),i.jsx("div",{className:"row mt-3",children:i.jsxs("div",{className:"col-12",children:[i.jsx("h5",{className:"mb-3",children:"Requisitos"}),i.jsxs("div",{className:"mb-3",children:[i.jsx(j,{eRef:m,label:"Cómo funciona los requisitos"}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción de requisitos"}),i.jsx("textarea",{ref:D,className:"form-control",rows:4})]})]}),b&&b.map((e,s)=>i.jsx(be,{requirement:e,index:s,onUpdate:re,onRemove:ne,onAddCharacteristic:ae,onUpdateCharacteristic:ce,onRemoveCharacteristic:oe},`requirement-${s}`)),i.jsxs("button",{type:"button",className:"btn btn-primary mt-2",onClick:te,children:[i.jsx("i",{className:"fa fa-plus me-2"})," Agregar Requisito"]})]})})]})]})};fe((g,l)=>{ue(g).render(i.jsx(Ce,{children:i.jsx(de,{...l,title:"Opción de Compras",children:i.jsx(we,{...l})})}))});
