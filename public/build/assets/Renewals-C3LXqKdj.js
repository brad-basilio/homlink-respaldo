import{j as n}from"./RequirementCard-DEdD30eg.js";import{r as i}from"./index-RYns6xqu.js";import{c as T}from"./ReactAppend-vpV7VTGG.js";import{C as F,e as k,T as M,R as b,S as R,D as g,M as E,h as l,am as N}from"./CreateReactScript-C-mUikVe.js";import{S as _}from"./sweetalert2.all-DJo0UVK6.js";import{r as B}from"./DxBox-DZgBbgD6.js";import"./index-CXU7o9CY.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./Results-CoLI09XT.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const c=new N,S=({})=>{const r=i.useRef(),o=i.useRef(),a=i.useRef(),m=i.useRef(),u=i.useRef(),p=i.useRef(),d=i.useRef(),f=i.useRef(),h=i.useRef(),[w,x]=i.useState(!1),v=e=>{e!=null&&e.id?x(!0):x(!1),a.current.value=(e==null?void 0:e.id)??"",m.current.value=(e==null?void 0:e.name)??"",u.current.value=((e==null?void 0:e.percentage)??0)*100,p.current.value=(e==null?void 0:e.months)??"",d.current.value=(e==null?void 0:e.items)??1,f.current.value=(e==null?void 0:e.date_begin)??"",h.current.value=(e==null?void 0:e.date_end)??"",$(o.current).modal("show")},j=async e=>{e.preventDefault();const t={id:a.current.value||void 0,name:m.current.value,percentage:u.current.value/100,months:p.current.value,items:d.current.value,date_begin:f.current.value||null,date_end:h.current.value||null};await c.save(t)&&($(r.current).dxDataGrid("instance").refresh(),$(o.current).modal("hide"))},y=async({id:e,value:t})=>{await c.boolean({id:e,field:"visible",value:t})&&$(r.current).dxDataGrid("instance").refresh()},D=async({id:e,value:t})=>{await c.boolean({id:e,field:"delivery_free",value:t})&&$(r.current).dxDataGrid("instance").refresh()},C=async e=>{const{isConfirmed:t}=await _.fire({title:"Eliminar renovación",text:"¿Estás seguro de eliminar esta renovación?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await c.delete(e)||$(r.current).dxDataGrid("instance").refresh()};return n.jsxs(n.Fragment,{children:[n.jsx(M,{gridRef:r,title:"Renovaciones",rest:c,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva renovación",hint:"Nueva renovación",onClick:()=>v()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Contenido",width:"200px",cellTemplate:(e,{data:t})=>{b(e,n.jsxs("p",{className:"mb-0",style:{width:"100%"},children:[n.jsx("b",{className:"d-block",children:t.name}),n.jsxs("small",{className:"text-wrap text-muted",style:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2},children:["Renovación cada ",t.months," ",t.months>1?"meses":"mes"]})]}))}},{dataField:"items",caption:"A partir de",dataType:"number",cellTemplate:(e,{data:t})=>{e.text(`${t.items} ${t.items>1?"items":"item"}`)},width:75},{dataField:"percentage",caption:"Descuento",dataType:"number",format:"percent",width:75},{dataField:"date_begin",caption:"Promoción",cellTemplate:(e,{data:t})=>{t.date_begin&&t.date_end?e.html(B(n.jsxs(n.Fragment,{children:[n.jsxs("p",{className:"mb-0",children:[n.jsx("b",{children:"Desde:"})," ",moment(t.date_begin).format("DD [de] MMMM")]}),n.jsxs("p",{className:"mb-0",children:[n.jsx("b",{children:"Hasta:"})," ",moment(t.date_end).format("DD [de] MMMM")]})]}))):e.html('<p class="mb-0"><b>Válida:</b> Todo el tiempo</p>')}},{dataField:"delivery_free",caption:"Envío gratis",dataType:"boolean",width:"120px",cellTemplate:(e,{data:t})=>{b(e,n.jsx(R,{checked:t.delivery_free,onChange:s=>D({id:t.id,value:s.target.checked})}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",width:"120px",cellTemplate:(e,{data:t})=>{b(e,n.jsx(R,{checked:t.visible,onChange:s=>y({id:t.id,value:s.target.checked})}))}},{caption:"Acciones",cellTemplate:(e,{data:t})=>{e.css("text-overflow","unset"),e.append(g({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>v(t)})),e.append(g({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>C(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),n.jsx(E,{modalRef:o,title:w?"Editar plan":"Nuevo plan",onSubmit:j,size:"md",children:n.jsxs("div",{className:"row",children:[n.jsx("input",{ref:a,type:"hidden"}),n.jsx(l,{eRef:m,label:"Nombre del plan",required:!0,col:"col-12"}),n.jsx(l,{eRef:u,label:"Descuento",type:"number",min:0,max:100,required:!0,col:"col-md-4"}),n.jsx(l,{eRef:p,label:"Meses",specification:"¿Cada cuántos meses?",type:"number",min:1,required:!0,col:"col-md-4"}),n.jsx(l,{eRef:d,label:"Items",specification:"¿A partir de cuántos items?",type:"number",min:1,required:!0,col:"col-md-4"}),n.jsx(l,{eRef:f,label:"Fecha inicio",type:"date",col:"col-md-6"}),n.jsx(l,{eRef:h,label:"Fecha fin",type:"date",col:"col-md-6"})]})})]})};F((r,o)=>{T(r).render(n.jsx(k,{...o,title:"Renovaciones",children:n.jsx(S,{...o})}))});
