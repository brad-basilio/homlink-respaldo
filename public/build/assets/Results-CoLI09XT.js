var h=Object.defineProperty;var f=(a,t,o)=>t in a?h(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;var r=(a,t,o)=>(f(a,typeof t!="symbol"?t+"":t,o),o);import"./RequirementCard-DEdD30eg.js";import"./index-RYns6xqu.js";import{m as s}from"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";let c=new AbortController;class u{constructor(){r(this,"path",null);r(this,"hasFiles",!1);r(this,"enableNotifications",!0);r(this,"paginate",async t=>{c.abort("Nothing"),c=new AbortController;const o=c.signal;return await(await fetch(`/api/${this.path}/paginate`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(s.Cookies.get("XSRF-TOKEN"))},body:JSON.stringify(t),signal:o})).json()});r(this,"save",async(t,o=()=>{})=>{try{let e=!1,i={};if(this.hasFiles){const n=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(s.Cookies.get("XSRF-TOKEN"))},body:t});e=n.ok,i=JSON.parseable(await n.text())}else{const n=await s.Fetch(`/api/${this.path}`,{method:"POST",body:JSON.stringify(t)});e=n.status,i=n.result}if(!e)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:i.message,type:"success"}),o==null||o(),console.log(i),i}catch(e){return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:e.message,type:"danger"}),null}});r(this,"status",async({id:t,status:o})=>{try{const{status:e,result:i}=await s.Fetch(`/api/${this.path}/status`,{method:"PATCH",body:JSON.stringify({id:t,status:o})});if(!e)throw new Error((i==null?void 0:i.message)??"Ocurrio un error inesperado");return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:i.message,type:"success"}),!0}catch(e){return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:e.message,type:"danger"}),!1}});r(this,"boolean",async({id:t,field:o,value:e})=>{try{const{status:i,result:n}=await s.Fetch(`/api/${this.path}/boolean`,{method:"PATCH",body:JSON.stringify({id:t,field:o,value:e})});if(!i)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:n.message,type:"success"}),!0}catch(i){return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:i.message,type:"danger"}),!1}});r(this,"delete",async t=>{try{const{status:o,result:e}=await s.Fetch(`/api/${this.path}/${t}`,{method:"DELETE"});if(!o)throw new Error((e==null?void 0:e.message)??"Ocurrio un error inesperado");return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:e.message,type:"success"}),!0}catch(o){return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:o.message,type:"danger"}),!1}});r(this,"get",async(t={},o=[])=>{try{let e=`/api/${this.path}`;if(typeof t=="string"||typeof t=="number")e+=`/${t}`;else if(typeof t=="object"&&Object.keys(t).length>0){const n=new URLSearchParams(t).toString();e+=`?${n}`}if(o.length>0){const n=o.join(",");e+=`${e.includes("?")?"&":"?"}with=${n}`}const i=await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(s.Cookies.get("XSRF-TOKEN"))}});if(!i.ok)throw new Error(`Error ${i.status}: ${i.statusText}`);return await i.json()}catch(e){return this.enableNotifications&&s.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:e.message,type:"danger"}),null}})}withNotifications(){return this.enableNotifications=!0,this}withoutNotifications(){return this.enableNotifications=!1,this}setNotifications(t){return this.enableNotifications=t,this}}export{u as B};
