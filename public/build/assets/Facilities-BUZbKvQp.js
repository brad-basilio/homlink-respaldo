import{j as t}from"./RequirementCard-DEdD30eg.js";import{r}from"./index-RYns6xqu.js";import{C as ee,e as se,s as te,D as _,l as le,h as B,O as ne}from"./CreateReactScript-C-mUikVe.js";import{c as ie}from"./ReactAppend-vpV7VTGG.js";import{r as C}from"./DxBox-DZgBbgD6.js";import{S as re}from"./sweetalert2.all-DJo0UVK6.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./index-CXU7o9CY.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./Results-CoLI09XT.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const S=new ne,oe=()=>{const[E,d]=r.useState([]),x=r.useRef(),g=r.useRef(),v=r.useRef(),j=r.useRef(),N=r.useRef(),y=r.useRef(),[w,h]=r.useState([]),D=r.useRef(),[o,f]=r.useState([{value:""}]),[a,c]=r.useState([{value:""}]),[m,p]=r.useState([{value:""}]),[u,b]=r.useState([{value:""}]),[R,T]=r.useState(!1),U=e=>{const l=Array.from(e.target.files).map(i=>({file:i,url:URL.createObjectURL(i),isNew:!0}));h(i=>[...i,...l])},F=e=>{h(s=>s.filter((l,i)=>i!==e))},A=()=>{f([...o,{value:""}])},G=(e,s)=>{const l=[...o];l[e].value=s,f(l)},I=e=>{if(o.length<=1)return;const s=o.filter((l,i)=>i!==e);setCharacteristics(s)},O=()=>{c([...a,{value:""}])},P=(e,s)=>{const l=[...a];l[e].value=s,c(l)},J=e=>{if(a.length<=1)return;const s=a.filter((l,i)=>i!==e);c(s)},L=()=>{p([...m,{value:""}])},M=(e,s)=>{const l=[...m];l[e].value=s,p(l)},W=e=>{if(m.length<=1)return;const s=m.filter((l,i)=>i!==e);p(s)},q=()=>{b([...u,{value:""}])},H=(e,s)=>{const l=[...u];l[e].value=s,b(l)},z=e=>{if(u.length<=1)return;const s=u.filter((l,i)=>i!==e);c(s)},k=e=>{if(d(e||null),T(!!(e!=null&&e.id)),v.current.value=(e==null?void 0:e.id)||"",j.current.value=(e==null?void 0:e.title)||"",N.current.value=(e==null?void 0:e.description)||"",e!=null&&e.gallery){console.log(e==null?void 0:e.gallery);const s=e.gallery.map(l=>({url:`/api/facility/media/${l}`,isNew:!1}));h(s)}else h([]);e!=null&&e.ubications&&e.ubications.length>0?f(e.ubications.map(s=>({value:s}))):f([{value:""}]),e!=null&&e.phones&&e.phones.length>0?c(e.phones.map(s=>({value:s}))):c([{value:""}]),e!=null&&e.emails&&e.emails.length>0?p(e.emails.map(s=>({value:s}))):p([{value:""}]),e!=null&&e.business_hours&&e.business_hours.length>0?b(e.business_hours.map(s=>({value:s}))):b([{value:""}]),y.current.value=(e==null?void 0:e.link)??"",$(g.current).modal("show")},K=async e=>{e.preventDefault();const s=new FormData;s.append("title",j.current.value),s.append("description",N.current.value),s.append("link",y.current.value),R&&s.append("id",v.current.value),w.filter(n=>n.isNew).forEach((n,Z)=>{s.append(`gallery[${Z}]`,n.file)});const l=w.filter(n=>!n.isNew).map(n=>n.url.split("/").pop());s.append("existing_gallery",JSON.stringify(l));const i=o.map(n=>n.value.trim()).filter(n=>n.length>0);s.append("ubications",JSON.stringify(i));const V=a.map(n=>n.value.trim()).filter(n=>n.length>0);s.append("phones",JSON.stringify(V));const X=m.map(n=>n.value.trim()).filter(n=>n.length>0);s.append("emails",JSON.stringify(X));const Y=u.map(n=>n.value.trim()).filter(n=>n.length>0);s.append("business_hours",JSON.stringify(Y)),await S.save(s)&&($(x.current).dxDataGrid("instance").refresh(),$(g.current).modal("hide"),h([]),f([{value:""}]),c([{value:""}]),p([{value:""}]),b([{value:""}]))},Q=async e=>{const{isConfirmed:s}=await re.fire({title:"Eliminar Sede",text:"¿Estás seguro de eliminar esta sede?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!s||!await S.delete(e)||$(x.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(te,{gridRef:x,title:"Instalaciones",rest:S,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(x.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nueva sede",onClick:()=>k()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"title",caption:"Título",width:"200px"},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:s})=>{e.html(C(t.jsx("div",{className:"text-truncate",style:{maxWidth:"300px"},children:s.description})))}},{dataField:"ubications",caption:"Ubicaciones",cellTemplate:(e,{data:s})=>{s.ubications&&e.html(C(t.jsxs("ul",{className:"m-0 ps-3",style:{listStyle:"none"},children:[s.ubications.slice(0,2).map((l,i)=>t.jsx("li",{className:"text-truncate",style:{maxWidth:"250px"},children:t.jsxs("small",{children:["• ",l]})},i)),s.ubications.length>2&&t.jsx("li",{children:t.jsxs("small",{className:"text-muted",children:["+",s.ubications.length-2," ","más..."]})})]})))}},{dataField:"phones",caption:"Telefonos",cellTemplate:(e,{data:s})=>{s.phones&&e.html(C(t.jsxs("ul",{className:"m-0 ps-3",style:{listStyle:"none"},children:[s.phones.slice(0,2).map((l,i)=>t.jsx("li",{className:"text-truncate",style:{maxWidth:"250px"},children:t.jsxs("small",{children:["• ",l]})},i)),s.phones.length>2&&t.jsx("li",{children:t.jsxs("small",{className:"text-muted",children:["+",s.phones.length-2," ","más..."]})})]})))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{e.append(_({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>k(s)})),e.append(_({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>Q(s.id)}))}}]}),t.jsxs(le,{modalRef:g,title:R?"Editar Sede":"Nuevo Sede",onSubmit:K,size:"xl",children:[t.jsx("input",{ref:v,type:"hidden"}),t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsx(B,{eRef:j,label:"Sede",required:!0}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Descripción"}),t.jsx("textarea",{ref:N,className:"form-control",rows:4,required:!0})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Ubicaciones"}),o.map((e,s)=>t.jsxs("div",{className:"input-group mb-2",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Calle Chiclayo 723",value:e.value,onChange:l=>G(s,l.target.value)}),t.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>I(s),disabled:o.length<=1,children:t.jsx("i",{className:"fas fa-times"})})]},s)),t.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:A,children:[t.jsx("i",{className:"fas fa-plus me-1"})," Agregar Ubicación"]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Teléfonos"}),a.map((e,s)=>t.jsxs("div",{className:"input-group mb-2",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: 976 953 599",value:e.value,onChange:l=>P(s,l.target.value)}),t.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>J(s),disabled:a.length<=1,children:t.jsx("i",{className:"fas fa-times"})})]},s)),t.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:O,children:[t.jsx("i",{className:"fas fa-plus me-1"})," Agregar Teléfono"]})]})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Correos"}),m.map((e,s)=>t.jsxs("div",{className:"input-group mb-2",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: info-miraflores@nopain.com.pe",value:e.value,onChange:l=>M(s,l.target.value)}),t.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>W(s),disabled:m.length<=1,children:t.jsx("i",{className:"fas fa-times"})})]},s)),t.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:L,children:[t.jsx("i",{className:"fas fa-plus me-1"})," Agregar Correo"]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Horarios de Atención"}),u.map((e,s)=>t.jsxs("div",{className:"input-group mb-2",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Lunes a viernes: 8:00 am a 8:00 pm",value:e.value,onChange:l=>H(s,l.target.value)}),t.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>z(s),disabled:u.length<=1,children:t.jsx("i",{className:"fas fa-times"})})]},s)),t.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:q,children:[t.jsx("i",{className:"fas fa-plus me-1"})," Agregar Horas de negocio"]})]}),t.jsx(B,{type:"url",eRef:y,label:"Link"}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Galería de imágenes"}),t.jsx("input",{type:"file",ref:D,multiple:!0,accept:"image/*",onChange:U,className:"form-control"}),t.jsx("div",{className:"d-flex flex-wrap gap-2 mt-2",children:w.map((e,s)=>t.jsxs("div",{className:"position-relative",style:{width:"100px",height:"100px"},children:[t.jsx("img",{src:e.url,alt:"Preview",className:"img-thumbnail h-100 w-100 object-fit-cover"}),t.jsx("button",{type:"button",className:"btn btn-danger btn-xs position-absolute top-0 end-0",onClick:()=>F(s),children:"×"})]},s))})]})]})]})]})]})};ee((E,d)=>{ie(E).render(t.jsx(se,{...d,title:"Sedes",children:t.jsx(oe,{...d})}))});
