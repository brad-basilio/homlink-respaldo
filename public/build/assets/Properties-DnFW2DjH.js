import{j as e}from"./RequirementCard-DEdD30eg.js";import{r as i}from"./index-RYns6xqu.js";import{c as Ke}from"./ReactAppend-vpV7VTGG.js";import{C as Qe,e as We,s as Xe,R as N,l as Ze,h as f,j as Ye,o as oe,ah as ea}from"./CreateReactScript-C-mUikVe.js";import{S as g}from"./sweetalert2.all-DJo0UVK6.js";import{r as aa}from"./DxBox-DZgBbgD6.js";import"./index-CXU7o9CY.js";import"./Filter-BDLE8FWR.js";import"./axios-B4uVmeYG.js";import"./TippyButton-Duhaw_sS.js";import"./DataGrid-Cd7cnf9r.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./MenuItem-CBKDeUjr.js";import"./Results-CoLI09XT.js";import"./TinyMCEFormGroup-TcwoFScW.js";import"./index-DNUR7M9R.js";import"./Detail-BKcVR7Sx.js";import"./index-SDlHnhXR.js";import"./HomeSeccionBlog-CZ04iwe8.js";import"./CarruselBrands-Chpi1Apc.js";import"./Strengths-8rnVxSkq.js";import"./ModalAppointment-BjEduSb5.js";import"./CallToAction-3RvJBMpr.js";import"./WeCupSection-CkKcxXUy.js";import"./BlurText-Cr9yZ_QA.js";import"./Supplies-DJwkpyzw.js";import"./Banner-CXqQ-nCn.js";import"./HeroSecctionEmpresa-Bs7Po8J9.js";import"./WhatsAppModal-BCTi89gL.js";const Y=new ea,sa=({feature:m,index:h,onUpdate:w,onRemove:k,type:c,canRemove:S,amenities:A,services:P,characteristics:j,houseRules:u,addAmenity:b,addService:_,addCharacteristic:E,addHouseRule:T,propertyIcons:F})=>{const x=(n,v)=>{w(h,n,v)},B=()=>{switch(c){case"amenity":return"fas fa-wifi";case"service":return"fas fa-concierge-bell";case"characteristic":return"fas fa-home";case"houseRule":return"fas fa-gavel";default:return"fas fa-star"}},y=()=>{switch(c){case"amenity":return"Amenidad";case"service":return"Servicio";case"characteristic":return"Característica";case"houseRule":return"Regla";default:return"Elemento"}},O=()=>{switch(c){case"amenity":return A;case"service":return P;case"characteristic":return j;case"houseRule":return u;default:return[]}},q=()=>{switch(c){case"amenity":return b;case"service":return _;case"characteristic":return E;case"houseRule":return T;default:return()=>{}}},I=()=>F.filter(n=>n.category===c),R=n=>{if(n.id)return $(aa(e.jsxs("span",{children:[e.jsx("i",{className:`${n.id} me-2`}),n.text]})))};return e.jsxs("div",{className:"card border shadow-sm h-100",children:[e.jsx("div",{className:"card-header bg-transparent border-bottom-0 pb-0",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("h6",{className:"card-title mb-0",children:[e.jsx("i",{className:B()+" me-2"}),y()," ",h+1]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger rounded-circle d-flex align-items-center justify-content-center",onClick:()=>k(h),disabled:!S,title:"Eliminar",style:{width:"30px",height:"30px"},children:e.jsx("i",{className:"fas fa-times"})})]})}),e.jsxs("div",{className:"card-body pt-2",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6 mb-3",children:e.jsx(f,{label:"Nombre",value:m.name||"",onChange:n=>x("name",n.target.value),placeholder:"Ingresa el nombre..."})}),e.jsx("div",{className:"col-lg-6 mb-3",children:e.jsxs(oe,{label:"Icono",value:m.icon||"",onChange:n=>x("icon",n.target.value),templateResult:R,templateSelection:R,dropdownParent:"#principal-container",children:[e.jsx("option",{value:"",children:"Seleccionar icono..."}),I().map((n,v)=>e.jsx("option",{value:n.id,children:n.name},v))]})})]}),(c==="service"||c==="characteristic")&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:c==="characteristic"?"Valor":"Descripción"}),e.jsx("textarea",{className:"form-control",rows:2,value:c==="characteristic"?m.value||"":m.description||"",onChange:n=>x(c==="characteristic"?"value":"description",n.target.value),placeholder:c==="characteristic"?"Valor de la característica...":"Describe el servicio..."})]}),c==="houseRule"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Texto de la regla"}),e.jsx("textarea",{className:"form-control",rows:2,value:m.text||"",onChange:n=>x("text",n.target.value),placeholder:"Texto de la regla..."})]}),c==="amenity"&&e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:m.available||!1,onChange:n=>x("available",n.target.checked),id:`amenity-${h}`}),e.jsx("label",{className:"form-check-label",htmlFor:`amenity-${h}`,children:"Disponible"})]})]}),e.jsx("div",{className:"card-footer bg-transparent border-top-0 pt-0",id:`feature-${c}-${h}`,children:h===O().length-1&&e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary w-100",onClick:q(),children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Agregar ",y()]})})]})},ra=()=>{const m=i.useRef(),h=i.useRef(),w=i.useRef(),k=i.useRef(),c=i.useRef(),S=i.useRef(),A=i.useRef(),P=i.useRef(),j=i.useRef(),u=i.useRef(),b=i.useRef(),_=i.useRef(),E=i.useRef(),T=i.useRef(),F=i.useRef(),x=i.useRef(),B=i.useRef(),y=i.useRef(),O=i.useRef(),q=i.useRef(),I=i.useRef(),R=i.useRef(),n=i.useRef(),v=i.useRef(),me=i.useRef(),[ne,be]=i.useState(!1),[ee,M]=i.useState([]),[ge,xe]=i.useState([]),[G,ce]=i.useState([]),[ve,je]=i.useState([]),[z,de]=i.useState([]),[H,U]=i.useState([]),[L,ae]=i.useState(""),[Ne,V]=i.useState(""),[ia,J]=i.useState(""),[C,K]=i.useState([{name:"",icon:"",available:!0}]),[ta,we]=i.useState([{name:"",description:"",icon:"",available:!0}]),[la,ye]=i.useState([{name:"",value:"",icon:""}]),[oa,Re]=i.useState([{text:"",icon:"fas fa-info-circle"}]),Ce=[{id:"wifi",label:"WiFi",icon:"fa-wifi"},{id:"tv",label:"TV",icon:"fa-tv"},{id:"kitchen",label:"Cocina",icon:"fa-utensils"},{id:"washing_machine",label:"Lavadora",icon:"fa-tshirt"},{id:"parking",label:"Estacionamiento",icon:"fa-car"},{id:"air_conditioning",label:"Aire acondicionado",icon:"fa-snowflake"},{id:"heating",label:"Calefacción",icon:"fa-fire"},{id:"pool",label:"Piscina",icon:"fa-swimming-pool"},{id:"gym",label:"Gimnasio",icon:"fa-dumbbell"},{id:"balcony",label:"Balcón",icon:"fa-building"},{id:"garden",label:"Jardín",icon:"fa-leaf"},{id:"pet_friendly",label:"Pet Friendly",icon:"fa-paw"},{id:"elevator",label:"Ascensor",icon:"fa-elevator"},{id:"terrace",label:"Terraza",icon:"fa-home"},{id:"bbq",label:"Parrilla/BBQ",icon:"fa-fire-burner"},{id:"security",label:"Seguridad 24h",icon:"fa-shield-alt"}],De=[{id:"cleaning",label:"Servicio de limpieza",icon:"fa-broom"},{id:"laundry",label:"Servicio de lavandería",icon:"fa-tshirt"},{id:"transport",label:"Transporte",icon:"fa-car"},{id:"breakfast",label:"Desayuno incluido",icon:"fa-coffee"},{id:"concierge",label:"Conserje",icon:"fa-concierge-bell"},{id:"grocery",label:"Servicio de compras",icon:"fa-shopping-basket"},{id:"room_service",label:"Room service",icon:"fa-bell"},{id:"spa",label:"Servicio de spa",icon:"fa-spa"},{id:"baby_sitting",label:"Cuidado de niños",icon:"fa-baby"},{id:"tour_guide",label:"Guía turístico",icon:"fa-map"},{id:"cooking",label:"Servicio de cocina",icon:"fa-utensils"},{id:"maintenance",label:"Mantenimiento 24h",icon:"fa-tools"}],ke=[{id:"modern",label:"Moderno",icon:"fa-gem"},{id:"luxury",label:"Lujo",icon:"fa-crown"},{id:"historic",label:"Histórico",icon:"fa-landmark"},{id:"city_view",label:"Vista a la ciudad",icon:"fa-city"},{id:"ocean_view",label:"Vista al mar",icon:"fa-water"},{id:"mountain_view",label:"Vista a la montaña",icon:"fa-mountain"},{id:"quiet",label:"Zona tranquila",icon:"fa-volume-mute"},{id:"central",label:"Ubicación central",icon:"fa-map-marker-alt"},{id:"new_construction",label:"Construcción nueva",icon:"fa-hammer"},{id:"renovated",label:"Recién renovado",icon:"fa-paint-roller"},{id:"furnished",label:"Completamente amueblado",icon:"fa-couch"},{id:"spacious",label:"Espacioso",icon:"fa-expand-arrows-alt"}],Se=[{id:"no_pets",label:"No mascotas",icon:"fa-ban"},{id:"no_smoking",label:"No fumar",icon:"fa-smoking-ban"},{id:"no_parties",label:"No fiestas",icon:"fa-volume-off"},{id:"quiet_hours",label:"Horas de silencio 22:00-08:00",icon:"fa-clock"},{id:"clean_up",label:"Mantener limpio",icon:"fa-broom"},{id:"no_shoes",label:"Sin zapatos en interiores",icon:"fa-shoe-prints"},{id:"check_in_time",label:"Check-in: 15:00-22:00",icon:"fa-key"},{id:"check_out_time",label:"Check-out: antes de 11:00",icon:"fa-door-open"},{id:"max_guests",label:"Respetar número máximo",icon:"fa-users"},{id:"no_unregistered",label:"No huéspedes no registrados",icon:"fa-user-slash"},{id:"responsible_use",label:"Uso responsable",icon:"fa-handshake"},{id:"report_issues",label:"Reportar problemas",icon:"fa-exclamation-triangle"}],[Q,se]=i.useState([]),[W,re]=i.useState([]),[X,ie]=i.useState([]),[Z,te]=i.useState([]);i.useEffect(()=>{Pe(),_e()},[]),i.useEffect(()=>{console.log("Provinces state cambió:",z),console.log("Cantidad de provincias:",z.length),u.current&&z.length>0&&(console.log("Actualizando select2 de provincia..."),$(u.current).trigger("change.select2"),setTimeout(()=>{Ae()},200))},[z]),i.useEffect(()=>{console.log("Districts state cambió:",H),console.log("Cantidad de distritos:",H.length),b.current&&H.length>0&&(console.log("Actualizando select2 de distrito..."),$(b.current).trigger("change.select2"))},[H]);const Ae=()=>{if(u.current){console.log("HTML del select de provincia:",u.current.outerHTML),console.log("Opciones del select:",u.current.options.length);for(let a=0;a<u.current.options.length;a++)console.log(`Opción ${a}:`,u.current.options[a].value,"-",u.current.options[a].text)}},Pe=async()=>{try{const s=await(await fetch("/property-icons.json")).json();xe(s)}catch(a){console.error("Error loading property icons:",a)}},_e=async()=>{try{console.log("Cargando datos de ubigeo...");const s=await(await fetch("/ubigeo.json?"+new Date().getTime())).json();console.log("Datos ubigeo cargados:",s.length,"registros"),console.log("Primer registro:",s[0]),console.log("Estructura del primer registro:",Object.keys(s[0])),ce(s);const r=[...new Set(s.map(o=>o.departamento?o.departamento.trim():"").filter(o=>o.length>0))].sort();console.log("Departamentos únicos extraídos:",r),console.log("Total departamentos:",r.length),je(r)}catch(a){console.error("Error loading ubigeo data:",a)}},ue=async a=>{if(console.log("=== CAMBIO DE DEPARTAMENTO ==="),console.log("Departamento seleccionado:",a),console.log("ubigeoData length:",G.length),ae(a),V(""),J(""),u.current&&$(u.current).val("").trigger("change.select2"),b.current&&$(b.current).val("").trigger("change.select2"),a&&a.trim()){let s=G;if(G.length===0){console.log("ubigeoData está vacío, intentando recargar...");try{const p=await(await fetch("/ubigeo.json")).json();console.log("Datos recargados:",p.length,"registros"),s=p,ce(p)}catch(d){console.error("Error recargando datos:",d),de([]),U([]);return}}const r=a.trim();console.log("Departamento después de trim:",r);const o=s.slice(0,5).map(d=>d.departamento);console.log("Primeros 5 departamentos en los datos:",o);const t=s.filter(d=>d.departamento&&d.departamento.trim()===r);console.log("Datos filtrados por departamento:",t.length),console.log("Primeros 3 registros filtrados:",t.slice(0,3)),t.length===0&&(console.log("⚠️ NO SE ENCONTRARON DATOS para departamento:",r),console.log("Departamentos únicos disponibles:",[...new Set(s.map(d=>d.departamento))]));const l=new Set(t.map(d=>d.provincia?d.provincia.trim():"").filter(d=>d.length>0));console.log("Provincias set:",l);const D=[...l].sort();console.log("Provincias finales:",D),de(D),setTimeout(()=>{console.log("Estado de provinces después de 100ms:",D)},100)}else de([]);U([]),console.log("=== FIN CAMBIO DEPARTAMENTO ===")},pe=async(a,s=null)=>{console.log("=== CAMBIO DE PROVINCIA ==="),console.log("Provincia seleccionada:",a);const r=s||L;if(console.log("Departamento a usar:",r),console.log("selectedDepartment del estado:",L),console.log("ubigeoData length:",G.length),V(a),J(""),b.current&&$(b.current).val("").trigger("change.select2"),a&&a.trim()&&r&&r.trim()){let o=G;if(G.length===0){console.log("ubigeoData está vacío en handleProvinceChange, intentando recargar...");try{const le=await(await fetch("/ubigeo.json?"+new Date().getTime())).json();console.log("Datos recargados para provincia:",le.length,"registros"),console.log("Primer registro:",le[0]),o=le,ce(le)}catch(p){console.error("Error recargando datos en handleProvinceChange:",p),U([]);return}}const t=a.trim(),l=r.trim();console.log("Buscando distritos para:",{departmentTrimmed:l,provinceTrimmed:t}),console.log("Datos disponibles para filtrar:",o.length,"registros");const D=o.filter(p=>p.departamento&&p.departamento.trim()===l&&p.provincia&&p.provincia.trim()===t);console.log("Registros filtrados por depto y provincia:",D.length),console.log("Primeros 3 registros filtrados:",D.slice(0,3));const d=D.map(p=>p.distrito?p.distrito.trim():"").filter(p=>p.length>0).sort();console.log("Distritos encontrados:",d),console.log("Cantidad de distritos:",d.length),U(d)}else console.log("❌ Condición no cumplida:"),console.log("  - province:",a),console.log("  - province.trim():",a?a.trim():"N/A"),console.log("  - currentDepartment:",r),console.log("  - currentDepartment.trim():",r?r.trim():"N/A"),U([]);console.log("=== FIN CAMBIO PROVINCIA ===")},Ee=a=>{J(a),console.log("Distrito seleccionado:",a)},$e=a=>{const s=Array.from(a.target.files);M(r=>[...r,...s])},Te=a=>{a.preventDefault();const s=Array.from(a.dataTransfer.files);M(r=>[...r,...s])},Fe=a=>{a.preventDefault()},Be=a=>{M(s=>s.filter((r,o)=>o!==a))},Oe=a=>{se(s=>s.includes(a)?s.filter(r=>r!==a):[...s,a])},qe=a=>{re(s=>s.includes(a)?s.filter(r=>r!==a):[...s,a])},Ie=a=>{ie(s=>s.includes(a)?s.filter(r=>r!==a):[...s,a])},Ge=a=>{te(s=>s.includes(a)?s.filter(r=>r!==a):[...s,a])},Me=()=>{K([...C,{name:"",icon:"",available:!0}])},ze=i.useCallback((a,s,r)=>{K(o=>o.map((t,l)=>l===a?{...t,[s]:r}:t))},[]),He=a=>{C.length>1&&K(C.filter((s,r)=>r!==a))};i.useCallback((a,s,r)=>{we(o=>o.map((t,l)=>l===a?{...t,[s]:r}:t))},[]),i.useCallback((a,s,r)=>{ye(o=>o.map((t,l)=>l===a?{...t,[s]:r}:t))},[]),i.useCallback((a,s,r)=>{Re(o=>o.map((t,l)=>l===a?{...t,[s]:r}:t))},[]);const he=async a=>{var s;if(be(!!a),a){w.current.value=a.id||"",k.current.value=a.title||"",c.current.value="Airbnb",S.current.value=a.price_per_night||"",A.current.value=a.currency||"PEN",P.current.value=a.address||"",_.current.value=a.postal_code||"",E.current.value=a.external_link||"",a.amenities&&Array.isArray(a.amenities)?se(a.amenities):se([]),a.services&&Array.isArray(a.services)?re(a.services):re([]),a.characteristics&&Array.isArray(a.characteristics)?ie(a.characteristics):ie([]),a.house_rules&&Array.isArray(a.house_rules)?te(a.house_rules):te([]),a.department&&(ae(a.department),await ue(a.department),$(j.current).val(a.department).trigger("change"),a.province&&(V(a.province),await pe(a.province,a.department),setTimeout(()=>{$(u.current).val(a.province).trigger("change")},100),a.district&&(J(a.district),setTimeout(()=>{$(b.current).val(a.district).trigger("change")},200)))),T.current.value=a.bedrooms||1,F.current.value=a.bathrooms||1,x.current.value=a.max_guests||2,B.current.value=a.area_m2||"",y.current.value=a.latitude||"",O.current.value=a.longitude||"",q.current.value=a.description||"",I.current.value=a.short_description||"",R.current.value=a.rating||5,n.current.value=a.reviews_count||0,a.main_image&&(v.image.src=`/api/property/media/${a.main_image}`);const r=(s=a.amenities_custom)!=null&&s.length?a.amenities_custom:[{name:"",icon:"",available:!0}];K(r),M(a.gallery||[])}else w.current.value="",k.current.value="",c.current.value="Airbnb",S.current.value="",A.current.value="PEN",P.current.value="",_.current.value="",E.current.value="",se([]),re([]),ie([]),te([]),ae(""),V(""),$(j.current).val("").trigger("change"),$(u.current).val("").trigger("change"),$(b.current).val("").trigger("change"),T.current.value=1,F.current.value=1,x.current.value=2,B.current.value="",y.current.value="",O.current.value="",q.current.value="",I.current.value="",R.current.value=5,n.current.value=0,v.current.value="",v.image.src="/api/property/media/undefined",K([{name:"",icon:"",available:!0}]),M([]);$(h.current).modal("show")},Ue=async a=>{var r,o;a.preventDefault();const s=new FormData;if(w.current.value&&s.append("id",w.current.value),s.append("title",k.current.value),s.append("platform","Airbnb"),s.append("price_per_night",S.current.value),s.append("currency",A.current.value),s.append("address",P.current.value),s.append("postal_code",_.current.value),s.append("external_link",E.current.value),s.append("department",$(j.current).val()),s.append("province",$(u.current).val()),s.append("district",$(b.current).val()),s.append("bedrooms",T.current.value),s.append("bathrooms",F.current.value),s.append("max_guests",x.current.value),s.append("area_m2",B.current.value),s.append("latitude",y.current.value),s.append("longitude",O.current.value),s.append("description",q.current.value),s.append("short_description",I.current.value),s.append("rating",R.current.value),s.append("reviews_count",n.current.value),ne||s.append("admin_approved",!0),Q.forEach((t,l)=>{s.append(`amenities[${l}]`,t)}),W.forEach((t,l)=>{s.append(`services[${l}]`,t)}),X.forEach((t,l)=>{s.append(`characteristics[${l}]`,t)}),Z.forEach((t,l)=>{s.append(`house_rules[${l}]`,t)}),C.forEach((t,l)=>{s.append(`amenities_custom[${l}][name]`,t.name),s.append(`amenities_custom[${l}][icon]`,t.icon),s.append(`amenities_custom[${l}][available]`,t.available)}),(o=(r=v.current)==null?void 0:r.files)!=null&&o[0]&&s.append("main_image",v.current.files[0]),ee.forEach((t,l)=>{t instanceof File&&s.append("gallery[]",t)}),ne){const t=ee.filter(l=>typeof l=="string");s.append("existing_gallery",JSON.stringify(t))}try{await Y.save(s),$(h.current).modal("hide"),$(m.current).dxDataGrid("instance").refresh(),g.fire({title:"Éxito",text:"Propiedad guardada correctamente",icon:"success"})}catch(t){console.error("Error saving property:",t),g.fire({title:"Error",text:"Error al guardar la propiedad",icon:"error"})}},fe=async({id:a,field:s,value:r})=>{try{await Y.boolean({id:a,field:s,value:r}),$(m.current).dxDataGrid("instance").refresh()}catch(o){console.error("Error updating property:",o)}},Le=async a=>{try{(await g.fire({title:"¿Aprobar propiedad?",text:"Esta propiedad será visible públicamente",icon:"question",showCancelButton:!0,confirmButtonColor:"#198754",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, aprobar",cancelButtonText:"Cancelar"})).isConfirmed&&(await Y.boolean({id:a,field:"admin_approved",value:!0}),$(m.current).dxDataGrid("instance").refresh(),g.fire({title:"Aprobada",text:"La propiedad ha sido aprobada exitosamente",icon:"success"}))}catch(s){console.error("Error approving property:",s),g.fire({title:"Error",text:"Error al aprobar la propiedad",icon:"error"})}},Ve=async a=>{var s;try{if((await g.fire({title:"¿Rechazar propiedad?",text:"Esta propiedad no será visible públicamente",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, rechazar",cancelButtonText:"Cancelar"})).isConfirmed){const t=await(await fetch("/api/admin/properties/reject",{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content")},body:JSON.stringify({id:a})})).json();if(t.status===200)$(m.current).dxDataGrid("instance").refresh(),g.fire({title:"Rechazada",text:"La propiedad ha sido rechazada",icon:"success"});else throw new Error(t.message)}}catch(r){console.error("Error rejecting property:",r),g.fire({title:"Error",text:"Error al rechazar la propiedad",icon:"error"})}},Je=async a=>{if((await g.fire({title:"¿Estás seguro?",text:"¿Estás seguro de eliminar esta propiedad?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await Y.delete(a),$(m.current).dxDataGrid("instance").refresh(),g.fire({title:"Éxito",text:"Propiedad eliminada correctamente",icon:"success"})}catch(r){console.error("Error deleting property:",r),g.fire({title:"Error",text:"Error al eliminar la propiedad",icon:"error"})}};return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx(Xe,{gridRef:m,title:"Propiedades",rest:Y,toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(m.current).dxDataGrid("instance").refresh()}}),a.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva Propiedad",hint:"Crear nueva propiedad",onClick:async()=>await he()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"main_image",caption:"Imagen",width:"80px",allowFiltering:!1,cellTemplate:(a,{data:s})=>{N(a,s.main_image?e.jsx("img",{src:`/api/property/media/${s.main_image}`,alt:"Propiedad",className:"rounded",style:{width:"60px",height:"40px",objectFit:"cover"}}):e.jsx("div",{className:"bg-secondary rounded d-flex align-items-center justify-content-center",style:{width:"60px",height:"40px"},children:e.jsx("i",{className:"fas fa-image text-white"})}))}},{dataField:"title",caption:"Título",width:"250px"},{dataField:"platform",caption:"Plataforma",width:"100px"},{dataField:"price_per_night",caption:"Precio/Noche",width:"120px",cellTemplate:(a,{data:s})=>{N(a,e.jsxs("span",{children:[s.currency," ",parseFloat(s.price_per_night||0).toFixed(2)]}))}},{dataField:"district",caption:"Ubicación",width:"150px",cellTemplate:(a,{data:s})=>{N(a,e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:s.district}),e.jsx("small",{className:"text-muted",children:s.department})]}))}},{dataField:"bedrooms",caption:"Dormitorios",width:"100px"},{dataField:"max_guests",caption:"Huéspedes",width:"100px"},{dataField:"rating",caption:"Rating",width:"80px",cellTemplate:(a,{data:s})=>{N(a,e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-star me-1"}),s.rating||0]}))}},{dataField:"active",caption:"Activo",dataType:"boolean",width:"100px",cellTemplate:(a,{data:s})=>{N(a,e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.active,onChange:r=>fe({id:s.id,field:"active",value:r.target.checked})})}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"100px",cellTemplate:(a,{data:s})=>{N(a,e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.featured,onChange:r=>fe({id:s.id,field:"featured",value:r.target.checked})})}))}},{dataField:"admin_approved",caption:"Aprobación",width:"140px",cellTemplate:(a,{data:s})=>{N(a,e.jsx("div",{className:"d-flex gap-1",children:s.admin_approved?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check me-1"}),"Aprobada"]}),e.jsx("button",{className:"btn btn-xs btn-outline-danger",onClick:()=>Ve(s.id),title:"Rechazar",children:e.jsx("i",{className:"fas fa-times"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-clock me-1"}),"Pendiente"]}),e.jsx("button",{className:"btn btn-xs btn-outline-success",onClick:()=>Le(s.id),title:"Aprobar",children:e.jsx("i",{className:"fas fa-check"})})]})}))},allowFiltering:!0,filterOperations:["="],lookup:{dataSource:[{value:!0,text:"Aprobada"},{value:!1,text:"Pendiente"}],valueExpr:"value",displayExpr:"text"}},{caption:"Acciones",width:"100px",cellTemplate:(a,{data:s})=>{N(a,e.jsxs("div",{className:"d-flex gap-1",children:[e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:async()=>await he(s),title:"Editar",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>Je(s.id),title:"Eliminar",children:e.jsx("i",{className:"fas fa-trash"})})]}))},allowFiltering:!1,allowExporting:!1}]})})})})}),e.jsx(Ze,{modalRef:h,title:ne?"Editar Propiedad":"Nueva Propiedad",onSubmit:Ue,size:"xl",children:e.jsxs("div",{className:"row",id:"principal-container",children:[e.jsx("input",{type:"hidden",ref:w}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-8",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-8 mb-3",children:e.jsx(f,{label:"Título de la propiedad",eRef:k,placeholder:"Ej: Apartamento moderno en Miraflores",required:!0})}),e.jsxs("div",{className:"col-lg-4 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Plataforma"}),e.jsxs("select",{className:"form-select",ref:c,required:!0,disabled:!0,children:[e.jsx("option",{value:"Airbnb",children:"Airbnb"}),e.jsx("option",{value:"Booking",children:"Booking.com"}),e.jsx("option",{value:"Vrbo",children:"Vrbo"}),e.jsx("option",{value:"HomeAway",children:"HomeAway"}),e.jsx("option",{value:"Otras",children:"Otras"})]})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(f,{label:"Precio por noche",eRef:S,type:"number",step:"0.01",min:"0",placeholder:"120.00",required:!0})}),e.jsxs("div",{className:"col-lg-2 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Moneda"}),e.jsxs("select",{className:"form-select",ref:A,disabled:!0,children:[e.jsx("option",{value:"PEN",children:"PEN"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(f,{label:"Dormitorios",eRef:T,type:"number",min:"1",placeholder:"1",required:!0})}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(f,{label:"Baños",eRef:F,type:"number",min:"1",placeholder:"1",required:!0})}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(f,{label:"Huéspedes máx.",eRef:x,type:"number",min:"1",placeholder:"2",required:!0})})]})]}),e.jsx("div",{className:"col-lg-4",children:e.jsx(Ye,{label:"Imagen principal",eRef:v,aspect:16/9})})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-images me-2"}),"Galería de Imágenes"]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Agregar imágenes a la galería"}),e.jsxs("div",{className:"border border-dashed border-primary rounded p-4 text-center",onDrop:Te,onDragOver:Fe,style:{minHeight:"120px"},children:[e.jsx("i",{className:"fas fa-cloud-upload-alt fa-3x text-primary mb-3"}),e.jsx("p",{className:"mb-2",children:"Arrastra las imágenes aquí o"}),e.jsx("input",{type:"file",ref:me,multiple:!0,accept:"image/*",onChange:$e,className:"d-none"}),e.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{var a;return(a=me.current)==null?void 0:a.click()},children:"Seleccionar Archivos"})]})]}),ee.length>0&&e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"row",children:ee.map((a,s)=>e.jsx("div",{className:"col-lg-2 col-md-3 col-sm-4 mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("img",{src:a instanceof File?URL.createObjectURL(a):`/api/property/media/${a}`,alt:`Galería ${s+1}`,className:"img-fluid rounded",style:{width:"100%",height:"100px",objectFit:"cover"}}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm position-absolute top-0 end-0 rounded-circle",style:{width:"25px",height:"25px",fontSize:"12px"},onClick:()=>Be(s),children:e.jsx("i",{className:"fas fa-times"})})]})},s))})})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-map-marker-alt me-2"}),"Ubicación"]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(f,{label:"Dirección completa",eRef:P,placeholder:"Av. Ricardo Palma 251",required:!0})}),e.jsx("div",{className:"col-lg-2 mb-3",children:e.jsx(f,{label:"Código Postal",eRef:_,placeholder:"15074"})}),e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx(f,{label:"Link de Airbnb (Para sincronizar fechas)",eRef:E,type:"url",placeholder:"https://www.airbnb.com/rooms/12345"}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-info-circle me-1"}),"Este enlace permite sincronizar automáticamente las fechas disponibles"]})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsxs(oe,{label:"Departamento",eRef:j,onChange:a=>{const s=a.target.value;ae(s),ue(s)},dropdownParent:"#principal-container",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),ve.map((a,s)=>e.jsx("option",{value:a,children:a},s))]})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsxs(oe,{label:"Provincia",eRef:u,onChange:a=>{const s=a.target.value;V(s);const r=j.current?$(j.current).val():L;console.log("🔍 Provincia onChange - Departamento actual:",r),console.log("🔍 Provincia onChange - selectedDepartment estado:",L),pe(s,r)},disabled:!L,dropdownParent:"#principal-container",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),z.map((a,s)=>e.jsx("option",{value:a,children:a},s))]})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsxs(oe,{label:"Distrito",eRef:b,onChange:a=>{const s=a.target.value;J(s),Ee(s)},disabled:!Ne,dropdownParent:"#principal-container",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),H.map((a,s)=>e.jsx("option",{value:a,children:a},s))]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(f,{label:"Área (m²)",eRef:B,type:"number",min:"1",placeholder:"60"})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(f,{label:"Latitud",eRef:y,type:"number",step:"0.000001",placeholder:"-12.1211"})}),e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(f,{label:"Longitud",eRef:O,type:"number",step:"0.000001",placeholder:"-77.0269"})})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-align-left me-2"}),"Descripción"]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Descripción completa"}),e.jsx("textarea",{className:"form-control",ref:q,rows:4,placeholder:"Describe detalladamente la propiedad...",required:!0})]}),e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Descripción corta"}),e.jsx("textarea",{className:"form-control",ref:I,rows:4,placeholder:"Resumen breve para listados..."})]})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-star me-2"}),"Amenidades Principales"]}),e.jsx("div",{className:"row",children:Ce.map((a,s)=>e.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:e.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${Q.includes(a.id)?"border-primary bg-light":"border-light hover:border-secondary"}`,onClick:()=>Oe(a.id),style:{cursor:"pointer"},children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("i",{className:`fas ${a.icon} fa-2x mb-2 ${Q.includes(a.id)?"text-primary":"text-muted"}`}),e.jsx("h6",{className:`mb-0 ${Q.includes(a.id)?"text-primary fw-bold":"text-dark"}`,children:a.label}),Q.includes(a.id)&&e.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:e.jsx("i",{className:"fas fa-check-circle text-success"})})]})})},a.id))}),e.jsxs("div",{className:"alert alert-info",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona las amenidades que tiene tu propiedad. Estas amenidades son las más comunes y aparecerán destacadas en los listados."]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-wifi me-2"}),"Amenidades Personalizadas"]}),e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle me-2"}),"Agrega amenidades adicionales que no estén en la lista principal."]}),e.jsx("div",{className:"row",children:C.map((a,s)=>e.jsx("div",{className:"col-lg-4 mb-3",children:e.jsx(sa,{feature:a,index:s,onUpdate:ze,onRemove:He,type:"amenity",canRemove:C.length>1,amenities:C,addAmenity:Me,propertyIcons:ge})},s))})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-concierge-bell me-2"}),"Servicios Principales"]}),e.jsx("div",{className:"row",children:De.map((a,s)=>e.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:e.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${W.includes(a.id)?"border-success bg-light":"border-light hover:border-secondary"}`,onClick:()=>qe(a.id),style:{cursor:"pointer"},children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("i",{className:`fas ${a.icon} fa-2x mb-2 ${W.includes(a.id)?"text-success":"text-muted"}`}),e.jsx("h6",{className:`mb-0 ${W.includes(a.id)?"text-success fw-bold":"text-dark"}`,children:a.label}),W.includes(a.id)&&e.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:e.jsx("i",{className:"fas fa-check-circle text-success"})})]})})},a.id))}),e.jsxs("div",{className:"alert alert-info",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona los servicios que ofreces a tus huéspedes."]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-star me-2"}),"Características Principales"]}),e.jsx("div",{className:"row",children:ke.map((a,s)=>e.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:e.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${X.includes(a.id)?"border-warning bg-light":"border-light hover:border-secondary"}`,onClick:()=>Ie(a.id),style:{cursor:"pointer"},children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("i",{className:`fas ${a.icon} fa-2x mb-2 ${X.includes(a.id)?"text-warning":"text-muted"}`}),e.jsx("h6",{className:`mb-0 ${X.includes(a.id)?"text-warning fw-bold":"text-dark"}`,children:a.label}),X.includes(a.id)&&e.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:e.jsx("i",{className:"fas fa-check-circle text-warning"})})]})})},a.id))}),e.jsxs("div",{className:"alert alert-info",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona las características que mejor describan tu propiedad."]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-list-check me-2"}),"Reglas de la Casa Principales"]}),e.jsx("div",{className:"row",children:Se.map((a,s)=>e.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:e.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${Z.includes(a.id)?"border-danger bg-light":"border-light hover:border-secondary"}`,onClick:()=>Ge(a.id),style:{cursor:"pointer"},children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("i",{className:`fas ${a.icon} fa-2x mb-2 ${Z.includes(a.id)?"text-danger":"text-muted"}`}),e.jsx("h6",{className:`mb-0 ${Z.includes(a.id)?"text-danger fw-bold":"text-dark"}`,children:a.label}),Z.includes(a.id)&&e.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:e.jsx("i",{className:"fas fa-check-circle text-danger"})})]})})},a.id))}),e.jsxs("div",{className:"alert alert-info",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona las reglas que los huéspedes deben seguir durante su estadía."]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("h5",{className:"border-bottom pb-2",children:[e.jsx("i",{className:"fas fa-star me-2"}),"Información Adicional"]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-3 mb-3",children:e.jsx(f,{label:"Rating",eRef:R,type:"number",step:"0.1",min:"1",max:"5",placeholder:"5.0"})}),e.jsx("div",{className:"col-lg-3 mb-3",children:e.jsx(f,{label:"Número de reseñas",eRef:n,type:"number",min:"0",placeholder:"0"})})]})]})]})})]})};Qe((m,h)=>{Ke(m).render(e.jsx(We,{...h,title:"Propiedades",children:e.jsx(ra,{...h})}))});
