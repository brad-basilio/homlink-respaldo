var j=Object.defineProperty;var v=(t,r,s)=>r in t?j(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var f=(t,r,s)=>(v(t,typeof r!="symbol"?r+"":r,s),s);import{j as i}from"./RequirementCard-DEdD30eg.js";import{r as n}from"./index-RYns6xqu.js";import{c as F}from"./ReactAppend-vpV7VTGG.js";import{B as w}from"./Base-4XzyVO90.js";import{C as S}from"./CreateReactScript-BuKYEKxn.js";import{T as E}from"./Table-CyG7yWBs.js";import{M as y}from"./Modal-1_SBF_XS.js";import{I as B}from"./InputFormGroup-B7mKwzkx.js";import{R as I}from"./ReactAppend-DPXaoPQG.js";import{D}from"./DxButton-CsjWvhyj.js";import{B as T}from"./Results-BBVbNL2k.js";import{S as A}from"./SelectFormGroup-CVn9r_7Q.js";import{S as C,a as G}from"./SetSelectValue-DXrntqGI.js";import"./index-CXU7o9CY.js";import"./tippy-react.esm-DYFqe69e.js";/* empty css              */import"./Logout-BlWggqgx.js";import"./main-Y8JAyXgE.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./useTranslation-CZbMeh78.js";import"./Filter-CpekYgBC.js";/* empty css               */class P extends T{constructor(){super(...arguments);f(this,"path","admin/formulas")}}const x=new P,k=({})=>{const t=n.useRef(),r=n.useRef(),s=n.useRef(),a=n.useRef(),l=n.useRef(),p=n.useRef(),[c,m]=n.useState(!1),R=e=>{e!=null&&e.id?m(!0):m(!1),s.current.value=(e==null?void 0:e.id)??"",a.current.value=(e==null?void 0:e.name)??"",l.current.value=(e==null?void 0:e.description)??"",G(p.current,e==null?void 0:e.supplies,"id","name"),$(r.current).modal("show")},h=async e=>{e.preventDefault();const o={id:s.current.value||void 0,name:a.current.value,description:l.current.value,supplies:$(p.current).val()};await x.save(o)&&($(t.current).dxDataGrid("instance").refresh(),$(r.current).modal("hide"))},u=[{id:"has_treatment",name:"Recibió tratamiento"},{id:"scalp_type",name:"Tipo de cuero cabelludo"},{id:"hair_type",name:"Tipo de cabello"},{id:"hair_goals",name:"Objetivos"}];return i.jsxs(i.Fragment,{children:[i.jsx(E,{gridRef:t,title:"Fórmulas",rest:x,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(t.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Step",width:"150px",lookup:{dataSource:u,valueExpr:"id",displayExpr:"name"}},{dataField:"description",caption:"Respuesta",width:"200px"},{dataField:"supplies.name",caption:"Ingredientes",allowFiltering:!1,cellTemplate:(e,{data:o})=>{I(e,i.jsx("div",{className:"d-flex gap-1",children:o.supplies.map((d,b)=>i.jsx("img",{src:`/api/supplies/media/${d.image}`,style:{width:"40px",backgroundColor:"#fff",border:"1px solid rgba(0,0,0,.125)",aspectRatio:5/4,objectFit:"contain",objectPosition:"center",borderRadius:"4px"},onError:g=>g.target.src="/assets/img/supplies/acido-salicilico.png"},b))}))}},{caption:"Acciones",width:"60px",cellTemplate:(e,{data:o})=>{e.css("text-overflow","unset"),e.append(D({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>R(o)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsx(y,{modalRef:r,title:c?"Editar fórmula":"Agregar fórmula",onSubmit:h,size:"md",children:i.jsxs("div",{id:"principal-container",children:[i.jsx("input",{ref:s,type:"hidden"}),i.jsx(A,{eRef:a,label:"Step",required:!0,dropdownParent:"#principal-container",col:"col-12",disabled:c,children:u.map((e,o)=>i.jsx("option",{value:e.id,children:e.name},o))}),i.jsx(B,{eRef:l,label:"Respuesta",required:!0}),i.jsx(C,{eRef:p,label:"Ingredientes",searchAPI:"/api/admin/supplies/paginate",searchBy:"name",required:!0,dropdownParent:"#principal-container",col:"col-12",multiple:!0})]})})]})};S((t,r)=>{F(t).render(i.jsx(w,{...r,title:"Fórmulas",children:i.jsx(k,{...r})}))});
