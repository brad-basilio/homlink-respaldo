var Ue=Object.defineProperty;var Ve=(c,m,f)=>m in c?Ue(c,m,{enumerable:!0,configurable:!0,writable:!0,value:f}):c[m]=f;var ne=(c,m,f)=>(Ve(c,typeof m!="symbol"?m+"":m,f),f);import{j as a}from"./RequirementCard-DEdD30eg.js";import{r as i}from"./index-RYns6xqu.js";import{c as Je}from"./ReactAppend-vpV7VTGG.js";import{B as Ke}from"./Base-DmQtm8t4.js";import{T as Qe}from"./Table-BTG--uQT.js";import{M as We}from"./Modal-IE2ysmSM.js";import{I as h}from"./InputFormGroup-B7mKwzkx.js";import{I as Xe}from"./ImageFormGroup-Csvj9Cte.js";import{S as ce}from"./SelectFormGroup-CVn9r_7Q.js";import{C as Ze}from"./CreateReactScript-BuKYEKxn.js";import{R as x}from"./ReactAppend-DPXaoPQG.js";import{B as Ye}from"./Results-BBVbNL2k.js";import{S as g}from"./sweetalert2.all-DJo0UVK6.js";import"./DxBox-DZgBbgD6.js";import"./index-CXU7o9CY.js";import"./tippy-react.esm-DYFqe69e.js";/* empty css              */import"./Logout-BlWggqgx.js";import"./main-Y8JAyXgE.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./useTranslation-CZbMeh78.js";import"./Filter-CpekYgBC.js";/* empty css               */class ea extends Ye{constructor(){super(...arguments);ne(this,"path","admin/properties");ne(this,"hasFiles",!0)}async getPublicProperties(f={}){try{const b=new URLSearchParams(f).toString();return await(await fetch(`/api/properties/public?${b}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}})).json()}catch(b){throw console.error("Error fetching public properties:",b),b}}}const F=new ea,aa=()=>{const c=i.useRef(),m=i.useRef(),f=i.useRef(),b=i.useRef(),B=i.useRef(),O=i.useRef(),q=i.useRef(),M=i.useRef(),j=i.useRef(),u=i.useRef(),p=i.useRef(),G=i.useRef(),I=i.useRef(),z=i.useRef(),H=i.useRef(),L=i.useRef(),U=i.useRef(),V=i.useRef(),J=i.useRef(),K=i.useRef(),Q=i.useRef(),W=i.useRef(),N=i.useRef(),de=i.useRef(),[ie,he]=i.useState(!1),[X,S]=i.useState([]),[sa,ge]=i.useState([]),[y,oe]=i.useState([]),[be,xe]=i.useState([]),[A,te]=i.useState([]),[w,E]=i.useState([]),[k,Z]=i.useState(""),[ve,_]=i.useState(""),[je,T]=i.useState(""),[Ne,le]=i.useState([{name:"",icon:"",available:!0}]),[ra,ye]=i.useState([{name:"",description:"",icon:"",available:!0}]),[ia,we]=i.useState([{name:"",value:"",icon:""}]),[oa,Re]=i.useState([{text:"",icon:"fas fa-info-circle"}]),De=[{id:"wifi",label:"WiFi",icon:"fa-wifi"},{id:"tv",label:"TV",icon:"fa-tv"},{id:"kitchen",label:"Cocina",icon:"fa-utensils"},{id:"washing_machine",label:"Lavadora",icon:"fa-tshirt"},{id:"parking",label:"Estacionamiento",icon:"fa-car"},{id:"air_conditioning",label:"Aire acondicionado",icon:"fa-snowflake"},{id:"heating",label:"Calefacción",icon:"fa-fire"},{id:"pool",label:"Piscina",icon:"fa-swimming-pool"},{id:"gym",label:"Gimnasio",icon:"fa-dumbbell"},{id:"balcony",label:"Balcón",icon:"fa-building"},{id:"garden",label:"Jardín",icon:"fa-leaf"},{id:"pet_friendly",label:"Pet Friendly",icon:"fa-paw"}],Ce=[{id:"cleaning",label:"Servicio de limpieza",icon:"fa-broom",description:"Limpieza diaria o semanal"},{id:"laundry",label:"Servicio de lavandería",icon:"fa-tshirt",description:"Lavado y planchado de ropa"},{id:"breakfast",label:"Desayuno incluido",icon:"fa-coffee",description:"Desayuno continental"},{id:"transport",label:"Transporte al aeropuerto",icon:"fa-plane",description:"Traslado desde/hacia el aeropuerto"},{id:"concierge",label:"Servicio de conserje",icon:"fa-concierge-bell",description:"Asistencia personalizada"},{id:"grocery",label:"Servicio de compras",icon:"fa-shopping-cart",description:"Compra de alimentos y productos"},{id:"tour_guide",label:"Guía turístico",icon:"fa-map-marked-alt",description:"Tours y recomendaciones locales"},{id:"babysitting",label:"Cuidado de niños",icon:"fa-baby",description:"Servicio de niñera"},{id:"massage",label:"Servicio de masajes",icon:"fa-spa",description:"Masajes relajantes"},{id:"chef",label:"Chef privado",icon:"fa-utensils",description:"Preparación de comidas"}],Pe=[{id:"ocean_view",label:"Vista al mar",icon:"fa-water",value:"Vista panorámica al océano"},{id:"mountain_view",label:"Vista a las montañas",icon:"fa-mountain",value:"Vista a las montañas"},{id:"city_view",label:"Vista a la ciudad",icon:"fa-city",value:"Vista urbana"},{id:"historic",label:"Edificio histórico",icon:"fa-landmark",value:"Patrimonio arquitectónico"},{id:"modern",label:"Diseño moderno",icon:"fa-gem",value:"Diseño contemporáneo"},{id:"luxury",label:"Propiedad de lujo",icon:"fa-crown",value:"Acabados premium"},{id:"eco_friendly",label:"Eco-amigable",icon:"fa-leaf",value:"Sostenible y ecológico"},{id:"quiet",label:"Zona tranquila",icon:"fa-volume-mute",value:"Ambiente silencioso"},{id:"central",label:"Ubicación céntrica",icon:"fa-map-marker-alt",value:"Centro de la ciudad"},{id:"beachfront",label:"Frente a la playa",icon:"fa-umbrella-beach",value:"Acceso directo a la playa"},{id:"renovated",label:"Recientemente renovado",icon:"fa-hammer",value:"Renovación reciente"},{id:"spacious",label:"Espacioso",icon:"fa-expand-arrows-alt",value:"Amplios espacios"}],Se=[{id:"no_smoking",label:"No se permite fumar",icon:"fa-smoking-ban",text:"Prohibido fumar en toda la propiedad"},{id:"no_pets",label:"No se permiten mascotas",icon:"fa-ban",text:"No se admiten animales domésticos"},{id:"no_parties",label:"No se permiten fiestas",icon:"fa-music",text:"Prohibidas las fiestas y eventos ruidosos"},{id:"quiet_hours",label:"Horas de silencio",icon:"fa-volume-mute",text:"Mantener silencio de 10 PM a 8 AM"},{id:"no_shoes",label:"No usar zapatos dentro",icon:"fa-shoe-prints",text:"Quitarse los zapatos al ingresar"},{id:"clean_up",label:"Mantener limpio",icon:"fa-broom",text:"Mantener la propiedad limpia y ordenada"},{id:"check_in_time",label:"Horario de check-in",icon:"fa-clock",text:"Check-in: 3:00 PM - 10:00 PM"},{id:"check_out_time",label:"Horario de check-out",icon:"fa-door-open",text:"Check-out antes de las 11:00 AM"},{id:"max_guests",label:"Límite de huéspedes",icon:"fa-users",text:"No exceder el número máximo de huéspedes"},{id:"energy_saving",label:"Ahorro de energía",icon:"fa-lightbulb",text:"Apagar luces y equipos al salir"}],[R,Y]=i.useState([]),[D,ee]=i.useState([]),[C,ae]=i.useState([]),[P,se]=i.useState([]);i.useEffect(()=>{Ee(),ke()},[]),i.useEffect(()=>{console.log("Provinces state cambió:",A),console.log("Cantidad de provincias:",A.length),u.current&&A.length>0&&(console.log("Actualizando select2 de provincia..."),$(u.current).trigger("change.select2"),setTimeout(()=>{Ae()},200))},[A]),i.useEffect(()=>{console.log("Districts state cambió:",w),console.log("Cantidad de distritos:",w.length),console.log("Distrito seleccionado actual:",je),p.current&&w.length>0&&(console.log("Actualizando select2 de distrito..."),$(p.current).trigger("change.select2"),setTimeout(()=>{if(p.current){console.log("Opciones del select de distrito:",p.current.options.length);for(let e=0;e<p.current.options.length;e++)console.log(`Distrito opción ${e}:`,p.current.options[e].value,"-",p.current.options[e].text)}},100))},[w]);const Ae=()=>{if(u.current){console.log("HTML del select de provincia:",u.current.outerHTML),console.log("Opciones del select:",u.current.options.length);for(let e=0;e<u.current.options.length;e++)console.log(`Opción ${e}:`,u.current.options[e].value,"-",u.current.options[e].text)}},Ee=async()=>{try{const s=await(await fetch("/property-icons.json")).json();ge(s)}catch(e){console.error("Error loading property icons:",e)}},ke=async()=>{try{console.log("Cargando datos de ubigeo...");const s=await(await fetch("/ubigeo.json?"+new Date().getTime())).json();console.log("Datos ubigeo cargados:",s.length,"registros"),console.log("Primer registro:",s[0]),console.log("Estructura del primer registro:",Object.keys(s[0])),oe(s);const r=[...new Set(s.map(l=>l.departamento?l.departamento.trim():"").filter(l=>l.length>0))].sort();console.log("Departamentos únicos extraídos:",r),console.log("Total departamentos:",r.length),xe(r)}catch(e){console.error("Error loading ubigeo data:",e)}},me=async e=>{if(console.log("=== CAMBIO DE DEPARTAMENTO ==="),console.log("Departamento seleccionado:",e),console.log("ubigeoData length:",y.length),Z(e),_(""),T(""),u.current&&$(u.current).val("").trigger("change.select2"),p.current&&$(p.current).val("").trigger("change.select2"),e&&e.trim()){let s=y;if(y.length===0){console.log("ubigeoData está vacío, intentando recargar...");try{const d=await(await fetch("/ubigeo.json")).json();console.log("Datos recargados:",d.length,"registros"),s=d,oe(d)}catch(n){console.error("Error recargando datos:",n),te([]),E([]);return}}const r=e.trim();console.log("Departamento después de trim:",r);const l=s.slice(0,5).map(n=>n.departamento);console.log("Primeros 5 departamentos en los datos:",l);const o=s.filter(n=>n.departamento&&n.departamento.trim()===r);console.log("Datos filtrados por departamento:",o.length),console.log("Primeros 3 registros filtrados:",o.slice(0,3)),o.length===0&&(console.log("⚠️ NO SE ENCONTRARON DATOS para departamento:",r),console.log("Departamentos únicos disponibles:",[...new Set(s.map(n=>n.departamento))]));const t=new Set(o.map(n=>n.provincia?n.provincia.trim():"").filter(n=>n.length>0));console.log("Provincias set:",t);const v=[...t].sort();console.log("Provincias finales:",v),te(v),setTimeout(()=>{console.log("Estado de provinces después de 100ms:",v)},100)}else te([]);E([]),console.log("=== FIN CAMBIO DEPARTAMENTO ===")},pe=async(e,s=null)=>{console.log("=== CAMBIO DE PROVINCIA ==="),console.log("Provincia seleccionada:",e);const r=s||k;if(console.log("Departamento a usar:",r),console.log("selectedDepartment del estado:",k),console.log("ubigeoData length:",y.length),_(e),T(""),p.current&&$(p.current).val("").trigger("change.select2"),e&&e.trim()&&r&&r.trim()){let l=y;if(y.length===0){console.log("ubigeoData está vacío en handleProvinceChange, intentando recargar...");try{const re=await(await fetch("/ubigeo.json?"+new Date().getTime())).json();console.log("Datos recargados para provincia:",re.length,"registros"),console.log("Primer registro:",re[0]),l=re,oe(re)}catch(d){console.error("Error recargando datos en handleProvinceChange:",d),E([]);return}}const o=e.trim(),t=r.trim();console.log("Buscando distritos para:",{departmentTrimmed:t,provinceTrimmed:o}),console.log("Datos disponibles para filtrar:",l.length,"registros");const v=l.filter(d=>d.departamento&&d.departamento.trim()===t&&d.provincia&&d.provincia.trim()===o);console.log("Registros filtrados por depto y provincia:",v.length),console.log("Primeros 3 registros filtrados:",v.slice(0,3));const n=v.map(d=>d.distrito?d.distrito.trim():"").filter(d=>d.length>0).sort();console.log("Distritos encontrados:",n),console.log("Cantidad de distritos:",n.length),E(n)}else console.log("❌ Condición no cumplida:"),console.log("  - province:",e),console.log("  - province.trim():",e?e.trim():"N/A"),console.log("  - currentDepartment:",r),console.log("  - currentDepartment.trim():",r?r.trim():"N/A"),E([]);console.log("=== FIN CAMBIO PROVINCIA ===")},_e=e=>{T(e),console.log("Distrito seleccionado:",e)},Te=e=>{const s=Array.from(e.target.files);S(r=>[...r,...s])},$e=e=>{e.preventDefault();const s=Array.from(e.dataTransfer.files);S(r=>[...r,...s])},Fe=e=>{e.preventDefault()},Be=e=>{S(s=>s.filter((r,l)=>l!==e))},Oe=e=>{Y(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])},qe=e=>{ee(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])},Me=e=>{ae(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])},Ge=e=>{se(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])};i.useCallback((e,s,r)=>{le(l=>l.map((o,t)=>t===e?{...o,[s]:r}:o))},[]),i.useCallback((e,s,r)=>{ye(l=>l.map((o,t)=>t===e?{...o,[s]:r}:o))},[]),i.useCallback((e,s,r)=>{we(l=>l.map((o,t)=>t===e?{...o,[s]:r}:o))},[]),i.useCallback((e,s,r)=>{Re(l=>l.map((o,t)=>t===e?{...o,[s]:r}:o))},[]);const ue=async e=>{var s;if(he(!!e),e){f.current.value=e.id||"",b.current.value=e.title||"",B.current.value="Airbnb",O.current.value=e.price_per_night||"",q.current.value=e.currency||"PEN",M.current.value=e.address||"",G.current.value=e.postal_code||"",I.current.value=e.external_link||"",console.log("Datos completos recibidos:",e),e.amenities&&Array.isArray(e.amenities)?(console.log("Amenidades recibidas:",e.amenities),Y(e.amenities)):Y([]),e.services&&Array.isArray(e.services)?(console.log("Servicios recibidos:",e.services),ee(e.services)):ee([]),e.characteristics&&Array.isArray(e.characteristics)?(console.log("Características recibidas:",e.characteristics),ae(e.characteristics)):ae([]),e.house_rules&&Array.isArray(e.house_rules)?(console.log("Reglas recibidas:",e.house_rules),se(e.house_rules)):se([]),e.department&&(console.log("🔧 Cargando ubicación - Departamento:",e.department),Z(e.department),await me(e.department),setTimeout(()=>{$(j.current).val(e.department).trigger("change")},50),e.province&&(console.log("🔧 Cargando ubicación - Provincia:",e.province),_(e.province),await pe(e.province,e.department),setTimeout(()=>{$(u.current).val(e.province).trigger("change")},150),e.district&&(console.log("🔧 Cargando ubicación - Distrito:",e.district),T(e.district),setTimeout(()=>{console.log("🔧 Estableciendo distrito en select:",e.district),console.log("🔧 Distritos disponibles:",w),$(p.current).val(e.district).trigger("change")},300)))),z.current.value=e.bedrooms||1,H.current.value=e.bathrooms||1,L.current.value=e.max_guests||2,U.current.value=e.area_m2||"",V.current.value=e.latitude||"",J.current.value=e.longitude||"",K.current.value=e.description||"",Q.current.value=e.short_description||"",W.current.value=e.rating||5,e.main_image&&(N.image.src=`/api/property/media/${e.main_image}`);const r=(s=e.amenities_custom)!=null&&s.length?e.amenities_custom:[{name:"",icon:"",available:!0}];le(r),S(e.gallery||[])}else f.current.value="",b.current.value="",B.current.value="Airbnb",O.current.value="",q.current.value="PEN",M.current.value="",G.current.value="",I.current.value="",Y([]),ee([]),ae([]),se([]),Z(""),_(""),$(j.current).val("").trigger("change"),$(u.current).val("").trigger("change"),$(p.current).val("").trigger("change"),z.current.value=1,H.current.value=1,L.current.value=2,U.current.value="",V.current.value="",J.current.value="",K.current.value="",Q.current.value="",W.current.value=5,N.current.value="",N.image.src="/api/property/media/undefined",le([{name:"",icon:"",available:!0}]),S([]);$(m.current).modal("show")},Ie=async e=>{var r,l;e.preventDefault();const s=new FormData;if(f.current.value&&s.append("id",f.current.value),s.append("title",b.current.value),s.append("platform","Airbnb"),s.append("price_per_night",O.current.value),s.append("currency",q.current.value),s.append("address",M.current.value),s.append("postal_code",G.current.value),s.append("external_link",I.current.value),s.append("department",$(j.current).val()),s.append("province",$(u.current).val()),s.append("district",$(p.current).val()),s.append("bedrooms",z.current.value),s.append("bathrooms",H.current.value),s.append("max_guests",L.current.value),s.append("area_m2",U.current.value),s.append("latitude",V.current.value),s.append("longitude",J.current.value),s.append("description",K.current.value),s.append("short_description",Q.current.value),s.append("rating",W.current.value),s.append("reviews_count",0),ie||s.append("admin_approved",!0),console.log("Enviando amenidades predefinidas:",R),R.forEach((o,t)=>{s.append(`amenities[${t}]`,o)}),console.log("Enviando servicios predefinidos:",D),D.forEach((o,t)=>{s.append(`services[${t}]`,o)}),console.log("Enviando características predefinidas:",C),C.forEach((o,t)=>{s.append(`characteristics[${t}]`,o)}),console.log("Enviando reglas predefinidas:",P),P.forEach((o,t)=>{s.append(`house_rules[${t}]`,o)}),Ne.forEach((o,t)=>{s.append(`amenities_custom[${t}][name]`,o.name),s.append(`amenities_custom[${t}][icon]`,o.icon),s.append(`amenities_custom[${t}][available]`,o.available)}),(l=(r=N.current)==null?void 0:r.files)!=null&&l[0]&&s.append("main_image",N.current.files[0]),X.forEach((o,t)=>{o instanceof File&&s.append("gallery[]",o)}),ie){const o=X.filter(t=>typeof t=="string");s.append("existing_gallery",JSON.stringify(o))}console.log("FormData completo antes de enviar:");for(let o of s.entries())console.log(o[0],o[1]);try{await F.save(s),$(m.current).modal("hide"),$(c.current).dxDataGrid("instance").refresh(),g.fire({title:"Éxito",text:"Propiedad guardada correctamente",icon:"success"})}catch(o){console.error("Error saving property:",o),g.fire({title:"Error",text:"Error al guardar la propiedad",icon:"error"})}},fe=async({id:e,field:s,value:r})=>{try{await F.boolean({id:e,field:s,value:r}),$(c.current).dxDataGrid("instance").refresh()}catch(l){console.error("Error updating property:",l)}},ze=async e=>{try{(await g.fire({title:"¿Aprobar propiedad?",text:"Esta propiedad será visible públicamente",icon:"question",showCancelButton:!0,confirmButtonColor:"#198754",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, aprobar",cancelButtonText:"Cancelar"})).isConfirmed&&(await F.boolean({id:e,field:"admin_approved",value:!0}),$(c.current).dxDataGrid("instance").refresh(),g.fire({title:"Aprobada",text:"La propiedad ha sido aprobada exitosamente",icon:"success"}))}catch(s){console.error("Error approving property:",s),g.fire({title:"Error",text:"Error al aprobar la propiedad",icon:"error"})}},He=async e=>{var s;try{if((await g.fire({title:"¿Rechazar propiedad?",text:"Esta propiedad no será visible públicamente",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, rechazar",cancelButtonText:"Cancelar"})).isConfirmed){const o=await(await fetch("/api/admin/properties/reject",{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content")},body:JSON.stringify({id:e})})).json();if(o.status===200)$(c.current).dxDataGrid("instance").refresh(),g.fire({title:"Rechazada",text:"La propiedad ha sido rechazada",icon:"success"});else throw new Error(o.message)}}catch(r){console.error("Error rejecting property:",r),g.fire({title:"Error",text:"Error al rechazar la propiedad",icon:"error"})}},Le=async e=>{if((await g.fire({title:"¿Estás seguro?",text:"¿Estás seguro de eliminar esta propiedad?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await F.delete(e),$(c.current).dxDataGrid("instance").refresh(),g.fire({title:"Éxito",text:"Propiedad eliminada correctamente",icon:"success"})}catch(r){console.error("Error deleting property:",r),g.fire({title:"Error",text:"Error al eliminar la propiedad",icon:"error"})}};return a.jsxs("div",{className:"container-fluid",children:[a.jsx("div",{className:"row",children:a.jsx("div",{className:"col-12",children:a.jsx("div",{className:"card",children:a.jsx("div",{className:"card-body",children:a.jsx(Qe,{gridRef:c,title:"Propiedades",rest:F,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(c.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva Propiedad",hint:"Crear nueva propiedad",onClick:async()=>await ue()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"main_image",caption:"Imagen",width:"80px",allowFiltering:!1,cellTemplate:(e,{data:s})=>{x(e,s.main_image?a.jsx("img",{src:`/api/property/media/${s.main_image}`,alt:"Propiedad",className:"rounded",style:{width:"60px",height:"40px",objectFit:"cover"}}):a.jsx("div",{className:"bg-secondary rounded d-flex align-items-center justify-content-center",style:{width:"60px",height:"40px"},children:a.jsx("i",{className:"fas fa-image text-white"})}))}},{dataField:"title",caption:"Título",width:"250px"},{dataField:"platform",caption:"Plataforma",width:"100px"},{dataField:"price_per_night",caption:"Precio/Noche",width:"120px",cellTemplate:(e,{data:s})=>{x(e,a.jsxs("span",{children:[s.currency," ",parseFloat(s.price_per_night||0).toFixed(2)]}))}},{dataField:"district",caption:"Ubicación",width:"150px",cellTemplate:(e,{data:s})=>{x(e,a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:s.district}),a.jsx("small",{className:"text-muted",children:s.department})]}))}},{dataField:"bedrooms",caption:"Dormitorios",width:"100px"},{dataField:"max_guests",caption:"Huéspedes",width:"100px"},{dataField:"rating",caption:"Rating",width:"80px",cellTemplate:(e,{data:s})=>{x(e,a.jsxs("span",{className:"badge bg-warning",children:[a.jsx("i",{className:"fas fa-star me-1"}),s.rating||0]}))}},{dataField:"active",caption:"Activo",dataType:"boolean",width:"100px",cellTemplate:(e,{data:s})=>{x(e,a.jsx("div",{className:"form-check form-switch",children:a.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.active,onChange:r=>fe({id:s.id,field:"active",value:r.target.checked})})}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"100px",cellTemplate:(e,{data:s})=>{x(e,a.jsx("div",{className:"form-check form-switch",children:a.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.featured,onChange:r=>fe({id:s.id,field:"featured",value:r.target.checked})})}))}},{dataField:"admin_approved",caption:"Aprobación",width:"140px",cellTemplate:(e,{data:s})=>{x(e,a.jsx("div",{className:"d-flex gap-1",children:s.admin_approved?a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"badge bg-success",children:[a.jsx("i",{className:"fas fa-check me-1"}),"Aprobada"]}),a.jsx("button",{className:"btn btn-xs btn-outline-danger",onClick:()=>He(s.id),title:"Rechazar",children:a.jsx("i",{className:"fas fa-times"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"badge bg-warning",children:[a.jsx("i",{className:"fas fa-clock me-1"}),"Pendiente"]}),a.jsx("button",{className:"btn btn-xs btn-outline-success",onClick:()=>ze(s.id),title:"Aprobar",children:a.jsx("i",{className:"fas fa-check"})})]})}))},allowFiltering:!0,filterOperations:["="],lookup:{dataSource:[{value:!0,text:"Aprobada"},{value:!1,text:"Pendiente"}],valueExpr:"value",displayExpr:"text"}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{x(e,a.jsxs("div",{className:"d-flex gap-1",children:[a.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:async()=>await ue(s),title:"Editar",children:a.jsx("i",{className:"fas fa-edit"})}),a.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>Le(s.id),title:"Eliminar",children:a.jsx("i",{className:"fas fa-trash"})})]}))},allowFiltering:!1,allowExporting:!1}]})})})})}),a.jsx(We,{modalRef:m,title:ie?"Editar Propiedad":"Nueva Propiedad",onSubmit:Ie,size:"xl",children:a.jsxs("div",{className:"row",id:"principal-container",children:[a.jsx("input",{type:"hidden",ref:f}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-lg-8",children:[a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-lg-8 mb-3",children:a.jsx(h,{label:"Título de la propiedad",eRef:b,placeholder:"Ej: Apartamento moderno en Miraflores",required:!0})}),a.jsxs("div",{className:"col-lg-4 mb-3",children:[a.jsx("label",{className:"form-label fw-semibold",children:"Plataforma"}),a.jsxs("select",{className:"form-select",ref:B,required:!0,disabled:!0,children:[a.jsx("option",{value:"Airbnb",children:"Airbnb"}),a.jsx("option",{value:"Booking",children:"Booking.com"}),a.jsx("option",{value:"Vrbo",children:"Vrbo"}),a.jsx("option",{value:"HomeAway",children:"HomeAway"}),a.jsx("option",{value:"Otras",children:"Otras"})]})]})]}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsx(h,{label:"Precio por noche",eRef:O,type:"number",step:"0.01",min:"0",placeholder:"120.00",required:!0})}),a.jsxs("div",{className:"col-lg-2 mb-3",children:[a.jsx("label",{className:"form-label fw-semibold",children:"Moneda"}),a.jsxs("select",{className:"form-select",ref:q,disabled:!0,children:[a.jsx("option",{value:"PEN",children:"PEN"}),a.jsx("option",{value:"USD",children:"USD"}),a.jsx("option",{value:"EUR",children:"EUR"})]})]}),a.jsx("div",{className:"col-lg-2 mb-3",children:a.jsx(h,{label:"Dormitorios",eRef:z,type:"number",min:"1",placeholder:"1",required:!0})}),a.jsx("div",{className:"col-lg-2 mb-3",children:a.jsx(h,{label:"Baños",eRef:H,type:"number",min:"1",placeholder:"1",required:!0})}),a.jsx("div",{className:"col-lg-2 mb-3",children:a.jsx(h,{label:"Huéspedes máx.",eRef:L,type:"number",min:"1",placeholder:"2",required:!0})})]})]}),a.jsx("div",{className:"col-lg-4",children:a.jsx(Xe,{label:"Imagen principal",eRef:N,aspect:16/9})})]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-images me-2"}),"Galería de Imágenes"]}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-12 mb-3",children:[a.jsx("label",{className:"form-label fw-semibold",children:"Agregar imágenes a la galería"}),a.jsxs("div",{className:"border border-dashed border-primary rounded p-4 text-center",onDrop:$e,onDragOver:Fe,style:{minHeight:"120px"},children:[a.jsx("i",{className:"fas fa-cloud-upload-alt fa-3x text-primary mb-3"}),a.jsx("p",{className:"mb-2",children:"Arrastra las imágenes aquí o"}),a.jsx("input",{type:"file",ref:de,multiple:!0,accept:"image/*",onChange:Te,className:"d-none"}),a.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{var e;return(e=de.current)==null?void 0:e.click()},children:"Seleccionar Archivos"})]})]}),X.length>0&&a.jsx("div",{className:"col-12",children:a.jsx("div",{className:"row",children:X.map((e,s)=>a.jsx("div",{className:"col-lg-2 col-md-3 col-sm-4 mb-3",children:a.jsxs("div",{className:"position-relative",children:[a.jsx("img",{src:e instanceof File?URL.createObjectURL(e):`/api/property/media/${e}`,alt:`Galería ${s+1}`,className:"img-fluid rounded",style:{width:"100%",height:"100px",objectFit:"cover"}}),a.jsx("button",{type:"button",className:"btn btn-danger btn-sm position-absolute top-0 end-0 rounded-circle",style:{width:"25px",height:"25px",fontSize:"12px"},onClick:()=>Be(s),children:a.jsx("i",{className:"fas fa-times"})})]})},s))})})]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-map-marker-alt me-2"}),"Ubicación"]}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsx(h,{label:"Dirección completa",eRef:M,placeholder:"Av. Ricardo Palma 251",required:!0})}),a.jsx("div",{className:"col-lg-2 mb-3",children:a.jsx(h,{label:"Código Postal",eRef:G,placeholder:"15074"})}),a.jsxs("div",{className:"col-lg-6 mb-3",children:[a.jsx(h,{label:"Link de Airbnb (Para sincronizar fechas)",eRef:I,type:"url",placeholder:"https://www.airbnb.com/rooms/12345"}),a.jsxs("small",{className:"text-muted",children:[a.jsx("i",{className:"fas fa-info-circle me-1"}),"Este enlace permite sincronizar automáticamente las fechas disponibles"]})]})]}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsxs(ce,{label:"Departamento",eRef:j,onChange:e=>{const s=e.target.value;Z(s),me(s)},dropdownParent:"#principal-container",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),be.map((e,s)=>a.jsx("option",{value:e,children:e},s))]})}),a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsxs(ce,{label:"Provincia",eRef:u,onChange:e=>{const s=e.target.value;_(s);const r=j.current?$(j.current).val():k;console.log("🔍 Provincia onChange - Departamento actual:",r),console.log("🔍 Provincia onChange - selectedDepartment estado:",k),pe(s,r)},disabled:!k,dropdownParent:"#principal-container",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),A.map((e,s)=>a.jsx("option",{value:e,children:e},s))]})}),a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsxs(ce,{label:"Distrito",eRef:p,onChange:e=>{const s=e.target.value;T(s),_e(s)},disabled:!ve,dropdownParent:"#principal-container",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),w.map((e,s)=>a.jsx("option",{value:e,children:e},s))]})})]}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsx(h,{label:"Área (m²)",eRef:U,type:"number",min:"1",placeholder:"60"})}),a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsx(h,{label:"Latitud",eRef:V,type:"text",placeholder:"-12.1211"})}),a.jsx("div",{className:"col-lg-4 mb-3",children:a.jsx(h,{label:"Longitud",eRef:J,type:"text",placeholder:"-77.0269"})})]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-align-left me-2"}),"Descripción"]}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-lg-6 mb-3",children:[a.jsx("label",{className:"form-label fw-semibold",children:"Descripción completa"}),a.jsx("textarea",{className:"form-control",ref:K,rows:4,placeholder:"Describe detalladamente la propiedad...",required:!0})]}),a.jsxs("div",{className:"col-lg-6 mb-3",children:[a.jsx("label",{className:"form-label fw-semibold",children:"Descripción corta"}),a.jsx("textarea",{className:"form-control",ref:Q,rows:4,placeholder:"Resumen breve para listados..."})]})]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-star me-2"}),"Amenidades Principales"]}),a.jsx("div",{className:"row",children:De.map((e,s)=>a.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:a.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${R.includes(e.id)?"border-primary bg-light":"border-light hover:border-secondary"}`,onClick:()=>Oe(e.id),style:{cursor:"pointer"},children:a.jsxs("div",{className:"card-body p-3 text-center",children:[a.jsx("i",{className:`fas ${e.icon} fa-2x mb-2 ${R.includes(e.id)?"text-primary":"text-muted"}`}),a.jsx("h6",{className:`mb-0 ${R.includes(e.id)?"text-primary fw-bold":"text-dark"}`,children:e.label}),R.includes(e.id)&&a.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:a.jsx("i",{className:"fas fa-check-circle text-success"})})]})})},e.id))}),a.jsxs("div",{className:"alert alert-info",children:[a.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona las amenidades que tiene tu propiedad. Estas amenidades son las más comunes y aparecerán destacadas en los listados."]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-concierge-bell me-2"}),"Servicios Principales"]}),a.jsx("div",{className:"row",children:Ce.map((e,s)=>a.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:a.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${D.includes(e.id)?"border-success bg-light":"border-light hover:border-secondary"}`,onClick:()=>qe(e.id),style:{cursor:"pointer"},children:a.jsxs("div",{className:"card-body p-3 text-center",children:[a.jsx("i",{className:`fas ${e.icon} fa-2x mb-2 ${D.includes(e.id)?"text-success":"text-muted"}`}),a.jsx("h6",{className:`mb-0 ${D.includes(e.id)?"text-success fw-bold":"text-dark"}`,children:e.label}),D.includes(e.id)&&a.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:a.jsx("i",{className:"fas fa-check-circle text-success"})})]})})},e.id))}),a.jsxs("div",{className:"alert alert-info",children:[a.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona los servicios que ofreces a tus huéspedes."]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-star me-2"}),"Características Principales"]}),a.jsx("div",{className:"row",children:Pe.map((e,s)=>a.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:a.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${C.includes(e.id)?"border-warning bg-light":"border-light hover:border-secondary"}`,onClick:()=>Me(e.id),style:{cursor:"pointer"},children:a.jsxs("div",{className:"card-body p-3 text-center",children:[a.jsx("i",{className:`fas ${e.icon} fa-2x mb-2 ${C.includes(e.id)?"text-warning":"text-muted"}`}),a.jsx("h6",{className:`mb-0 ${C.includes(e.id)?"text-warning fw-bold":"text-dark"}`,children:e.label}),C.includes(e.id)&&a.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:a.jsx("i",{className:"fas fa-check-circle text-warning"})})]})})},e.id))}),a.jsxs("div",{className:"alert alert-info",children:[a.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona las características que mejor describan tu propiedad."]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-list-check me-2"}),"Reglas de la Casa Principales"]}),a.jsx("div",{className:"row",children:Se.map((e,s)=>a.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-3",children:a.jsx("div",{className:`card h-100 border-2 cursor-pointer transition-all ${P.includes(e.id)?"border-danger bg-light":"border-light hover:border-secondary"}`,onClick:()=>Ge(e.id),style:{cursor:"pointer"},children:a.jsxs("div",{className:"card-body p-3 text-center",children:[a.jsx("i",{className:`fas ${e.icon} fa-2x mb-2 ${P.includes(e.id)?"text-danger":"text-muted"}`}),a.jsx("h6",{className:`mb-0 ${P.includes(e.id)?"text-danger fw-bold":"text-dark"}`,children:e.label}),P.includes(e.id)&&a.jsx("div",{className:"position-absolute top-0 end-0 p-2",children:a.jsx("i",{className:"fas fa-check-circle text-danger"})})]})})},e.id))}),a.jsxs("div",{className:"alert alert-info",children:[a.jsx("i",{className:"fas fa-info-circle me-2"}),"Selecciona las reglas que los huéspedes deben seguir durante su estadía."]})]}),a.jsxs("div",{className:"col-12 mb-4",children:[a.jsxs("h5",{className:"border-bottom pb-2",children:[a.jsx("i",{className:"fas fa-star me-2"}),"Información Adicional"]}),a.jsx("div",{className:"row",children:a.jsx("div",{className:"col-lg-3 mb-3",children:a.jsx(h,{label:"Rating",eRef:W,type:"number",step:"0.1",min:"1",max:"5",placeholder:"5.0"})})})]})]})})]})};Ze((c,m)=>{Je(c).render(a.jsx(Ke,{...m,title:"Propiedades",children:a.jsx(aa,{...m})}))});
