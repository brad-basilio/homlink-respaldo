var A=Object.defineProperty;var G=(a,r,c)=>r in a?A(a,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[r]=c;var b=(a,r,c)=>(G(a,typeof r!="symbol"?r+"":r,c),c);import{j as t}from"./FileViewer-CpM0iYLI.js";import{r as l}from"./index-B80Lgev0.js";import{B as M}from"./Base-DGm0zQT1.js";import{c as q}from"./ReactAppend-CBRQCQGz.js";import{r as j}from"./DxBox-CdMuSyGE.js";import{S as O}from"./sweetalert2.all-Dh0rZL5X.js";import{M as W}from"./Modal-CbHkO7Dn.js";import{T as J}from"./Table-CEq6jy84.js";import{I as P}from"./ImageFormGroup-BhK-m0pl.js";import{I as S}from"./InputFormGroup-DZ3W53Mr.js";import{D as y}from"./DxButton-CsjWvhyj.js";import{C as _}from"./CreateReactScript-Bj11ghWz.js";import{R as z}from"./ReactAppend-C-tNgxIf.js";import{B as U}from"./Results-B9dLaNz0.js";import"./tippy-react.esm-CHhA99mn.js";import"./index-DO3Aws4m.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./main-Br9xqDfn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./index.esm-CTa_PdWD.js";import"./axios-B4uVmeYG.js";import"./useTranslation-Ck1q50rN.js";import"./Base-DTu8ZgWI.js";/* empty css               */class V extends U{constructor(){super(...arguments);b(this,"path","admin/staff");b(this,"hasFiles",!0)}}const v=new V,H=()=>{const a=l.useRef(),r=l.useRef(),c=l.useRef(),h=l.useRef(),x=l.useRef(),g=l.useRef(),f=l.useRef(),[o,p]=l.useState([{value:""}]),[m,d]=l.useState([{value:""}]),[N,C]=l.useState(!1),w=()=>{p([...o,{value:""}])},E=(e,s)=>{const i=[...o];i[e].value=s,p(i)},F=e=>{if(o.length<=1)return;const s=o.filter((i,n)=>n!==e);p(s)},D=()=>{d([...m,{value:""}])},B=(e,s)=>{const i=[...m];i[e].value=s,d(i)},k=e=>{if(m.length<=1)return;const s=m.filter((i,n)=>n!==e);d(s)},R=e=>{C(!!(e!=null&&e.id)),c.current.value=(e==null?void 0:e.id)||"",h.current.value=(e==null?void 0:e.name)||"",x.current.value=(e==null?void 0:e.job)||"",g.current.value=(e==null?void 0:e.description)||"",f.current.value=null,e!=null&&e.image&&(f.image.src=`/api/staff/media/${e.image}`),e!=null&&e.characteristics&&e.characteristics.length>0?p(e.characteristics.map(s=>({value:s}))):p([{value:""}]),e!=null&&e.socials&&e.socials.length>0?d(e.socials.map(s=>({value:s}))):d([{value:""}]),$(r.current).modal("show")},T=async e=>{e.preventDefault();const s=new FormData;s.append("name",h.current.value),s.append("job",x.current.value),s.append("description",g.current.value),N&&s.append("id",c.current.value),f.current.files[0]&&s.append("image",f.current.files[0]);const i=o.map(u=>u.value.trim()).filter(u=>u.length>0);s.append("characteristics",JSON.stringify(i));const n=m.map(u=>u.value.trim()).filter(u=>u.length>0);s.append("socials",JSON.stringify(n)),await v.save(s)&&($(a.current).dxDataGrid("instance").refresh(),$(r.current).modal("hide"),setGallery([]),p([{value:""}]))},I=async e=>{const{isConfirmed:s}=await O.fire({title:"Eliminar Staff",text:"¿Estás seguro de eliminar este staff?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!s||!await v.delete(e)||$(a.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(J,{gridRef:a,title:"Staff",rest:v,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nuevo staff",onClick:()=>R()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"job",caption:"Puesto",width:"200px"},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:s})=>{e.html(j(t.jsx("div",{className:"text-truncate",style:{maxWidth:"300px"},children:s.description})))}},{dataField:"characteristics",caption:"Características",cellTemplate:(e,{data:s})=>{s.characteristics&&e.html(j(t.jsxs("ul",{className:"m-0 ps-3",style:{listStyle:"none"},children:[s.characteristics.slice(0,2).map((i,n)=>t.jsx("li",{className:"text-truncate",style:{maxWidth:"250px"},children:t.jsxs("small",{children:["• ",i]})},n)),s.characteristics.length>2&&t.jsx("li",{children:t.jsxs("small",{className:"text-muted",children:["+",s.characteristics.length-2," ","más..."]})})]})))}},{dataField:"socials",caption:"Redes sociales",cellTemplate:(e,{data:s})=>{s.socials&&e.html(j(t.jsxs("ul",{className:"m-0 ps-3",style:{listStyle:"none"},children:[s.socials.slice(0,2).map((i,n)=>t.jsx("li",{className:"text-truncate",style:{maxWidth:"250px"},children:t.jsxs("small",{children:["• ",i]})},n)),s.socials.length>2&&t.jsx("li",{children:t.jsxs("small",{className:"text-muted",children:["+",s.socials.length-2," ","más..."]})})]})))}},{dataField:"image",caption:"Imagen",width:"100px",cellTemplate:(e,{data:s})=>{z(e,t.jsx("img",{src:`/api/staff/media/${s.image}`,style:{width:"80px",height:"45px",objectFit:"cover",borderRadius:"4px"},onError:i=>i.target.src="/images/default-thumbnail.jpg"}))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{e.append(y({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>R(s)})),e.append(y({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>I(s.id)}))}}]}),t.jsxs(W,{modalRef:r,title:N?"Editar Staff":"Nuevo Staff",onSubmit:T,size:"lg",children:[t.jsx("input",{ref:c,type:"hidden"}),t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsx(S,{eRef:h,label:"Nombres del staff",required:!0}),t.jsx(S,{eRef:x,label:"Puesto laboral",required:!0}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Descripción"}),t.jsx("textarea",{ref:g,className:"form-control",rows:4,required:!0})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Características"}),o.map((e,s)=>t.jsxs("div",{className:"input-group mb-2",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Egresada de la Universidad Nacional Federico Villarreal.",value:e.value,onChange:i=>E(s,i.target.value)}),t.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>F(s),disabled:o.length<=1,children:t.jsx("i",{className:"fas fa-times"})})]},s)),t.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:w,children:[t.jsx("i",{className:"fas fa-plus me-1"})," Agregar característica"]})]})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx(P,{eRef:f,label:"Imagen principal",aspect:1}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:"Redes sociales"}),m.map((e,s)=>t.jsxs("div",{className:"input-group mb-2",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: https://web.facebook.com/nopainperu",value:e.value,onChange:i=>B(s,i.target.value)}),t.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>k(s),disabled:m.length<=1,children:t.jsx("i",{className:"fas fa-times"})})]},s)),t.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:D,children:[t.jsx("i",{className:"fas fa-plus me-1"})," Agregar red social"]})]})]})]})]})]})};_((a,r)=>{q(a).render(t.jsx(M,{...r,title:"Staffs",children:t.jsx(H,{...r})}))});
