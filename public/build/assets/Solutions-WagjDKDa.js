var ie=Object.defineProperty;var se=(o,n,c)=>n in o?ie(o,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[n]=c;var T=(o,n,c)=>(se(o,typeof n!="symbol"?n+"":n,c),c);import{j as i}from"./RequirementCard-DEdD30eg.js";import{r}from"./index-RYns6xqu.js";import{c as re}from"./ReactAppend-vpV7VTGG.js";import{B as ne}from"./Base-DF33JnYS.js";import{r as te}from"./DxBox-DZgBbgD6.js";import"./sweetalert2.all-DJo0UVK6.js";import{M as oe}from"./Modal-IE2ysmSM.js";import{T as ce}from"./Table-BTG--uQT.js";import{I as B}from"./ImageFormGroup-D50xykhM.js";import{I as v}from"./InputFormGroup-B7mKwzkx.js";import{D as O}from"./DxButton-CsjWvhyj.js";import{C as le}from"./CreateReactScript-BuKYEKxn.js";import{R as ae}from"./ReactAppend-DPXaoPQG.js";import{L as me}from"./Filter-CpekYgBC.js";import{D as ue}from"./DragDropImage-BoC6KBUm.js";import{B as pe}from"./Results-BBVbNL2k.js";import{S as fe}from"./SelectAPIFormGroupSupport-DzXa28dp.js";import"./index-CXU7o9CY.js";import"./tippy-react.esm-DYFqe69e.js";/* empty css              */import"./Logout-BlWggqgx.js";import"./main-Y8JAyXgE.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./useTranslation-CZbMeh78.js";/* empty css               */import"./index-DNUR7M9R.js";class de extends pe{constructor(){super(...arguments);T(this,"path","admin/solutions");T(this,"hasFiles",!0)}}const U=new de,V=({feature:o,index:n,onUpdate:c,onRemove:x,type:p,canRemove:b,characteristics:w,benefits:j,addCharacteristic:R,addBenefit:N})=>{const g=(a,_)=>{c(n,a,_)},C=a=>{c(n,"image",a)};return i.jsx("div",{className:"card mb-3",children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx(v,{label:"Título",value:o.title,onChange:a=>g("title",a.target.value)}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{className:"form-control",rows:3,value:o.description,onChange:a=>g("description",a.target.value)})]})]}),i.jsx("div",{className:"col-md-6",children:i.jsx(ue,{current:"solution",label:"Imagen",currentImage:o.image,onChange:C,aspect:16/9})})]}),i.jsxs("div",{className:"d-flex justify-content-between",children:[i.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>x(n),disabled:!b,children:"Eliminar"}),p==="characteristic"&&n===w.length-1||p==="benefit"&&n===j.length-1?i.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:p==="characteristic"?R:N,children:["Agregar"," ",p==="characteristic"?"Característica":"Beneficio"]}):null]})]})})},ge=({brands:o})=>{var H;const n=r.useRef(),c=r.useRef(),x=r.useRef(),p=r.useRef(),b=r.useRef(),w=r.useRef(),j=r.useRef(),R=r.useRef(),N=r.useRef(),g=r.useRef(),C=r.useRef(),a=r.useRef(),_=r.useRef(),I=r.useRef(),D=r.useRef(),F=r.useRef(),E=r.useRef(),[W,A]=r.useState(!1),[k,J]=r.useState(null),[f,y]=r.useState([{title:"",description:"",image:void 0}]),[d,S]=r.useState([{title:"",description:"",image:void 0}]),[K,q]=r.useState(""),P=()=>{y([...f,{title:"",description:"",image:void 0}])},Q=r.useCallback((e,s,l)=>{y(h=>{const m=[...h];return m[e]={...m[e],[s]:l},m})},[]),X=e=>{f.length<=1||y(f.filter((s,l)=>l!==e))},G=()=>{S([...d,{title:"",description:"",image:void 0}])},Y=r.useCallback((e,s,l)=>{S(h=>{const m=[...h];return m[e]={...m[e],[s]:l},m})},[]),Z=e=>{d.length<=1||S(d.filter((s,l)=>l!==e))},M=e=>{e!=null&&e.id?A(!0):A(!1),x.current.value=(e==null?void 0:e.id)??"",p.current.value=(e==null?void 0:e.title)??"",b.current.value=(e==null?void 0:e.title_second)??"",w.current.value=(e==null?void 0:e.category.name)??"",q(e==null?void 0:e.category.name),J(e),j.current.value=(e==null?void 0:e.description)??"",R.current.value=(e==null?void 0:e.description_second)??"",N.current.value=(e==null?void 0:e.how_it_helps)??"",g.current.value=(e==null?void 0:e.description_helps)??"",C.current.value=(e==null?void 0:e.value_proposition)??"",a.current.value=(e==null?void 0:e.innovation_focus)??"",_.current.value=(e==null?void 0:e.customer_relation)??"",I.image.src=`/api/solution/media/${(e==null?void 0:e.image_icon)??"undefined"}`,D.image.src=`/api/solution/media/${(e==null?void 0:e.image)??"undefined"}`,F.image.src=`/api/solution/media/${(e==null?void 0:e.image_secondary)??"undefined"}`,E.image.src=`/api/solution/media/${(e==null?void 0:e.image_banner)??"undefined"}`,e!=null&&e.characteristics&&y(e.characteristics.map(s=>({title:s.title,description:s.description,image:s.image}))),e!=null&&e.benefits&&S(e.benefits.map(s=>({title:s.title,description:s.description,image:s.image}))),$(c.current).modal("show")},ee=async e=>{e.preventDefault();const s=new FormData,l={id:x.current.value||void 0,title:p.current.value,title_second:b.current.value,description:j.current.value,description_second:R.current.value,how_it_helps:N.current.value,description_helps:g.current.value,value_proposition:C.current.value,innovation_focus:a.current.value,customer_relation:_.current.value};for(const t in l)s.append(t,l[t]);const h=I.current.files[0];h&&s.append("image_icon",h);const m=D.current.files[0];m&&s.append("image",m);const L=F.current.files[0];L&&s.append("image_secondary",L);const z=E.current.files[0];z&&s.append("image_banner",z),f.forEach((t,u)=>{s.append(`characteristics[${u}][title]`,t.title),s.append(`characteristics[${u}][description]`,t.description),t.image&&(t.image.file?s.append(`characteristics[${u}][image]`,t.image.file):typeof t.image=="string"&&s.append(`characteristics[${u}][existing_image]`,t.image))}),d.forEach((t,u)=>{s.append(`benefits[${u}][title]`,t.title),s.append(`benefits[${u}][description]`,t.description),t.image&&(t.image.file?s.append(`benefits[${u}][image]`,t.image.file):typeof t.image=="string"&&s.append(`benefits[${u}][existing_image]`,t.image))}),s.append("category_name",K),await U.save(s)&&($(n.current).dxDataGrid("instance").refresh(),$(c.current).modal("hide"))};return i.jsxs(i.Fragment,{children:[i.jsx(ce,{gridRef:n,title:"Soluciones",rest:U,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nueva solución",onClick:()=>M()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"title",caption:"Título",width:"200px"},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:s})=>{e.html(te(i.jsx("div",{className:"text-truncate",style:{maxWidth:"300px"},children:s.description})))}},{dataField:"image",caption:"Imagen",width:"100px",cellTemplate:(e,{data:s})=>{ae(e,i.jsx("img",{src:`/api/solution/media/${s.image}`,style:{width:"80px",height:"45px",objectFit:"cover",borderRadius:"4px"},onError:l=>l.target.src="/images/default-thumbnail.jpg"}))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{e.append(O({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>M(s)})),e.append(O({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>onDeleteClicked(s.id)}))}}]}),i.jsxs(oe,{modalRef:c,title:W?"Editar Solución":"Nueva Solución",onSubmit:ee,size:"lg",children:[i.jsx("input",{ref:x,type:"hidden"}),i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-6",id:"solution-container",children:[i.jsx(fe,{eRef:w,dropdownParent:"#solution-container",label:"Categoría",searchAPI:"/api/admin/category_solutions/paginate",searchBy:"name",allowCreate:!0,onChange:e=>q(e),initialValue:((H=k==null?void 0:k.category)==null?void 0:H.name)||""}),i.jsx(v,{eRef:p,label:"Título de la solución",required:!0}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{ref:j,className:"form-control",rows:4,required:!0})]})]}),i.jsxs("div",{className:"col-md-6",children:[i.jsx(v,{eRef:N,label:"Cómo ayuda"}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción de ayuda"}),i.jsx("textarea",{ref:g,className:"form-control",rows:4})]})]})]}),i.jsx("div",{className:"row mt-3",children:i.jsxs("div",{className:"col-md-12",children:[i.jsx(v,{eRef:b,label:"Título complementario",required:!0}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción complementaria"}),i.jsx("textarea",{ref:R,className:"form-control",rows:4,required:!0})]})]})}),i.jsxs("div",{className:"row mt-3",children:[i.jsx("div",{className:"col-md-12",children:i.jsx("div",{className:"col-md-2",children:i.jsx(B,{eRef:I,label:"Imagen icono (Card en portada)",aspect:1/1})})}),i.jsx("div",{className:"col-md-6",children:i.jsx(B,{eRef:D,label:"Imagen principal",aspect:16/9})}),i.jsx("div",{className:"col-md-6",children:i.jsx(B,{eRef:F,label:"Imagen secundaria (Card en portada)",aspect:16/9})}),i.jsx("div",{className:"col-md-12 mt-3",children:i.jsx(B,{eRef:E,label:"Banner",aspect:16/9})})]}),i.jsx("div",{className:"row mt-3",children:i.jsxs("div",{className:"col-12",children:[i.jsx(v,{eRef:C,label:"Propuesta de valor"}),i.jsx("h5",{className:"mb-3",children:"Características"}),f.map((e,s)=>i.jsx(V,{feature:e,index:s,onUpdate:Q,onRemove:X,canRemove:f.length>1,type:"characteristic",characteristics:f,benefits:d,addCharacteristic:P,addBenefit:G},`char-${s}`))]})}),i.jsxs("div",{className:"row mt-3",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(v,{eRef:a,label:"Enfoque de innovación"})}),i.jsx("div",{className:"col-md-6",children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Relación con el cliente"}),i.jsx("textarea",{ref:_,className:"form-control",rows:5})]})}),i.jsxs("div",{className:"col-md-12",children:[i.jsx("h5",{className:"mb-3 mt-4",children:"Beneficios"}),d.map((e,s)=>i.jsx(V,{feature:e,index:s,onUpdate:Y,onRemove:Z,canRemove:d.length>1,type:"benefit",characteristics:f,benefits:d,addCharacteristic:P,addBenefit:G},`benefit-${s}`))]})]})]})]})};le((o,n)=>{re(o).render(i.jsx(me,{children:i.jsx(ne,{...n,title:"Soluciones",children:i.jsx(ge,{...n})})}))});
